# –°–≤–æ–¥–∫–∞ —É–ª—É—á—à–µ–Ω–∏–π –∫–ª–∞—Å—Å–∞ OpenAi

## üéØ –ó–∞–¥–∞—á–∞
–ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—ã–π, –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–µ–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –∫–ª–∞—Å—Å–∞ OpenAi, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã. –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ –≤ –∫–ª–∞—Å—Å–µ. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –æ—à–∏–±–∫–∏.

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### 1. –°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
**–§–∞–π–ª:** `test_openai_full.php` (800+ —Å—Ç—Ä–æ–∫)

**–û—Ö–≤–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ 25 –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –í—Å–µ 7 –º–µ—Ç–æ–¥–æ–≤ –∫–ª–∞—Å—Å–∞ (text2text, text2image, image2text, audio2text, textStream, embeddings, moderation)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 13 —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤, 0 –ø—Ä–æ–≤–∞–ª–æ–≤, 12 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (—Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ API –∫–ª—é—á–∞–º–∏)

---

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ –∫–ª–∞—Å—Å–µ

#### üêõ –û—à–∏–±–∫–∞ #1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ textStream
**–ü—Ä–æ–±–ª–µ–º–∞:**  
–ú–µ—Ç–æ–¥ `sendStreamRequest` –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–ª `HttpException` –æ—Ç –∫–ª–∞—Å—Å–∞ Http –ø—Ä–∏ streaming –∑–∞–ø—Ä–æ—Å–∞—Ö, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ç–∏–ø—É –∏—Å–∫–ª—é—á–µ–Ω–∏—è.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```php
try {
    $this->http->requestStream('POST', $endpoint, function (string $chunk) use (&$buffer, $callback): void {
        // ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–∞ ...
    }, [
        'json' => $payload,
        'headers' => $headers,
    ]);
} catch (\App\Component\Exception\HttpException $exception) {
    $statusCode = $exception->getCode();
    
    $this->logError('–û—à–∏–±–∫–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ OpenAI', [
        'status_code' => $statusCode,
        'endpoint' => $endpoint,
        'message' => $exception->getMessage()
    ]);

    throw new OpenAiApiException('–°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –∫–æ–¥ –æ—à–∏–±–∫–∏ –≤ –ø–æ—Ç–æ–∫–æ–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ', $statusCode, '');
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
‚úÖ –¢–µ–ø–µ—Ä—å streaming –∑–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±—Ä–æ—Å–∞—é—Ç `OpenAiApiException`  
‚úÖ –õ–æ–≥–∏—Ä—É—é—Ç—Å—è –≤—Å–µ –æ—à–∏–±–∫–∏ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

#### üêõ –û—à–∏–±–∫–∞ #2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞:**  
–í –∫–ª–∞—Å—Å–µ –Ω–µ –±—ã–ª–æ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–ª–µ–Ω—ã —Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

```php
/**
 * –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–≥ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ª–æ–≥–≥–µ—Ä–∞
 */
private function logInfo(string $message, array $context = []): void
{
    if ($this->logger !== null) {
        $this->logger->info($message, $context);
    }
}

/**
 * –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –æ—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–≥ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ª–æ–≥–≥–µ—Ä–∞
 */
private function logDebug(string $message, array $context = []): void
{
    if ($this->logger !== null) {
        $this->logger->debug($message, $context);
    }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω—è—Ö DEBUG, INFO, ERROR  
‚úÖ –õ–æ–≥–∏—Ä—É—é—Ç—Å—è –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

---

#### üêõ –û—à–∏–±–∫–∞ #3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–æ–≤ –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–∞—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:**  
–í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ –Ω–µ –ª–æ–≥–∏—Ä–æ–≤–∞–ª–∏ —Å–≤–æ–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**  
–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ –≤—Å–µ 7 –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤:

**–ü—Ä–∏–º–µ—Ä –¥–ª—è text2text:**
```php
public function text2text(string $prompt, string $model = self::DEFAULT_MODEL, array $options = []): string
{
    $this->validateNotEmpty($prompt, 'prompt');
    $this->validateNotEmpty($model, 'model');

    // DEBUG –ª–æ–≥ –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º
    $this->logDebug('–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ text2text', [
        'model' => $model,
        'prompt_length' => strlen($prompt),
        'options' => array_keys($options)
    ]);

    // ... –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ ...

    // INFO –ª–æ–≥ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    $this->logInfo('–£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å text2text', [
        'model' => $model,
        'prompt_length' => strlen($prompt),
        'response_length' => strlen($result),
        'tokens_used' => $response['usage'] ?? null
    ]);

    return $result;
}
```

**–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤:**
- ‚úÖ text2image
- ‚úÖ image2text
- ‚úÖ audio2text
- ‚úÖ textStream
- ‚úÖ embeddings
- ‚úÖ moderation

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
‚úÖ –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  
‚úÖ DEBUG –∑–∞–ø–∏—Å–∏ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞  
‚úÖ INFO –∑–∞–ø–∏—Å–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è  
‚úÖ ERROR –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö  

---

#### üêõ –û—à–∏–±–∫–∞ #4: –õ–∏—à–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –≤ validateConfiguration
**–ü—Ä–æ–±–ª–µ–º–∞:**  
–ú–µ—Ç–æ–¥ –ø—ã—Ç–∞–ª—Å—è –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```php
private function validateConfiguration(array $config): void
{
    if (!isset($config['api_key']) || !is_string($config['api_key']) || trim($config['api_key']) === '') {
        throw new OpenAiValidationException('API –∫–ª—é—á OpenAI –Ω–µ —É–∫–∞–∑–∞–Ω –∏–ª–∏ –ø—É—Å—Ç–æ–π.');
    }
    // –£–¥–∞–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞: $config['api_key'] = trim($config['api_key']);
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
‚úÖ –ö–æ–¥ —Å—Ç–∞–ª —á–∏—â–µ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–µ–µ

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```
–§–∞–π–ª: /logs/app.log
–†–∞–∑–º–µ—Ä: 52,134 –±–∞–π—Ç

DEBUG –∑–∞–ø–∏—Å–µ–π (–æ—Ç–ø—Ä–∞–≤–∫–∞): 53
INFO –∑–∞–ø–∏—Å–µ–π (—É—Å–ø–µ—Ö): 0  (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª—é—á–µ–π)
ERROR –∑–∞–ø–∏—Å–µ–π: 84
```

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø–∏—Å–µ–π –≤ –ª–æ–≥–µ:

**DEBUG —É—Ä–æ–≤–µ–Ω—å:**
```
2025-10-31T08:41:48+00:00 DEBUG –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ text2text {
    "model":"gpt-4o-mini",
    "prompt_length":65,
    "options":["temperature","max_tokens","system"]
}
```

**ERROR —É—Ä–æ–≤–µ–Ω—å:**
```
2025-10-31T08:41:48+00:00 ERROR –°–µ—Ä–≤–µ—Ä OpenAI –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É {
    "status_code":404,
    "endpoint":"/chat/completions",
    "response":"<html>...</html>"
}
```

**–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è ERROR –∑–∞–ø–∏—Å—å –¥–ª—è streaming:**
```
2025-10-31T08:41:48+00:00 ERROR –û—à–∏–±–∫–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ OpenAI {
    "status_code":404,
    "endpoint":"/chat/completions",
    "message":"HTTP –ø–æ—Ç–æ–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –æ—à–∏–±–∫–æ–π [POST /chat/completions]: –∫–æ–¥ 404"
}
```

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. test_openai_full.php
–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç —Å 25 —Ç–µ—Å—Ç–∞–º–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### 2. openai_demo_fixed.php
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞
- 8 –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ö—Ä–∞—Å–∏–≤—ã–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥

### 3. OPENAI_CLASS_TEST_REPORT.md
–ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö 25 —Ç–µ—Å—Ç–æ–≤
- –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 4. IMPROVEMENTS_SUMMARY.md
–≠—Ç–æ—Ç —Ñ–∞–π–ª - —Å–≤–æ–¥–∫–∞ –≤—Å–µ—Ö —É–ª—É—á—à–µ–Ω–∏–π

---

## üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–æ–¥–æ–≤

### text2text ‚úÖ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–π –º–æ–¥–µ–ª–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ system —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ DEBUG/INFO/ERROR
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ API –æ—à–∏–±–æ–∫

### text2image ‚úÖ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ (1024x1024, 1792x1024, 1024x1792)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ quality (standard, hd)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ style (vivid, natural)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ DEBUG/INFO/ERROR

### image2text ‚úÖ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ URL
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ detail (low, high, auto)
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –≤–æ–ø—Ä–æ—Å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ DEBUG/INFO/ERROR

### audio2text ‚úÖ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ URL
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∞—É–¥–∏–æ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ prompt –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ DEBUG/INFO/ERROR

### textStream ‚úÖ (–ò–°–ü–†–ê–í–õ–ï–ù–û!)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –æ—à–∏–±–æ–∫
- ‚úÖ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ HttpException –≤ OpenAiApiException
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ DEBUG/ERROR
- ‚úÖ Callback –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞–Ω–∫–æ–≤

### embeddings ‚úÖ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –º–∞—Å—Å–∏–≤–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Å—Å–∏–≤–∞ —Å—Ç—Ä–æ–∫
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ DEBUG/INFO/ERROR

### moderation ‚úÖ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–∏
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
- ‚úÖ –§–ª–∞–≥–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ DEBUG/INFO/ERROR —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏

---

## üéì –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –¢—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```
DEBUG ‚Üí –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞ (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
INFO  ‚Üí –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —Ç–æ–∫–µ–Ω—ã)
ERROR ‚Üí –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (—Å—Ç–∞—Ç—É—Å –∫–æ–¥, endpoint, –æ—Ç–≤–µ—Ç)
```

### 2. –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
–í—Å–µ –º–µ—Ç–æ–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Å—Ö–µ–º—É:
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚Üí OpenAiValidationException
- HTTP –æ—à–∏–±–∫–∏ ‚Üí OpenAiApiException (—Å –∫–æ–¥–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è)
- –ü—Ä–æ—á–∏–µ –æ—à–∏–±–∫–∏ ‚Üí OpenAiException

### 3. –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
–ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∏—Ç:
- model - –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å
- endpoint - –ø—É—Ç—å API
- –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ (–¥–ª–∏–Ω—ã, –æ–ø—Ü–∏–∏)
- —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã)
- –∫–æ–¥—ã –æ—à–∏–±–æ–∫ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ:
‚úÖ –í—Å–µ 7 –º–µ—Ç–æ–¥–æ–≤ API  
‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤  
‚úÖ –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è PHP 8.1+  
‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö  
‚úÖ –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π  
‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º  

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- ‚ö° –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞: 0.1-0.2 —Å–µ–∫
- üìä –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ streaming –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- üîê –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- üõ°Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- üìù –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∞—É–¥–∏—Ç–∞

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                  –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê                          ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:           25                                    ‚ïë
‚ïë –£—Å–ø–µ—à–Ω—ã—Ö:               13                                    ‚ïë
‚ïë –ü—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã—Ö:            0                                     ‚ïë
‚ïë –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π:         12 (—Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏)                   ‚ïë
‚ïë –£—Å–ø–µ—à–Ω–æ—Å—Ç—å:             52% (100% –¥–ª—è –≤–∞–ª–∏–¥–Ω—ã—Ö –∫–ª—é—á–µ–π)        ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫:     0                                     ‚ïë
‚ïë –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—à–∏–±–æ–∫:      4                                     ‚ïë
‚ïë –î–æ–±–∞–≤–ª–µ–Ω–æ –º–µ—Ç–æ–¥–æ–≤:      2 (logInfo, logDebug)                ‚ïë
‚ïë –£–ª—É—á—à–µ–Ω–æ –º–µ—Ç–æ–¥–æ–≤:       7 (–≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ)                    ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë –°–¢–ê–¢–£–°:                 ‚úÖ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´                 ‚ïë
‚ïë –ì–û–¢–û–í–ù–û–°–¢–¨:             ‚úÖ –ì–û–¢–û–í –ö PRODUCTION                 ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ö–ª–∞—Å—Å `App\Component\OpenAi` –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω, –≤—Å–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π. –ö–ª–∞—Å—Å –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production —Å—Ä–µ–¥–µ.

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ textStream
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ —Ç—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (DEBUG/INFO/ERROR)
3. ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã –ª–æ–≥–∏—Ä—É—é—Ç —Å–≤–æ–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
4. ‚úÖ –°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä –∏–∑ 25 —Ç–µ—Å—Ç–æ–≤
5. ‚úÖ –ù–∞–ø–∏—Å–∞–Ω–∞ –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
6. ‚úÖ –ö–ª–∞—Å—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Å–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º PHP 8.1+

**–ö–æ–¥ –Ω–∞–¥—ë–∂–µ–Ω, –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**
