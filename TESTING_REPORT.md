# –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–ª–∞—Å—Å–∞ Http

## –î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
30 –æ–∫—Ç—è–±—Ä—è 2025 –≥.

## –ö–ª–∞—Å—Å
`App\Component\Http` (`/src/Http.class.php`)

---

## –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ HTTP –∫–ª–∏–µ–Ω—Ç–∞

#### ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –ë–∞–∑–æ–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π (base_uri, timeout, connect_timeout, verify, proxy, headers, allow_redirects, retries, options)

#### ‚úÖ HTTP –º–µ—Ç–æ–¥—ã
–í—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ HTTP –º–µ—Ç–æ–¥—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
- **GET** - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **POST** - –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (JSON, form data)
- **PUT** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- **PATCH** - —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- **DELETE** - —É–¥–∞–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- **HEAD** - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

#### ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—É—Å—Ç–æ–π HTTP –º–µ—Ç–æ–¥ ‚Üí `HttpValidationException`
- –ü—É—Å—Ç–æ–π URI ‚Üí `HttpValidationException`
- –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –¥–æ–º–µ–Ω ‚Üí `HttpException`

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

#### ‚úÖ HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã
- 404 Not Found - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è (–±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, —Ç.–∫. `http_errors = false`)
- 500 Internal Server Error - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
- –¢–∞–π–º–∞—É—Ç—ã - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `HttpException`

### 4. –ü–æ—Ç–æ–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã (Stream)

#### ‚úÖ –ú–µ—Ç–æ–¥ `requestStream()`
- –£—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ callback
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –±–∞–π—Ç
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (4xx, 5xx –∫–æ–¥—ã) –≤ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

### 5. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- User-Agent
- –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (X-Custom-Header, X-API-Key –∏ —Ç.–¥.)

#### ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ `allow_redirects = false`

#### ‚úÖ –¢–∞–π–º–∞—É—Ç—ã
- –û–±—â–∏–π —Ç–∞–π–º–∞—É—Ç (timeout)
- –¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (connect_timeout)

---

## –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

### üêõ –û—à–∏–±–∫–∞ #1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ retry handler
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `Http.class.php:416`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```php
function (
    int $retriesAttempt,
    RequestInterface $request,
    ?ResponseInterface $response = null,
    ?RequestException $exception = null  // ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø
) use ($maxAttempts): bool {
```

**–ü—Ä–∏—á–∏–Ω–∞:**
`ConnectException` –∏ `RequestException` –Ω–µ —Å–≤—è–∑–∞–Ω—ã –Ω–∞–ø—Ä—è–º—ã–º –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º. –û–±–∞ –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç `TransferException`, –Ω–æ `ConnectException` –ù–ï —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥—Ç–∏–ø–æ–º `RequestException`.

**–†–µ—à–µ–Ω–∏–µ:**
–ò–∑–º–µ–Ω–µ–Ω —Ç–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –Ω–∞ `?\Throwable`:
```php
function (
    int $retriesAttempt,
    RequestInterface $request,
    ?ResponseInterface $response = null,
    ?\Throwable $exception = null  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø
) use ($maxAttempts): bool {
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

---

### üêõ –û—à–∏–±–∫–∞ #2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ –º–µ—Ç–æ–¥–µ logRetry()
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `Http.class.php:471`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```php
private function logRetry(int $attemptNumber, RequestInterface $request, RequestException $exception): void
```

**–†–µ—à–µ–Ω–∏–µ:**
```php
private function logRetry(int $attemptNumber, RequestInterface $request, \Throwable $exception): void
```

–° –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ—Ç–æ–¥–∞–º `RequestException`:
```php
// –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞ –µ—Å–ª–∏ –µ—Å—Ç—å (–¥–ª—è RequestException)
if ($exception instanceof RequestException) {
    $response = $exception->getResponse();
    if ($response !== null) {
        $context['status_code'] = $response->getStatusCode();
    }
}
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

---

## –£–ª—É—á—à–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

#### –ù–æ–≤–æ–µ –ø–æ–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```php
$http = new Http([
    'log_successful_requests' => true, // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é true
], $logger);
```

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ã—á–Ω—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
**–£—Ä–æ–≤–µ–Ω—å:** `INFO` –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (2xx-3xx), `WARNING` –¥–ª—è –æ—à–∏–±–æ–∫ (4xx-5xx)

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `method` - HTTP –º–µ—Ç–æ–¥ (GET, POST –∏ —Ç.–¥.)
- `uri` - URI –∑–∞–ø—Ä–æ—Å–∞
- `status_code` - –ö–æ–¥ –æ—Ç–≤–µ—Ç–∞
- `duration` - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Å–µ–∫—É–Ω–¥—ã, 3 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)
- `body_size` - –†–∞–∑–º–µ—Ä —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞ –≤ –±–∞–π—Ç–∞—Ö
- `content_type` - Content-Type –æ—Ç–≤–µ—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏:**
```
2025-10-30T18:18:28+00:00 INFO HTTP –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω [GET https://www.google.com/] –∫–æ–¥ 200
{"method":"GET","uri":"https://www.google.com/","status_code":200,"duration":0.134,"body_size":76638,"content_type":"text/html; charset=ISO-8859-1"}
```

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
**–£—Ä–æ–≤–µ–Ω—å:** `INFO`

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `method` - HTTP –º–µ—Ç–æ–¥
- `uri` - URI –∑–∞–ø—Ä–æ—Å–∞
- `status_code` - –ö–æ–¥ –æ—Ç–≤–µ—Ç–∞
- `bytes_received` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –±–∞–π—Ç
- `duration` - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏:**
```
2025-10-30T18:18:30+00:00 INFO HTTP –ø–æ—Ç–æ–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω [GET https://www.example.com/] –∫–æ–¥ 200, –ø–æ–ª—É—á–µ–Ω–æ 513 –±–∞–π—Ç
{"method":"GET","uri":"https://www.example.com/","status_code":200,"bytes_received":513,"duration":0.117}
```

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ (Retry)
**–£—Ä–æ–≤–µ–Ω—å:** `WARNING`

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `retry_attempt` - –ù–æ–º–µ—Ä –ø–æ–ø—ã—Ç–∫–∏
- `method` - HTTP –º–µ—Ç–æ–¥
- `uri` - URI –∑–∞–ø—Ä–æ—Å–∞
- `error` - –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
- `status_code` - –ö–æ–¥ –æ—Ç–≤–µ—Ç–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏:**
```
2025-10-30T18:18:28+00:00 WARNING –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–∞
{"retry_attempt":1,"method":"GET","uri":"https://httpstat.us/500","error":"cURL error 52: Empty reply from server"}
```

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
**–£—Ä–æ–≤–µ–Ω—å:** `ERROR`

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `method` - HTTP –º–µ—Ç–æ–¥
- `uri` - URI –∑–∞–ø—Ä–æ—Å–∞
- `exception` - –°–æ–æ–±—â–µ–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- `code` - –ö–æ–¥ –æ—à–∏–±–∫–∏
- `duration` - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–æ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏
- `bytes_received` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –±–∞–π—Ç (–¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏:**
```
2025-10-30T18:18:29+00:00 ERROR –û—à–∏–±–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–∞
{"method":"GET","uri":"https://httpstat.us/500","exception":"cURL error 52: Empty reply from server","code":0,"duration":1.252}
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (—Å –æ—à–∏–±–∫–∞–º–∏)
- –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: 20
- –£—Å–ø–µ—à–Ω–æ: 0 ‚úó
- –ü—Ä–æ–≤–∞–ª–µ–Ω–æ: 20 ‚úó
- –ü—Ä–∏—á–∏–Ω–∞: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Ç–∏–ø–æ–≤ –≤ retry handler

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫
- –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: 20
- –£—Å–ø–µ—à–Ω–æ: 19 ‚úì
- –ü—Ä–æ–≤–∞–ª–µ–Ω–æ: 1 ‚úó (–≤–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã - httpbin.org –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
- –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: 95%

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ retry –º–µ—Ö–∞–Ω–∏–∑–º–∞
- –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: 5
- –£—Å–ø–µ—à–Ω–æ: 4 ‚úì
- –ü—Ä–æ–≤–∞–ª–µ–Ω–æ: 1 ‚úó (–≤–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã)
- –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: 80%

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –ê–Ω–∞–ª–∏–∑ –∑–∞–ø–∏—Å–µ–π –≤ –ª–æ–≥–∞—Ö
‚úÖ **method** - –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–æ –≤—Å–µ—Ö –∑–∞–ø–∏—Å—è—Ö  
‚úÖ **uri** - –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–æ –≤—Å–µ—Ö –∑–∞–ø–∏—Å—è—Ö  
‚úÖ **status_code** - –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≥–¥–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ  
‚úÖ **duration** - –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–æ –≤—Å–µ—Ö –∑–∞–ø–∏—Å—è—Ö –æ –∑–∞–ø—Ä–æ—Å–∞—Ö  
‚úÖ **body_size** - –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –æ–±—ã—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö  
‚úÖ **bytes_received** - –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö  
‚úÖ **content_type** - –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≥–¥–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ  
‚úÖ **retry_attempt** - –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –∑–∞–ø–∏—Å—è—Ö –æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö  

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—Ä–æ–≤–Ω—è–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- **INFO**: –£—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (2xx-3xx –∫–æ–¥—ã)
- **WARNING**: –û—à–∏–±–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ (4xx –∫–æ–¥—ã), –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
- **ERROR**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, –∏—Å–∫–ª—é—á–µ–Ω–∏—è, —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏

---

## –í—ã–≤–æ–¥—ã

### ‚úÖ –ö–ª–∞—Å—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ `Http` —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–∂–∏–¥–∞–Ω–∏—è–º–∏:
- HTTP –º–µ—Ç–æ–¥—ã (GET, POST, PUT, PATCH, DELETE, HEAD)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- –ü–æ—Ç–æ–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- Retry –º–µ—Ö–∞–Ω–∏–∑–º

### ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Ç–∏–ø–æ–≤ –≤ retry handler
2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Ç–∏–ø–æ–≤ –≤ –º–µ—Ç–æ–¥–µ logRetry()

### ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–æ
1. –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–º–µ—Ä–µ –æ—Ç–≤–µ—Ç–æ–≤
4. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Content-Type
5. –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º duration

### ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã. –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `log_successful_requests`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `true`.

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
1. ‚úÖ –ö–ª–∞—Å—Å –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
2. ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (`log_successful_requests = true`)
3. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å retry –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (`retries = 3`)

### –î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
1. –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ —É—Ä–æ–≤–Ω—è WARNING (–ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏)
2. –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ —É—Ä–æ–≤–Ω—è ERROR (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏)
3. –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å duration –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–æ–≥–æ–≤

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û–∫—Ä—É–∂–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **PHP –≤–µ—Ä—Å–∏—è:** 8.1+
- **Guzzle –≤–µ—Ä—Å–∏—è:** 7.x
- **–¢–µ—Å—Ç–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:** httpbin.org, www.google.com, www.example.com, httpstat.us

### –§–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤
- `test_http_comprehensive.php` - –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ (20 —Ç–µ—Å—Ç–æ–≤)
- `test_http_retry_logging.php` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ retry –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (5 —Ç–µ—Å—Ç–æ–≤)

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `/src/Http.class.php` - –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å HTTP –∫–ª–∏–µ–Ω—Ç–∞
