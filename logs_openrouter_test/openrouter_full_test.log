2025-10-30T19:17:42+00:00 INFO === Инициализация тестового окружения === {}
2025-10-30T19:17:43+00:00 INFO HTTP запрос выполнен [GET /auth/key] код 200 {"method":"GET","uri":"/auth/key","status_code":200,"duration":0.4,"body_size":49511,"content_type":"text/html; charset=utf-8"}
2025-10-30T19:17:43+00:00 ERROR ✗ OpenRouterMetrics::getKeyInfo() - ошибка: Не удалось декодировать ответ API: Syntax error {"exception_class":"App\\Component\\Exception\\OpenRouterException","trace":"#0 /home/engine/project/src/OpenRouterMetrics.class.php(82): App\\Component\\OpenRouterMetrics->sendRequest()\n#1 /home/engine/project/tests/Integration/OpenRouterFullTest.php(160): App\\Component\\OpenRouterMetrics->getKeyInfo()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(71): OpenRouterFullTest->testMetricsGetKeyInfo()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#4 {main}"}
2025-10-30T19:17:43+00:00 INFO HTTP запрос выполнен [GET /auth/key] код 200 {"method":"GET","uri":"/auth/key","status_code":200,"duration":0.221,"body_size":49511,"content_type":"text/html; charset=utf-8"}
2025-10-30T19:17:43+00:00 ERROR ✗ OpenRouterMetrics::getBalance() - ошибка: Не удалось декодировать ответ API: Syntax error {"exception_class":"App\\Component\\Exception\\OpenRouterException","trace":"#0 /home/engine/project/src/OpenRouterMetrics.class.php(82): App\\Component\\OpenRouterMetrics->sendRequest()\n#1 /home/engine/project/src/OpenRouterMetrics.class.php(112): App\\Component\\OpenRouterMetrics->getKeyInfo()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(188): App\\Component\\OpenRouterMetrics->getBalance()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(72): OpenRouterFullTest->testMetricsGetBalance()\n#4 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#5 {main}"}
2025-10-30T19:17:43+00:00 INFO HTTP запрос выполнен [GET /auth/key] код 200 {"method":"GET","uri":"/auth/key","status_code":200,"duration":0.246,"body_size":49511,"content_type":"text/html; charset=utf-8"}
2025-10-30T19:17:43+00:00 ERROR ✗ OpenRouterMetrics::getUsageStats() - ошибка: Не удалось декодировать ответ API: Syntax error {"exception_class":"App\\Component\\Exception\\OpenRouterException","trace":"#0 /home/engine/project/src/OpenRouterMetrics.class.php(82): App\\Component\\OpenRouterMetrics->sendRequest()\n#1 /home/engine/project/src/OpenRouterMetrics.class.php(137): App\\Component\\OpenRouterMetrics->getKeyInfo()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(215): App\\Component\\OpenRouterMetrics->getUsageStats()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(73): OpenRouterFullTest->testMetricsGetUsageStats()\n#4 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#5 {main}"}
2025-10-30T19:17:43+00:00 INFO HTTP запрос выполнен [GET /auth/key] код 200 {"method":"GET","uri":"/auth/key","status_code":200,"duration":0.222,"body_size":49511,"content_type":"text/html; charset=utf-8"}
2025-10-30T19:17:43+00:00 ERROR ✗ OpenRouterMetrics::getRateLimits() - ошибка: Не удалось декодировать ответ API: Syntax error {"exception_class":"App\\Component\\Exception\\OpenRouterException","trace":"#0 /home/engine/project/src/OpenRouterMetrics.class.php(82): App\\Component\\OpenRouterMetrics->sendRequest()\n#1 /home/engine/project/src/OpenRouterMetrics.class.php(165): App\\Component\\OpenRouterMetrics->getKeyInfo()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(243): App\\Component\\OpenRouterMetrics->getRateLimits()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(74): OpenRouterFullTest->testMetricsGetRateLimits()\n#4 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#5 {main}"}
2025-10-30T19:17:44+00:00 INFO HTTP запрос выполнен [GET /auth/key] код 200 {"method":"GET","uri":"/auth/key","status_code":200,"duration":0.247,"body_size":49511,"content_type":"text/html; charset=utf-8"}
2025-10-30T19:17:44+00:00 ERROR ✗ OpenRouterMetrics::getAccountStatus() - ошибка: Не удалось декодировать ответ API: Syntax error {"exception_class":"App\\Component\\Exception\\OpenRouterException","trace":"#0 /home/engine/project/src/OpenRouterMetrics.class.php(82): App\\Component\\OpenRouterMetrics->sendRequest()\n#1 /home/engine/project/src/OpenRouterMetrics.class.php(401): App\\Component\\OpenRouterMetrics->getKeyInfo()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(268): App\\Component\\OpenRouterMetrics->getAccountStatus()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(75): OpenRouterFullTest->testMetricsGetAccountStatus()\n#4 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#5 {main}"}
2025-10-30T19:17:44+00:00 INFO HTTP запрос выполнен [GET /models] код 200 {"method":"GET","uri":"/models","status_code":200,"duration":0.063,"body_size":126311,"content_type":"text/html; charset=utf-8"}
2025-10-30T19:17:44+00:00 ERROR ✗ OpenRouterMetrics::getModels() - ошибка: Не удалось декодировать ответ API: Syntax error {"exception_class":"App\\Component\\Exception\\OpenRouterException","trace":"#0 /home/engine/project/src/OpenRouterMetrics.class.php(198): App\\Component\\OpenRouterMetrics->sendRequest()\n#1 /home/engine/project/tests/Integration/OpenRouterFullTest.php(295): App\\Component\\OpenRouterMetrics->getModels()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(78): OpenRouterFullTest->testMetricsGetModels()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#4 {main}"}
2025-10-30T19:17:44+00:00 INFO HTTP запрос выполнен [GET /models] код 200 {"method":"GET","uri":"/models","status_code":200,"duration":0.054,"body_size":126311,"content_type":"text/html; charset=utf-8"}
2025-10-30T19:17:44+00:00 ERROR Ошибка поиска дешевой модели: Не удалось декодировать ответ API: Syntax error {}
2025-10-30T19:17:44+00:00 ERROR Не удалось найти дешевую модель для тестирования {}
2025-10-30T19:17:44+00:00 INFO HTTP запрос выполнен [GET /models] код 200 {"method":"GET","uri":"/models","status_code":200,"duration":0.073,"body_size":126311,"content_type":"text/html; charset=utf-8"}
2025-10-30T19:17:44+00:00 ERROR ✗ OpenRouterMetrics::estimateCost() - ошибка: Не удалось декодировать ответ API: Syntax error {"exception_class":"App\\Component\\Exception\\OpenRouterException","trace":"#0 /home/engine/project/src/OpenRouterMetrics.class.php(198): App\\Component\\OpenRouterMetrics->sendRequest()\n#1 /home/engine/project/src/OpenRouterMetrics.class.php(254): App\\Component\\OpenRouterMetrics->getModels()\n#2 /home/engine/project/src/OpenRouterMetrics.class.php(294): App\\Component\\OpenRouterMetrics->getModelInfo()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(332): App\\Component\\OpenRouterMetrics->estimateCost()\n#4 /home/engine/project/tests/Integration/OpenRouterFullTest.php(88): OpenRouterFullTest->testMetricsEstimateCost()\n#5 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#6 {main}"}
2025-10-30T19:17:44+00:00 INFO HTTP запрос выполнен [GET /auth/key] код 200 {"method":"GET","uri":"/auth/key","status_code":200,"duration":0.221,"body_size":49511,"content_type":"text/html; charset=utf-8"}
2025-10-30T19:17:44+00:00 ERROR ✗ OpenRouterMetrics::hasEnoughBalance() - ошибка: Не удалось декодировать ответ API: Syntax error {"exception_class":"App\\Component\\Exception\\OpenRouterException","trace":"#0 /home/engine/project/src/OpenRouterMetrics.class.php(82): App\\Component\\OpenRouterMetrics->sendRequest()\n#1 /home/engine/project/src/OpenRouterMetrics.class.php(112): App\\Component\\OpenRouterMetrics->getKeyInfo()\n#2 /home/engine/project/src/OpenRouterMetrics.class.php(376): App\\Component\\OpenRouterMetrics->getBalance()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(361): App\\Component\\OpenRouterMetrics->hasEnoughBalance()\n#4 /home/engine/project/tests/Integration/OpenRouterFullTest.php(89): OpenRouterFullTest->testMetricsHasEnoughBalance()\n#5 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#6 {main}"}
2025-10-30T19:17:44+00:00 INFO HTTP запрос выполнен [POST /chat/completions] код 200 {"method":"POST","uri":"/chat/completions","status_code":200,"duration":0.317,"body_size":81298,"content_type":"text/html; charset=utf-8"}
2025-10-30T19:17:44+00:00 ERROR ✗ OpenRouter::text2text() - ошибка: Не удалось декодировать ответ API: Syntax error {"exception_class":"App\\Component\\Exception\\OpenRouterException","trace":"#0 /home/engine/project/src/OpenRouter.class.php(99): App\\Component\\OpenRouter->sendRequest()\n#1 /home/engine/project/tests/Integration/OpenRouterFullTest.php(387): App\\Component\\OpenRouter->text2text()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(92): OpenRouterFullTest->testText2Text()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#4 {main}"}
2025-10-30T19:17:45+00:00 INFO HTTP потоковый запрос выполнен [POST /chat/completions] код 200, получено 81298 байт {"method":"POST","uri":"/chat/completions","status_code":200,"bytes_received":81298,"duration":0.278}
2025-10-30T19:17:45+00:00 ERROR ✗ OpenRouter::textStream() - ошибка: Значение 0 должно быть больше 0 {"exception_class":"Exception","trace":"#0 /home/engine/project/tests/Integration/OpenRouterFullTest.php(450): OpenRouterFullTest->assertGreaterThan()\n#1 /home/engine/project/tests/Integration/OpenRouterFullTest.php(95): OpenRouterFullTest->testTextStream()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#3 {main}"}
2025-10-30T19:17:45+00:00 INFO ✓ Validation: Empty model - успешно {"exception":"Параметр \"model\" не может быть пустым."}
2025-10-30T19:17:45+00:00 INFO ✓ Validation: Empty prompt - успешно {"exception":"Параметр \"prompt\" не может быть пустым."}
2025-10-30T19:17:45+00:00 INFO ✓ Validation: Negative tokens - успешно {"exception":"Количество токенов запроса не может быть отрицательным."}
2025-10-30T19:17:45+00:00 INFO ✓ Validation: Negative cost - успешно {"exception":"Стоимость не может быть отрицательной."}
2025-10-30T19:17:45+00:00 INFO === Тестирование завершено === {}
2025-10-30T19:17:45+00:00 INFO Успешно: 4/14 (28.57%) {}
2025-10-30T19:19:40+00:00 INFO === Инициализация тестового окружения === {}
2025-10-30T19:19:40+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.169,"body_size":409,"content_type":"application/json"}
2025-10-30T19:19:40+00:00 INFO ✓ OpenRouterMetrics::getKeyInfo() - успешно {"label":"sk-or-v1-c31...7e5","usage":0,"limit":1,"is_free_tier":false,"rate_limit":{"requests":-1,"interval":"10s"}}
2025-10-30T19:19:40+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.038,"body_size":409,"content_type":"application/json"}
2025-10-30T19:19:40+00:00 INFO ✓ OpenRouterMetrics::getBalance() - успешно {"balance":1}
2025-10-30T19:19:41+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.047,"body_size":409,"content_type":"application/json"}
2025-10-30T19:19:41+00:00 INFO ✓ OpenRouterMetrics::getUsageStats() - успешно {"total_usage":0,"limit":1,"remaining":1,"usage_percent":0,"is_free_tier":false}
2025-10-30T19:19:41+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.06,"body_size":409,"content_type":"application/json"}
2025-10-30T19:19:41+00:00 INFO ✓ OpenRouterMetrics::getRateLimits() - успешно {"requests":-1,"interval":"10s","description":"Лимиты не установлены"}
2025-10-30T19:19:41+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.062,"body_size":409,"content_type":"application/json"}
2025-10-30T19:19:41+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.08,"body_size":409,"content_type":"application/json"}
2025-10-30T19:19:41+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.054,"body_size":409,"content_type":"application/json"}
2025-10-30T19:19:41+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.041,"body_size":409,"content_type":"application/json"}
2025-10-30T19:19:41+00:00 INFO ✓ OpenRouterMetrics::getAccountStatus() - успешно {"key_info":{"label":"sk-or-v1-c31...7e5","usage":0,"limit":1,"is_free_tier":false,"rate_limit":{"requests":-1,"interval":"10s"}},"balance":1,"usage_stats":{"total_usage":0,"limit":1,"remaining":1,"usage_percent":0,"is_free_tier":false},"rate_limits":{"requests":-1,"interval":"10s","description":"Лимиты не установлены"}}
2025-10-30T19:19:41+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.115,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:19:41+00:00 ERROR ✗ OpenRouterMetrics::getModels() - ошибка: Значение 0 должно быть больше 349 {"exception_class":"Exception","trace":"#0 /home/engine/project/tests/Integration/OpenRouterFullTest.php(298): OpenRouterFullTest->assertGreaterThan()\n#1 /home/engine/project/tests/Integration/OpenRouterFullTest.php(78): OpenRouterFullTest->testMetricsGetModels()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#3 {main}"}
2025-10-30T19:19:41+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.28,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:19:41+00:00 INFO Найдена бесплатная модель: nvidia/nemotron-nano-12b-v2-vl:free {}
2025-10-30T19:19:42+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.261,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:19:42+00:00 INFO ✓ OpenRouterMetrics::estimateCost() - успешно {"prompt_cost":0,"completion_cost":0,"total_cost":0,"model":"nvidia/nemotron-nano-12b-v2-vl:free","tokens":{"prompt":100,"completion":50,"total":150}}
2025-10-30T19:19:42+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.047,"body_size":409,"content_type":"application/json"}
2025-10-30T19:19:42+00:00 INFO ✓ OpenRouterMetrics::hasEnoughBalance() - успешно {"has_balance":true}
2025-10-30T19:19:42+00:00 WARNING HTTP запрос выполнен [POST chat/completions] код 404 {"method":"POST","uri":"chat/completions","status_code":404,"duration":0.207,"body_size":152,"content_type":"application/json"}
2025-10-30T19:19:42+00:00 ERROR Сервер OpenRouter вернул ошибку {"status_code":404,"endpoint":"/chat/completions","response":"{\"error\":{\"message\":\"No endpoints found matching your data policy (Free model training). Configure: https://openrouter.ai/settings/privacy\",\"code\":404}}"}
2025-10-30T19:19:42+00:00 ERROR ✗ OpenRouter::text2text() - ошибка: Сервер вернул код ошибки {"exception_class":"App\\Component\\Exception\\OpenRouterApiException","trace":"#0 /home/engine/project/src/OpenRouter.class.php(99): App\\Component\\OpenRouter->sendRequest()\n#1 /home/engine/project/tests/Integration/OpenRouterFullTest.php(387): App\\Component\\OpenRouter->text2text()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(92): OpenRouterFullTest->testText2Text()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#4 {main}"}
2025-10-30T19:19:42+00:00 ERROR HTTP потоковый запрос завершился ошибкой {"method":"POST","uri":"chat/completions","status_code":404,"response_preview":"{\"error\":{\"message\":\"No endpoints found matching your data policy (Free model training). Configure: https://openrouter.ai/settings/privacy\",\"code\":404}}","duration":0.273}
2025-10-30T19:19:42+00:00 ERROR ✗ OpenRouter::textStream() - ошибка: HTTP потоковый запрос завершился ошибкой [POST chat/completions]: код 404 {"exception_class":"App\\Component\\Exception\\HttpException","trace":"#0 /home/engine/project/src/OpenRouter.class.php(423): App\\Component\\Http->requestStream()\n#1 /home/engine/project/src/OpenRouter.class.php(318): App\\Component\\OpenRouter->sendStreamRequest()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(432): App\\Component\\OpenRouter->textStream()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(95): OpenRouterFullTest->testTextStream()\n#4 /home/engine/project/tests/Integration/OpenRouterFullTest.php(758): OpenRouterFullTest->runAllTests()\n#5 {main}"}
2025-10-30T19:19:42+00:00 INFO ✓ Validation: Empty model - успешно {"exception":"Параметр \"model\" не может быть пустым."}
2025-10-30T19:19:42+00:00 INFO ✓ Validation: Empty prompt - успешно {"exception":"Параметр \"prompt\" не может быть пустым."}
2025-10-30T19:19:42+00:00 INFO ✓ Validation: Negative tokens - успешно {"exception":"Количество токенов запроса не может быть отрицательным."}
2025-10-30T19:19:42+00:00 INFO ✓ Validation: Negative cost - успешно {"exception":"Стоимость не может быть отрицательной."}
2025-10-30T19:19:42+00:00 INFO === Тестирование завершено === {}
2025-10-30T19:19:42+00:00 INFO Успешно: 11/14 (78.57%) {}
2025-10-30T19:20:29+00:00 INFO === Инициализация тестового окружения === {}
2025-10-30T19:20:30+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.232,"body_size":409,"content_type":"application/json"}
2025-10-30T19:20:30+00:00 INFO ✓ OpenRouterMetrics::getKeyInfo() - успешно {"label":"sk-or-v1-c31...7e5","usage":0,"limit":1,"is_free_tier":false,"rate_limit":{"requests":-1,"interval":"10s"}}
2025-10-30T19:20:30+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.073,"body_size":409,"content_type":"application/json"}
2025-10-30T19:20:30+00:00 INFO ✓ OpenRouterMetrics::getBalance() - успешно {"balance":1}
2025-10-30T19:20:30+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.058,"body_size":409,"content_type":"application/json"}
2025-10-30T19:20:30+00:00 INFO ✓ OpenRouterMetrics::getUsageStats() - успешно {"total_usage":0,"limit":1,"remaining":1,"usage_percent":0,"is_free_tier":false}
2025-10-30T19:20:30+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.091,"body_size":409,"content_type":"application/json"}
2025-10-30T19:20:30+00:00 INFO ✓ OpenRouterMetrics::getRateLimits() - успешно {"requests":-1,"interval":"10s","description":"Лимиты не установлены"}
2025-10-30T19:20:30+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.088,"body_size":409,"content_type":"application/json"}
2025-10-30T19:20:30+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.068,"body_size":409,"content_type":"application/json"}
2025-10-30T19:20:30+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.055,"body_size":409,"content_type":"application/json"}
2025-10-30T19:20:30+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.078,"body_size":409,"content_type":"application/json"}
2025-10-30T19:20:30+00:00 INFO ✓ OpenRouterMetrics::getAccountStatus() - успешно {"key_info":{"label":"sk-or-v1-c31...7e5","usage":0,"limit":1,"is_free_tier":false,"rate_limit":{"requests":-1,"interval":"10s"}},"balance":1,"usage_stats":{"total_usage":0,"limit":1,"remaining":1,"usage_percent":0,"is_free_tier":false},"rate_limits":{"requests":-1,"interval":"10s","description":"Лимиты не установлены"}}
2025-10-30T19:20:30+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.229,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:20:30+00:00 INFO ✓ OpenRouterMetrics::getModels() - успешно {"models_count":349}
2025-10-30T19:20:31+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.286,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:20:31+00:00 INFO Найдена бесплатная модель: minimax/minimax-m2:free {}
2025-10-30T19:20:31+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.145,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:20:31+00:00 INFO ✓ OpenRouterMetrics::estimateCost() - успешно {"prompt_cost":0,"completion_cost":0,"total_cost":0,"model":"minimax/minimax-m2:free","tokens":{"prompt":100,"completion":50,"total":150}}
2025-10-30T19:20:31+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.068,"body_size":409,"content_type":"application/json"}
2025-10-30T19:20:31+00:00 INFO ✓ OpenRouterMetrics::hasEnoughBalance() - успешно {"has_balance":true}
2025-10-30T19:20:32+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":1.185,"body_size":548,"content_type":"application/json"}
2025-10-30T19:20:32+00:00 ERROR ✗ OpenRouter::text2text() - ошибка: Строка не должна быть пустой {"exception_class":"Exception","trace":"#0 /home/engine/project/tests/Integration/OpenRouterFullTest.php(409): OpenRouterFullTest->assertNotEmpty()\n#1 /home/engine/project/tests/Integration/OpenRouterFullTest.php(92): OpenRouterFullTest->testText2Text()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(770): OpenRouterFullTest->runAllTests()\n#3 {main}"}
2025-10-30T19:20:33+00:00 INFO HTTP потоковый запрос выполнен [POST chat/completions] код 200, получено 1675 байт {"method":"POST","uri":"chat/completions","status_code":200,"bytes_received":1675,"duration":1.104}
2025-10-30T19:20:33+00:00 ERROR ✗ OpenRouter::textStream() - ошибка: Строка не должна быть пустой {"exception_class":"Exception","trace":"#0 /home/engine/project/tests/Integration/OpenRouterFullTest.php(463): OpenRouterFullTest->assertNotEmpty()\n#1 /home/engine/project/tests/Integration/OpenRouterFullTest.php(95): OpenRouterFullTest->testTextStream()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(770): OpenRouterFullTest->runAllTests()\n#3 {main}"}
2025-10-30T19:20:33+00:00 INFO ✓ Validation: Empty model - успешно {"exception":"Параметр \"model\" не может быть пустым."}
2025-10-30T19:20:33+00:00 INFO ✓ Validation: Empty prompt - успешно {"exception":"Параметр \"prompt\" не может быть пустым."}
2025-10-30T19:20:33+00:00 INFO ✓ Validation: Negative tokens - успешно {"exception":"Количество токенов запроса не может быть отрицательным."}
2025-10-30T19:20:33+00:00 INFO ✓ Validation: Negative cost - успешно {"exception":"Стоимость не может быть отрицательной."}
2025-10-30T19:20:33+00:00 INFO === Тестирование завершено === {}
2025-10-30T19:20:33+00:00 INFO Успешно: 12/14 (85.71%) {}
2025-10-30T19:21:56+00:00 INFO === Инициализация тестового окружения === {}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.155,"body_size":409,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO ✓ OpenRouterMetrics::getKeyInfo() - успешно {"label":"sk-or-v1-c31...7e5","usage":0,"limit":1,"is_free_tier":false,"rate_limit":{"requests":-1,"interval":"10s"}}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.05,"body_size":409,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO ✓ OpenRouterMetrics::getBalance() - успешно {"balance":1}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.055,"body_size":409,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO ✓ OpenRouterMetrics::getUsageStats() - успешно {"total_usage":0,"limit":1,"remaining":1,"usage_percent":0,"is_free_tier":false}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.047,"body_size":409,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO ✓ OpenRouterMetrics::getRateLimits() - успешно {"requests":-1,"interval":"10s","description":"Лимиты не установлены"}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.041,"body_size":409,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.061,"body_size":409,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.098,"body_size":409,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.098,"body_size":409,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO ✓ OpenRouterMetrics::getAccountStatus() - успешно {"key_info":{"label":"sk-or-v1-c31...7e5","usage":0,"limit":1,"is_free_tier":false,"rate_limit":{"requests":-1,"interval":"10s"}},"balance":1,"usage_stats":{"total_usage":0,"limit":1,"remaining":1,"usage_percent":0,"is_free_tier":false},"rate_limits":{"requests":-1,"interval":"10s","description":"Лимиты не установлены"}}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.169,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO ✓ OpenRouterMetrics::getModels() - успешно {"models_count":349}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.133,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO Найдена бесплатная модель: alibaba/tongyi-deepresearch-30b-a3b:free {}
2025-10-30T19:21:57+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.106,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:21:57+00:00 INFO ✓ OpenRouterMetrics::estimateCost() - успешно {"prompt_cost":0,"completion_cost":0,"total_cost":0,"model":"alibaba/tongyi-deepresearch-30b-a3b:free","tokens":{"prompt":100,"completion":50,"total":150}}
2025-10-30T19:21:58+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.041,"body_size":409,"content_type":"application/json"}
2025-10-30T19:21:58+00:00 INFO ✓ OpenRouterMetrics::hasEnoughBalance() - успешно {"has_balance":true}
2025-10-30T19:21:58+00:00 WARNING HTTP запрос выполнен [POST chat/completions] код 404 {"method":"POST","uri":"chat/completions","status_code":404,"duration":0.101,"body_size":152,"content_type":"application/json"}
2025-10-30T19:21:58+00:00 ERROR Сервер OpenRouter вернул ошибку {"status_code":404,"endpoint":"/chat/completions","response":"{\"error\":{\"message\":\"No endpoints found matching your data policy (Free model training). Configure: https://openrouter.ai/settings/privacy\",\"code\":404}}"}
2025-10-30T19:21:58+00:00 ERROR ✗ OpenRouter::text2text() - ошибка: Сервер вернул код ошибки {"exception_class":"App\\Component\\Exception\\OpenRouterApiException","trace":"#0 /home/engine/project/src/OpenRouter.class.php(99): App\\Component\\OpenRouter->sendRequest()\n#1 /home/engine/project/tests/Integration/OpenRouterFullTest.php(400): App\\Component\\OpenRouter->text2text()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(92): OpenRouterFullTest->testText2Text()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(771): OpenRouterFullTest->runAllTests()\n#4 {main}"}
2025-10-30T19:21:58+00:00 ERROR HTTP потоковый запрос завершился ошибкой {"method":"POST","uri":"chat/completions","status_code":404,"response_preview":"{\"error\":{\"message\":\"No endpoints found matching your data policy (Free model training). Configure: https://openrouter.ai/settings/privacy\",\"code\":404}}","duration":0.243}
2025-10-30T19:21:58+00:00 ERROR ✗ OpenRouter::textStream() - ошибка: HTTP потоковый запрос завершился ошибкой [POST chat/completions]: код 404 {"exception_class":"App\\Component\\Exception\\HttpException","trace":"#0 /home/engine/project/src/OpenRouter.class.php(423): App\\Component\\Http->requestStream()\n#1 /home/engine/project/src/OpenRouter.class.php(318): App\\Component\\OpenRouter->sendStreamRequest()\n#2 /home/engine/project/tests/Integration/OpenRouterFullTest.php(445): App\\Component\\OpenRouter->textStream()\n#3 /home/engine/project/tests/Integration/OpenRouterFullTest.php(95): OpenRouterFullTest->testTextStream()\n#4 /home/engine/project/tests/Integration/OpenRouterFullTest.php(771): OpenRouterFullTest->runAllTests()\n#5 {main}"}
2025-10-30T19:21:58+00:00 INFO ✓ Validation: Empty model - успешно {"exception":"Параметр \"model\" не может быть пустым."}
2025-10-30T19:21:58+00:00 INFO ✓ Validation: Empty prompt - успешно {"exception":"Параметр \"prompt\" не может быть пустым."}
2025-10-30T19:21:58+00:00 INFO ✓ Validation: Negative tokens - успешно {"exception":"Количество токенов запроса не может быть отрицательным."}
2025-10-30T19:21:58+00:00 INFO ✓ Validation: Negative cost - успешно {"exception":"Стоимость не может быть отрицательной."}
2025-10-30T19:21:58+00:00 INFO === Тестирование завершено === {}
2025-10-30T19:21:58+00:00 INFO Успешно: 12/14 (85.71%) {}
2025-10-30T19:22:18+00:00 INFO === Инициализация тестового окружения === {}
2025-10-30T19:22:18+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.16,"body_size":454,"content_type":"application/json"}
2025-10-30T19:22:18+00:00 INFO ✓ OpenRouterMetrics::getKeyInfo() - успешно {"label":"sk-or-v1-c31...7e5","usage":5.94e-6,"limit":1,"is_free_tier":false,"rate_limit":{"requests":-1,"interval":"10s"}}
2025-10-30T19:22:19+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.051,"body_size":454,"content_type":"application/json"}
2025-10-30T19:22:19+00:00 INFO ✓ OpenRouterMetrics::getBalance() - успешно {"balance":0.99999406}
2025-10-30T19:22:19+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.034,"body_size":454,"content_type":"application/json"}
2025-10-30T19:22:19+00:00 INFO ✓ OpenRouterMetrics::getUsageStats() - успешно {"total_usage":5.94e-6,"limit":1,"remaining":0.99999406,"usage_percent":0,"is_free_tier":false}
2025-10-30T19:22:19+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.035,"body_size":454,"content_type":"application/json"}
2025-10-30T19:22:19+00:00 INFO ✓ OpenRouterMetrics::getRateLimits() - успешно {"requests":-1,"interval":"10s","description":"Лимиты не установлены"}
2025-10-30T19:22:19+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.043,"body_size":454,"content_type":"application/json"}
2025-10-30T19:22:19+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.052,"body_size":454,"content_type":"application/json"}
2025-10-30T19:22:19+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.052,"body_size":454,"content_type":"application/json"}
2025-10-30T19:22:19+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.051,"body_size":454,"content_type":"application/json"}
2025-10-30T19:22:19+00:00 INFO ✓ OpenRouterMetrics::getAccountStatus() - успешно {"key_info":{"label":"sk-or-v1-c31...7e5","usage":5.94e-6,"limit":1,"is_free_tier":false,"rate_limit":{"requests":-1,"interval":"10s"}},"balance":0.99999406,"usage_stats":{"total_usage":5.94e-6,"limit":1,"remaining":0.99999406,"usage_percent":0,"is_free_tier":false},"rate_limits":{"requests":-1,"interval":"10s","description":"Лимиты не установлены"}}
2025-10-30T19:22:19+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.127,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:22:19+00:00 INFO ✓ OpenRouterMetrics::getModels() - успешно {"models_count":349}
2025-10-30T19:22:19+00:00 INFO HTTP запрос выполнен [GET models] код 200 {"method":"GET","uri":"models","status_code":200,"duration":0.098,"body_size":481712,"content_type":"application/json"}
2025-10-30T19:22:19+00:00 INFO ✓ OpenRouterMetrics::estimateCost() - успешно {"prompt_cost":0,"completion_cost":0,"total_cost":0,"model":"openai/gpt-3.5-turbo","tokens":{"prompt":100,"completion":50,"total":150}}
2025-10-30T19:22:19+00:00 INFO HTTP запрос выполнен [GET auth/key] код 200 {"method":"GET","uri":"auth/key","status_code":200,"duration":0.07,"body_size":454,"content_type":"application/json"}
2025-10-30T19:22:19+00:00 INFO ✓ OpenRouterMetrics::hasEnoughBalance() - успешно {"has_balance":true}
2025-10-30T19:22:20+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":0.925,"body_size":532,"content_type":"application/json"}
2025-10-30T19:22:20+00:00 INFO ✓ OpenRouter::text2text() - успешно {"model":"openai/gpt-3.5-turbo","prompt":"Say 'OK'","response":"OK","response_length":2}
2025-10-30T19:22:21+00:00 INFO HTTP потоковый запрос выполнен [POST chat/completions] код 200, получено 3320 байт {"method":"POST","uri":"chat/completions","status_code":200,"bytes_received":3320,"duration":0.621}
2025-10-30T19:22:21+00:00 INFO ✓ OpenRouter::textStream() - успешно {"model":"openai/gpt-3.5-turbo","prompt":"Count: 1, 2, 3","chunks_count":10,"response":"4, 5, 6"}
2025-10-30T19:22:21+00:00 INFO ✓ Validation: Empty model - успешно {"exception":"Параметр \"model\" не может быть пустым."}
2025-10-30T19:22:21+00:00 INFO ✓ Validation: Empty prompt - успешно {"exception":"Параметр \"prompt\" не может быть пустым."}
2025-10-30T19:22:21+00:00 INFO ✓ Validation: Negative tokens - успешно {"exception":"Количество токенов запроса не может быть отрицательным."}
2025-10-30T19:22:21+00:00 INFO ✓ Validation: Negative cost - успешно {"exception":"Стоимость не может быть отрицательной."}
2025-10-30T19:22:21+00:00 INFO === Тестирование завершено === {}
2025-10-30T19:22:21+00:00 INFO Успешно: 14/14 (100%) {}
