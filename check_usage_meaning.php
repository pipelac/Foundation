<?php

declare(strict_types=1);

/**
 * ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°: Ñ‡Ñ‚Ğ¾ Ğ¸Ğ¼ĞµĞ½Ğ½Ğ¾ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ÑÑ Ğ² Ğ¿Ğ¾Ğ»Ğµ "usage"?
 */

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n";
echo "â•‘         ĞĞĞĞ›Ğ˜Ğ—: Ğ§Ğ¢Ğ Ğ¡ĞĞ”Ğ•Ğ Ğ–Ğ˜Ğ¢ ĞŸĞĞ›Ğ• 'usage' Ğ’ OPENROUTER API?             â•‘\n";
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n";

// Ğ ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ· API
$apiResponse = [
    "usage" => 0.0003780711,
    "usage_cache" => null,
    "usage_data" => -0.0000038189,
    "usage_web" => null,
    "usage_file" => 0,
];

echo "ğŸ“Š Ğ”ĞĞĞĞ«Ğ• Ğ˜Ğ— API:\n\n";
printf("usage:        $%.10f\n", $apiResponse['usage']);
printf("usage_cache:  %s\n", $apiResponse['usage_cache'] ?? 'null');
printf("usage_data:   $%.10f (Ğ¾Ñ‚Ñ€Ğ¸Ñ†Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ)\n", $apiResponse['usage_data']);
printf("usage_web:    %s\n", $apiResponse['usage_web'] ?? 'null');
printf("usage_file:   $%.10f\n", $apiResponse['usage_file']);

echo "\n" . str_repeat("â”€", 75) . "\n\n";

echo "ğŸ¤” Ğ’ĞĞ Ğ˜ĞĞĞ¢Ğ« Ğ˜ĞĞ¢Ğ•Ğ ĞŸĞ Ğ•Ğ¢ĞĞ¦Ğ˜Ğ˜:\n\n";

echo "Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1: usage = GROSS COST (Ğ´Ğ¾ ÑĞºĞ¸Ğ´Ğ¾Ğº)\n";
echo "   Ğ¢Ğ¾Ğ³Ğ´Ğ°: final_cost = usage + usage_cache + usage_data + usage_web + usage_file\n";
$finalCost1 = $apiResponse['usage'] 
    + ($apiResponse['usage_cache'] ?? 0)
    + ($apiResponse['usage_data'] ?? 0)
    + ($apiResponse['usage_web'] ?? 0)
    + ($apiResponse['usage_file'] ?? 0);
printf("   final_cost = $%.10f\n", $finalCost1);
echo "   Ğ¡ĞºĞ¸Ğ´ĞºĞ°: $" . abs($apiResponse['usage_data']) . "\n\n";

echo "Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 2: usage = FINAL COST (ÑƒĞ¶Ğµ Ğ¿Ğ¾ÑĞ»Ğµ Ğ²ÑĞµÑ… ÑĞºĞ¸Ğ´Ğ¾Ğº)\n";
echo "   Ğ¢Ğ¾Ğ³Ğ´Ğ°: final_cost = usage (Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼)\n";
printf("   final_cost = $%.10f\n", $apiResponse['usage']);
echo "   usage_data, usage_cache - ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ Ğ¾ ÑĞºĞ¸Ğ´ĞºĞ°Ñ…\n\n";

echo str_repeat("â”€", 75) . "\n\n";

echo "ğŸ’¡ Ğ›ĞĞ“Ğ˜ĞšĞ:\n\n";
echo "Ğ•ÑĞ»Ğ¸ usage_data = -$0.0000038189 ÑÑ‚Ğ¾ ÑĞºĞ¸Ğ´ĞºĞ°,\n";
echo "Ñ‚Ğ¾ Ğ¿Ğ¾ÑĞ»Ğµ ĞµÑ‘ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ£ĞœĞ•ĞĞ¬Ğ¨Ğ˜Ğ¢Ğ¬Ğ¡Ğ¯.\n\n";

echo "Ğ˜Ğ·Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ (Ğ´Ğ¾ ÑĞºĞ¸Ğ´Ğ¾Ğº): Ğ½ĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ°\n";
echo "Ğ¡ĞºĞ¸Ğ´ĞºĞ° (usage_data):                -$0.0000038189\n";
echo "Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ (usage):        $0.0003780711\n\n";

echo "Ğ•ÑĞ»Ğ¸ usage - ÑÑ‚Ğ¾ Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ, Ñ‚Ğ¾:\n";
echo "Gross cost = usage - usage_data = $0.0003780711 - (-$0.0000038189) = $0.00038189\n\n";

echo str_repeat("â”€", 75) . "\n\n";

echo "â“ Ğ’ĞĞŸĞ ĞĞ¡ Ğš ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ®:\n\n";
echo "ĞŸĞ¾Ğ»Ğµ 'usage' Ğ² OpenRouter API - ÑÑ‚Ğ¾:\n";
echo "  A) Gross cost (Ğ´Ğ¾ ÑĞºĞ¸Ğ´Ğ¾Ğº) ?\n";
echo "  B) Final cost (Ğ¿Ğ¾ÑĞ»Ğµ Ğ²ÑĞµÑ… ÑĞºĞ¸Ğ´Ğ¾Ğº) ?\n\n";

echo "Ğ•ÑĞ»Ğ¸ B) - Ñ‚Ğ¾ Ğ½Ğ°ÑˆĞ¸ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ñ‹ Ğ±Ñ‹Ğ»Ğ¸ Ğ¸Ğ·Ğ»Ğ¸ÑˆĞ½Ğ¸Ğ¼Ğ¸, Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾:\n";
echo "  1. Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´ calculateFinalCost()\n";
echo "  2. ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ: final_cost = usage\n";
echo "  3. ĞŸĞ¾Ğ»Ñ usage_cache, usage_data - Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸\n\n";

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n";
echo "â•‘                     ĞĞ–Ğ˜Ğ”ĞĞ•Ğœ ĞŸĞĞ”Ğ¢Ğ’Ğ•Ğ Ğ–Ğ”Ğ•ĞĞ˜Ğ•                                â•‘\n";
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n";
