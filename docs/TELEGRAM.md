# Telegram - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –û–ø–∏—Å–∞–Ω–∏–µ

`Telegram` - –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram Bot API. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—É—é –∏ –Ω–∞–¥–µ–∂–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Telegram –±–æ—Ç–∞–º–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –≤–∏–¥–µ–æ, –∞—É–¥–∏–æ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º (HTML, Markdown)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Ñ–æ—Ç–æ)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–∏–¥–µ–æ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π streaming
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–ª—é–±—ã–µ —Ñ–∞–π–ª—ã –¥–æ 50 –ú–ë)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π –∫ –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ URL –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –ø—É—Ç–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Ç–∞–π–º–∞—É—Ç—ã –∏ retry
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ default chat ID
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Logger
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- PHP 8.1+
- –†–∞—Å—à–∏—Ä–µ–Ω–∏—è: `json`, `curl`
- –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ (–ø–æ–ª—É—á–∏—Ç—å —É [@BotFather](https://t.me/botfather))
- Composer (–¥–ª—è Guzzle HTTP –∫–ª–∏–µ–Ω—Ç–∞)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
composer install
```

## –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞

1. –ù–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/botfather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞
4. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ `123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11`
5. –£–∑–Ω–∞–π—Ç–µ —Å–≤–æ–π Chat ID —á–µ—Ä–µ–∑ [@userinfobot](https://t.me/userinfobot)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `config/telegram.json`:

```json
{
    "token": "123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11",
    "default_chat_id": "123456789",
    "timeout": 30,
    "retries": 3
}
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|--------------|----------|
| `token` | string | –î–∞ | - | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ |
| `default_chat_id` | string | –ù–µ—Ç | - | ID —á–∞—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| `timeout` | int | –ù–µ—Ç | 30 | –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö |
| `retries` | int | –ù–µ—Ç | - | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ |

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```php
use App\Component\Telegram;
use App\Component\Logger;
use App\Component\Config\ConfigLoader;

// –° –ª–æ–≥–≥–µ—Ä–æ–º
$config = ConfigLoader::load(__DIR__ . '/config/telegram.json');
$loggerConfig = ConfigLoader::load(__DIR__ . '/config/logger.json');
$logger = new Logger($loggerConfig);
$telegram = new Telegram($config, $logger);

// –ë–µ–∑ –ª–æ–≥–≥–µ—Ä–∞
$telegram = new Telegram($config);
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

```php
// –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
$telegram->sendText('123456789', '–ü—Ä–∏–≤–µ—Ç –∏–∑ PHP!');

// –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º default_chat_id
$telegram->sendText(null, '–°–æ–æ–±—â–µ–Ω–∏–µ –≤ default —á–∞—Ç');

// –° —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º HTML
$telegram->sendText('123456789', '<b>–ñ–∏—Ä–Ω—ã–π</b> –∏ <i>–∫—É—Ä—Å–∏–≤</i>', [
    'parse_mode' => Telegram::PARSE_MODE_HTML,
]);

// –° —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º Markdown
$telegram->sendText('123456789', '*–ñ–∏—Ä–Ω—ã–π* –∏ _–∫—É—Ä—Å–∏–≤_', [
    'parse_mode' => Telegram::PARSE_MODE_MARKDOWN,
]);

// –° –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –æ–ø—Ü–∏—è–º–∏
$telegram->sendText('123456789', '–í–∞–∂–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', [
    'disable_notification' => false,        // –°–æ –∑–≤—É–∫–æ–º
    'disable_web_page_preview' => true,     // –ë–µ–∑ –ø—Ä–µ–≤—å—é —Å—Å—ã–ª–æ–∫
    'protect_content' => true,              // –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –ø–µ—Ä–µ—Å—ã–ª–∫—É
]);
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

```php
// –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ URL
$telegram->sendPhoto('123456789', 'https://example.com/image.jpg');

// –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
$telegram->sendPhoto('123456789', '/path/to/image.jpg');

// –° –ø–æ–¥–ø–∏—Å—å—é
$telegram->sendPhoto('123456789', '/path/to/photo.jpg', [
    'caption' => '–ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ç–æ!',
]);

// –° HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤ –ø–æ–¥–ø–∏—Å–∏
$telegram->sendPhoto('123456789', 'https://example.com/photo.jpg', [
    'caption' => '<b>–§–æ—Ç–æ –¥–Ω—è</b> üì∏',
    'parse_mode' => Telegram::PARSE_MODE_HTML,
]);
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–∏–¥–µ–æ

```php
// –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–∏–¥–µ–æ
$telegram->sendVideo('123456789', 'https://example.com/video.mp4');

// –° –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
$telegram->sendVideo('123456789', '/path/to/video.mp4', [
    'caption' => '–í–∏–¥–µ–æ –æ–±—É—á–µ–Ω–∏–µ',
    'duration' => 120,                      // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    'width' => 1920,
    'height' => 1080,
    'supports_streaming' => true,           // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
]);
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –∞—É–¥–∏–æ

```php
// –û—Ç–ø—Ä–∞–≤–∫–∞ –∞—É–¥–∏–æ —Ñ–∞–π–ª–∞
$telegram->sendAudio('123456789', '/path/to/audio.mp3');

// –° –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
$telegram->sendAudio('123456789', 'https://example.com/song.mp3', [
    'title' => '–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞',
    'performer' => '–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å',
    'duration' => 180,
    'caption' => '–ù–æ–≤–∞—è –º—É–∑—ã–∫–∞!',
]);
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

```php
// –û—Ç–ø—Ä–∞–≤–∫–∞ –ª—é–±–æ–≥–æ —Ñ–∞–π–ª–∞
$telegram->sendDocument('123456789', '/path/to/document.pdf');

// –° –ø–æ–¥–ø–∏—Å—å—é
$telegram->sendDocument('123456789', '/path/to/report.pdf', [
    'caption' => '–û—Ç—á–µ—Ç –∑–∞ —è–Ω–≤–∞—Ä—å 2024',
    'disable_content_type_detection' => false,
]);

// –û—Ç–ø—Ä–∞–≤–∫–∞ ZIP –∞—Ä—Ö–∏–≤–∞
$telegram->sendDocument('123456789', '/path/to/archive.zip', [
    'caption' => '–ê—Ä—Ö–∏–≤ —Å —Ñ–∞–π–ª–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞',
]);
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

```php
class TelegramNotifier
{
    private Telegram $telegram;
    private string $chatId;
    
    public function __construct(Telegram $telegram, string $chatId)
    {
        $this->telegram = $telegram;
        $this->chatId = $chatId;
    }
    
    public function notifyError(string $message, array $context = []): void
    {
        $text = "üî¥ <b>–û—à–∏–±–∫–∞</b>\n\n";
        $text .= $message . "\n\n";
        
        if (!empty($context)) {
            $text .= "<b>–ö–æ–Ω—Ç–µ–∫—Å—Ç:</b>\n";
            foreach ($context as $key => $value) {
                $text .= "‚Ä¢ {$key}: {$value}\n";
            }
        }
        
        $text .= "\n<i>" . date('Y-m-d H:i:s') . "</i>";
        
        try {
            $this->telegram->sendText($this->chatId, $text, [
                'parse_mode' => Telegram::PARSE_MODE_HTML,
            ]);
        } catch (Exception $e) {
            error_log("Failed to send Telegram notification: " . $e->getMessage());
        }
    }
    
    public function notifySuccess(string $message): void
    {
        $text = "‚úÖ <b>–£—Å–ø–µ—Ö</b>\n\n{$message}";
        
        $this->telegram->sendText($this->chatId, $text, [
            'parse_mode' => Telegram::PARSE_MODE_HTML,
            'disable_notification' => true, // –ë–µ–∑ –∑–≤—É–∫–∞
        ]);
    }
    
    public function notifyWarning(string $message): void
    {
        $text = "‚ö†Ô∏è <b>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</b>\n\n{$message}";
        
        $this->telegram->sendText($this->chatId, $text, [
            'parse_mode' => Telegram::PARSE_MODE_HTML,
        ]);
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
$notifier = new TelegramNotifier($telegram, '123456789');

$notifier->notifyError('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î', [
    'host' => 'localhost',
    'error' => 'Connection refused',
]);

$notifier->notifySuccess('–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ');
$notifier->notifyWarning('–û—Å—Ç–∞–ª–æ—Å—å –º–∞–ª–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ (10%)');
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–æ–≤

```php
class ReportSender
{
    private Telegram $telegram;
    private MySQL $mysql;
    
    public function __construct(Telegram $telegram, MySQL $mysql)
    {
        $this->telegram = $telegram;
        $this->mysql = $mysql;
    }
    
    public function sendDailyReport(string $chatId): void
    {
        // –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        $stats = $this->mysql->queryOne('
            SELECT 
                COUNT(*) as total_users,
                COUNT(CASE WHEN last_login >= CURDATE() THEN 1 END) as active_today,
                COUNT(CASE WHEN created_at >= CURDATE() THEN 1 END) as new_today
            FROM users
        ');
        
        // –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç
        $text = "üìä <b>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç</b>\n\n";
        $text .= "üë• –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {$stats['total_users']}\n";
        $text .= "‚úÖ –ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è: {$stats['active_today']}\n";
        $text .= "üÜï –ù–æ–≤—ã—Ö —Å–µ–≥–æ–¥–Ω—è: {$stats['new_today']}\n\n";
        $text .= "üìÖ " . date('d.m.Y H:i');
        
        // –û—Ç–ø—Ä–∞–≤–∏—Ç—å
        $this->telegram->sendText($chatId, $text, [
            'parse_mode' => Telegram::PARSE_MODE_HTML,
        ]);
        
        // –ï—Å–ª–∏ –µ—Å—Ç—å –≥—Ä–∞—Ñ–∏–∫, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –µ–≥–æ
        if (file_exists('/path/to/chart.png')) {
            $this->telegram->sendPhoto($chatId, '/path/to/chart.png', [
                'caption' => '–ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞ –Ω–µ–¥–µ–ª—é',
            ]);
        }
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ cron
$sender = new ReportSender($telegram, $mysql);
$sender->sendDailyReport('123456789');
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–∞

```php
class ServerMonitor
{
    private Telegram $telegram;
    private string $chatId;
    
    public function __construct(Telegram $telegram, string $chatId)
    {
        $this->telegram = $telegram;
        $this->chatId = $chatId;
    }
    
    public function checkAndNotify(): void
    {
        $alerts = [];
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ CPU
        $cpuUsage = $this->getCpuUsage();
        if ($cpuUsage > 80) {
            $alerts[] = "üî• CPU: {$cpuUsage}%";
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏
        $memoryUsage = $this->getMemoryUsage();
        if ($memoryUsage > 80) {
            $alerts[] = "üíæ –ü–∞–º—è—Ç—å: {$memoryUsage}%";
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–∞
        $diskUsage = $this->getDiskUsage();
        if ($diskUsage > 90) {
            $alerts[] = "üíø –î–∏—Å–∫: {$diskUsage}%";
        }
        
        if (!empty($alerts)) {
            $text = "‚ö†Ô∏è <b>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞</b>\n\n";
            $text .= implode("\n", $alerts);
            
            $this->telegram->sendText($this->chatId, $text, [
                'parse_mode' => Telegram::PARSE_MODE_HTML,
            ]);
        }
    }
    
    private function getCpuUsage(): float
    {
        $load = sys_getloadavg();
        return round($load[0] * 100 / 4); // –î–ª—è 4 —è–¥–µ—Ä
    }
    
    private function getMemoryUsage(): float
    {
        $free = shell_exec('free');
        $free = (string)$free;
        $free = trim($free);
        preg_match_all('/\s+(\d+)/', $free, $matches);
        return round($matches[1][2] / $matches[1][1] * 100);
    }
    
    private function getDiskUsage(): float
    {
        return round(disk_total_space('/') / disk_free_space('/') * 100);
    }
}

// –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç —á–µ—Ä–µ–∑ cron
$monitor = new ServerMonitor($telegram, '123456789');
$monitor->checkAndNotify();
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤

```php
// –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ PDF –æ—Ç—á–µ—Ç–∞
$pdf->generate();
$telegram->sendDocument('123456789', '/tmp/report.pdf', [
    'caption' => '–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω: ' . date('Y-m-d H:i'),
]);

// –û—Ç–ø—Ä–∞–≤–∫–∞ backup –∞—Ä—Ö–∏–≤–∞
$backup->create();
$telegram->sendDocument('123456789', '/backups/db_backup.zip', [
    'caption' => '–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –ë–î –∑–∞ ' . date('d.m.Y'),
]);

// –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–æ–≥ —Ñ–∞–π–ª–∞
if (file_exists('/var/log/app.log')) {
    $telegram->sendDocument('123456789', '/var/log/app.log', [
        'caption' => '–õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è',
    ]);
}
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å RSS

```php
use App\Component\Rss;

$rss = new Rss();
$telegram = new Telegram($config);

$feed = $rss->fetch('https://example.com/feed.xml');

foreach (array_slice($feed['items'], 0, 5) as $item) {
    $text = "üì∞ <b>{$item['title']}</b>\n\n";
    $text .= strip_tags($item['description']) . "\n\n";
    $text .= "üîó <a href=\"{$item['link']}\">–ß–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é</a>";
    
    $telegram->sendText('123456789', $text, [
        'parse_mode' => Telegram::PARSE_MODE_HTML,
        'disable_web_page_preview' => false,
    ]);
    
    sleep(1); // –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
}
```

## API Reference

### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

```php
public function __construct(array $config, ?Logger $logger = null)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `$config` (array) - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞
- `$logger` (Logger|null) - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ª–æ–≥–≥–µ—Ä

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- `TelegramConfigException` - –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### getMe()

```php
public function getMe(): array
```

–ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ (id, name, username –∏ —Ç.–¥.)

### sendText()

```php
public function sendText(?string $chatId, string $text, array $options = []): array
```

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–¥–æ 4096 —Å–∏–º–≤–æ–ª–æ–≤).

**–û–ø—Ü–∏–∏:**
- `parse_mode` - –†–µ–∂–∏–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (HTML, Markdown, MarkdownV2)
- `disable_web_page_preview` - –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–µ–≤—å—é —Å—Å—ã–ª–æ–∫
- `disable_notification` - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –±–µ–∑ –∑–≤—É–∫–∞
- `protect_content` - –ó–∞—â–∏—Ç–∏—Ç—å –æ—Ç –ø–µ—Ä–µ—Å—ã–ª–∫–∏
- `reply_to_message_id` - ID —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç–≤–µ—Ç–∞

### sendPhoto()

```php
public function sendPhoto(?string $chatId, string $photo, array $options = []): array
```

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (URL –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª).

**–û–ø—Ü–∏–∏:**
- `caption` - –ü–æ–¥–ø–∏—Å—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é (–¥–æ 1024 —Å–∏–º–≤–æ–ª–æ–≤)
- `parse_mode` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏

### sendVideo()

```php
public function sendVideo(?string $chatId, string $video, array $options = []): array
```

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∏–¥–µ–æ (–¥–æ 50 –ú–ë).

**–û–ø—Ü–∏–∏:**
- `caption` - –ü–æ–¥–ø–∏—Å—å
- `duration` - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- `width`, `height` - –†–∞–∑–º–µ—Ä—ã –≤–∏–¥–µ–æ
- `supports_streaming` - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ streaming

### sendAudio()

```php
public function sendAudio(?string $chatId, string $audio, array $options = []): array
```

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞—É–¥–∏–æ —Ñ–∞–π–ª.

**–û–ø—Ü–∏–∏:**
- `caption` - –ü–æ–¥–ø–∏—Å—å
- `duration` - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- `performer` - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
- `title` - –ù–∞–∑–≤–∞–Ω–∏–µ

### sendDocument()

```php
public function sendDocument(?string $chatId, string $document, array $options = []): array
```

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç (–ª—é–±–æ–π —Ñ–∞–π–ª –¥–æ 50 –ú–ë).

**–û–ø—Ü–∏–∏:**
- `caption` - –ü–æ–¥–ø–∏—Å—å
- `disable_content_type_detection` - –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ò—Å–∫–ª—é—á–µ–Ω–∏—è

- `TelegramException` - –ë–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
- `TelegramConfigException` - –û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `TelegramApiException` - –û—à–∏–±–∫–∞ API
- `TelegramFileException` - –û—à–∏–±–∫–∞ —Ñ–∞–π–ª–∞

```php
use App\Component\Exception\TelegramApiException;
use App\Component\Exception\TelegramConfigException;
use App\Component\Exception\TelegramFileException;

try {
    $telegram->sendText('123456789', '–ü—Ä–∏–≤–µ—Ç!');
} catch (TelegramApiException $e) {
    echo "–û—à–∏–±–∫–∞ API: {$e->getMessage()}\n";
} catch (TelegramFileException $e) {
    echo "–û—à–∏–±–∫–∞ —Ñ–∞–π–ª–∞: {$e->getMessage()}\n";
} catch (TelegramConfigException $e) {
    echo "–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: {$e->getMessage()}\n";
}
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ default_chat_id** –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è:
   ```php
   $telegram->sendText(null, '–°–æ–æ–±—â–µ–Ω–∏–µ'); // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç default_chat_id
   ```

2. **–î–æ–±–∞–≤–ª—è–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫**:
   ```php
   try {
       $telegram->sendText($chatId, $message);
   } catch (Exception $e) {
       error_log("Telegram error: " . $e->getMessage());
   }
   ```

3. **–°–æ–±–ª—é–¥–∞–π—Ç–µ –ª–∏–º–∏—Ç—ã** Telegram API:
   - 30 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É
   - 20 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É –≤ –≥—Ä—É–ø–ø—É
   - –î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–∞—É–∑—ã –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   ```php
   // HTML - –ø—Ä–æ—â–µ –∏ –Ω–∞–¥–µ–∂–Ω–µ–µ
   'parse_mode' => Telegram::PARSE_MODE_HTML
   
   // Markdown - —Ç—Ä–µ–±—É–µ—Ç —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤
   'parse_mode' => Telegram::PARSE_MODE_MARKDOWN
   ```

5. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤**:
   ```php
   if (filesize($file) > 50 * 1024 * 1024) {
       throw new Exception('–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π');
   }
   ```

6. **–•—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**:
   - –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –≤ Git
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ config —Ñ–∞–π–ª–∞–º

7. **–õ–æ–≥–∏—Ä—É–π—Ç–µ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è**:
   ```php
   $telegram = new Telegram($config, $logger);
   ```

## –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞

### HTML

```php
$text = "
<b>–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç</b>
<i>–ö—É—Ä—Å–∏–≤</i>
<u>–ü–æ–¥—á–µ—Ä–∫–Ω—É—Ç—ã–π</u>
<s>–ó–∞—á–µ—Ä–∫–Ω—É—Ç—ã–π</s>
<code>–ú–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π</code>
<pre>–ë–ª–æ–∫ –∫–æ–¥–∞</pre>
<a href='https://example.com'>–°—Å—ã–ª–∫–∞</a>
";

$telegram->sendText($chatId, $text, [
    'parse_mode' => Telegram::PARSE_MODE_HTML,
]);
```

### Markdown

```php
$text = "
*–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç*
_–ö—É—Ä—Å–∏–≤_
[–°—Å—ã–ª–∫–∞](https://example.com)
`–ú–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π`
```
–ë–ª–æ–∫ –∫–æ–¥–∞
```
";

$telegram->sendText($chatId, $text, [
    'parse_mode' => Telegram::PARSE_MODE_MARKDOWN,
]);
```

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram API

- –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è: –¥–æ 4096 —Å–∏–º–≤–æ–ª–æ–≤
- –ü–æ–¥–ø–∏—Å—å: –¥–æ 1024 —Å–∏–º–≤–æ–ª–æ–≤
- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: –¥–æ 50 –ú–ë
- –°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏: –¥–æ 30 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É
- –§–æ—Ç–æ: –¥–æ 10 –ú–ë (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–∂–∏–º–∞—Ç—å)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–ó–∞—â–∏—Ç–∞ —Ç–æ–∫–µ–Ω–∞**:
   ```bash
   chmod 600 config/telegram.json
   ```

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è chat_id**:
   ```php
   if (!is_numeric($chatId)) {
       throw new Exception('Invalid chat ID');
   }
   ```

3. **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML**:
   ```php
   $text = htmlspecialchars($userInput, ENT_QUOTES, 'UTF-8');
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤**:
   ```php
   if (!file_exists($file) || !is_readable($file)) {
       throw new Exception('File not accessible');
   }
   ```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `disable_notification` –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫
- –î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–∞—É–∑—ã –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è rate limits
- –ö–µ—à–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã `getMe()` –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–∞—Å—Ç–æ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

## –°–º. —Ç–∞–∫–∂–µ

- [Official Telegram Bot API](https://core.telegram.org/bots/api)
- [Logger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](LOGGER.md) - –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- [RSS –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](RSS.md) - –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –Ω–æ–≤–æ—Å—Ç–Ω—ã–º–∏ –ª–µ–Ω—Ç–∞–º–∏
- [MySQL –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](MYSQL.md) - –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
