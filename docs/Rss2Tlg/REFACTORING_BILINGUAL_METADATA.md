# –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥: –ë–∏–ª–∏–Ω–≥–≤–∞–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫—Ä–æ—Å—Å—è–∑—ã—á–Ω–æ–π –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

**–î–∞—Ç–∞:** 2025-11-10  
**–í–µ—Ä—Å–∏—è:** SummarizationService v2.1  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

---

## üìã –ü—Ä–æ–±–ª–µ–º–∞

**–î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**
- –í—Å–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ç–µ–≥–∏, —Å—É—â–Ω–æ—Å—Ç–∏) —Ö—Ä–∞–Ω–∏–ª–∏—Å—å –Ω–∞ —è–∑—ã–∫–µ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ —Å—Ç–∞—Ç—å–∏
- –î–ª—è —Ä—É—Å—Å–∫–æ–π –Ω–æ–≤–æ—Å—Ç–∏: `["–ò–ª–æ–Ω –ú–∞—Å–∫", "Tesla", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"]`
- –î–ª—è –∞–Ω–≥–ª–∏–π—Å–∫–æ–π –Ω–æ–≤–æ—Å—Ç–∏: `["Elon Musk", "Tesla", "artificial intelligence"]`

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –°–∏—Å—Ç–µ–º–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–µ –º–æ–≥–ª–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö
- –û–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –Ω–æ–≤–æ—Å—Ç—å –ø—Ä–æ –ò–ª–æ–Ω–∞ –ú–∞—Å–∫–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —Å—á–∏—Ç–∞–ª–∞—Å—å —Ä–∞–∑–Ω—ã–º–∏ –Ω–æ–≤–æ—Å—Ç—è–º–∏
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∫—Ä–æ—Å—Å—è–∑—ã—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ—Ö–æ–∂–µ—Å—Ç–∏

---

## üéØ –†–µ—à–µ–Ω–∏–µ

**–ë–∏–ª–∏–Ω–≥–≤–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:**
- –í—Å–µ –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –î–í–£–• –≤–µ—Ä—Å–∏—è—Ö: –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π + –∞–Ω–≥–ª–∏–π—Å–∫–æ–π
- –î–ª—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å—Ç–∞—Ç–µ–π –æ–±–µ –≤–µ—Ä—Å–∏–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã
- –î–ª—è –Ω–µ–∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å—Ç–∞—Ç–µ–π AI –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π

**–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è:**
1. **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏** - `category_primary_en`, `category_secondary_en` (–≤—Å–µ–≥–¥–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º)
2. **–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞** - `keywords_en` (–∞–Ω–≥–ª–∏–π—Å–∫–∞—è –≤–µ—Ä—Å–∏—è —Ç–µ–≥–æ–≤)
3. **–°—É—â–Ω–æ—Å—Ç–∏** - `dedup_canonical_entities_en` (–∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –∏–º–µ–Ω–∞ –ª—é–¥–µ–π, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π, –º–µ—Å—Ç)
4. **–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è** - `dedup_core_event_en` (–∞–Ω–≥–ª–∏–π—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è)

---

## üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î

### –ù–æ–≤—ã–µ –ø–æ–ª—è –≤ `rss2tlg_summarization`:

```sql
ALTER TABLE `rss2tlg_summarization`
    ADD COLUMN `category_primary_en` varchar(100) DEFAULT NULL 
        COMMENT '–û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º' AFTER `category_primary`,
    
    ADD COLUMN `category_secondary_en` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL 
        COMMENT '–ú–∞—Å—Å–∏–≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º' 
        CHECK (json_valid(`category_secondary_en`)) AFTER `category_secondary`,
    
    ADD COLUMN `keywords_en` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL 
        COMMENT '–ú–∞—Å—Å–∏–≤ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º' 
        CHECK (json_valid(`keywords_en`)) AFTER `keywords`,
    
    ADD COLUMN `dedup_canonical_entities_en` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL 
        COMMENT '–ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏' 
        CHECK (json_valid(`dedup_canonical_entities_en`)) AFTER `dedup_canonical_entities`,
    
    ADD COLUMN `dedup_core_event_en` text DEFAULT NULL 
        COMMENT '–û–ø–∏—Å–∞–Ω–∏–µ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º' AFTER `dedup_core_event`;

CREATE INDEX idx_category_primary_en ON rss2tlg_summarization(category_primary_en);
```

**–ú–∏–≥—Ä–∞—Ü–∏—è:** `/home/engine/project/production/sql/migration_add_en_fields.sql`

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–º–ø—Ç–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON –æ—Ç–≤–µ—Ç–∞:

**–î–ª—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å—Ç–∞—Ç–µ–π:**
```json
{
  "article_language": "en",
  "category": {
    "primary": "technology",
    "primary_en": "technology",
    "secondary": ["business", "ai"],
    "secondary_en": ["business", "ai"]
  },
  "content": {
    "headline": "Tesla launches new $25K EV in China",
    "summary": "...",
    "keywords": ["elon musk", "tesla", "electric vehicle"],
    "keywords_en": ["elon musk", "tesla", "electric vehicle"]
  },
  "deduplication": {
    "canonical_entities": ["Elon Musk", "Tesla", "China"],
    "canonical_entities_en": ["Elon Musk", "Tesla", "China"],
    "core_event": "Tesla announced...",
    "core_event_en": "Tesla announced...",
    "numeric_facts": ["$25,000", "2024-Q2"]
  }
}
```

**–î–ª—è –Ω–µ–∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å—Ç–∞—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä—É—Å—Å–∫–∏—Ö):**
```json
{
  "article_language": "ru",
  "category": {
    "primary": "technology",
    "primary_en": "technology",
    "secondary": ["business", "ai"],
    "secondary_en": ["business", "ai"]
  },
  "content": {
    "headline": "Tesla –∑–∞–ø—É—Å—Ç–∏–ª–∞ –Ω–æ–≤—ã–π —ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª—å –∑–∞ $25K –≤ –ö–∏—Ç–∞–µ",
    "summary": "...",
    "keywords": ["–∏–ª–æ–Ω –º–∞—Å–∫", "tesla", "—ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª—å", "–∫–∏—Ç–∞–π", "—Ü–µ–Ω–∞"],
    "keywords_en": ["elon musk", "tesla", "electric vehicle", "china", "price"]
  },
  "deduplication": {
    "canonical_entities": ["–ò–ª–æ–Ω –ú–∞—Å–∫", "Tesla", "–ö–∏—Ç–∞–π"],
    "canonical_entities_en": ["Elon Musk", "Tesla", "China"],
    "core_event": "–ö–æ–º–ø–∞–Ω–∏—è Tesla –æ–±—ä—è–≤–∏–ª–∞ –æ –∑–∞–ø—É—Å–∫–µ...",
    "core_event_en": "Tesla announced the launch...",
    "numeric_facts": ["$25,000", "2024-Q2"]
  }
}
```

**–ü—Ä–æ–º–ø—Ç:** `/home/engine/project/src/Rss2Tlg/prompts/summarization_prompt_v2.txt`

---

## üíª –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### `SummarizationService::saveResult()`

**–î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö –≤–µ—Ä—Å–∏–π:**

```php
// –ö–∞—Ç–µ–≥–æ—Ä–∏–∏: –≤—Å–µ–≥–¥–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã)
$categoryPrimary = $analysisData['category']['primary'] ?? null;
$categoryPrimaryEn = $analysisData['category']['primary_en'] ?? $categoryPrimary;

// –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: –æ—Ä–∏–≥–∏–Ω–∞–ª + –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
$keywords = $analysisData['content']['keywords'] ?? [];
$keywordsEn = $analysisData['content']['keywords_en'] ?? $keywords;

// –°—É—â–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏: –æ—Ä–∏–≥–∏–Ω–∞–ª + –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
$entities = $analysisData['deduplication']['canonical_entities'] ?? [];
$entitiesEn = $analysisData['deduplication']['canonical_entities_en'] ?? $entities;

// –û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è: –æ—Ä–∏–≥–∏–Ω–∞–ª + –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
$coreEvent = $analysisData['deduplication']['core_event'] ?? null;
$coreEventEn = $analysisData['deduplication']['core_event_en'] ?? $coreEvent;
```

**–§–∞–π–ª:** `/home/engine/project/src/Rss2Tlg/Pipeline/SummarizationService.php`

---

## üîÑ –í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏

### DeduplicationService (–±—É–¥—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ —Å –∞–Ω–≥–ª–∏–π—Å–∫–∏–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏:**

1. **–ë—ã—Å—Ç—Ä–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ (–±–µ–∑ AI):**
   - –°—Ä–∞–≤–Ω–∏—Ç—å `category_primary_en` (–µ—Å–ª–∏ —Ä–∞–∑–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí –Ω–µ –¥—É–±–ª–∏–∫–∞—Ç)
   - –°—Ä–∞–≤–Ω–∏—Ç—å `dedup_canonical_entities_en` (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å—Ö–æ–∂–µ—Å—Ç–∏ Jaccard)
   - –°—Ä–∞–≤–Ω–∏—Ç—å `keywords_en` (–∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –∏–ª–∏ Jaccard)
   - –ï—Å–ª–∏ —Å—Ö–æ–∂–µ—Å—Ç—å < 30% ‚Üí —Ç–æ—á–Ω–æ –Ω–µ –¥—É–±–ª–∏–∫–∞—Ç (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å AI –∞–Ω–∞–ª–∏–∑)

2. **–ì–ª—É–±–æ–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ (—Å AI):**
   - –ï—Å–ª–∏ —Å—Ö–æ–∂–µ—Å—Ç—å 30-70% ‚Üí –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ AI –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `dedup_core_event_en` –∏ `dedup_canonical_entities_en`
   - AI —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ)

3. **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
   - ‚úÖ –ö—Ä–æ—Å—Å—è–∑—ã—á–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ: RU ‚Üî EN ‚Üî DE ‚Üî FR
   - ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤: –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –æ—Ç—Å–µ–∏–≤–∞—é—Ç—Å—è –±–µ–∑ AI
   - ‚úÖ –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å: AI —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–º–µ—Ä:**
```php
// –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ AI
$entities1_en = ["Elon Musk", "Tesla", "China"];
$entities2_en = ["–ò–ª–æ–Ω –ú–∞—Å–∫", "Tesla", "–ö–∏—Ç–∞–π"] ‚Üí ["Elon Musk", "Tesla", "China"];

$similarity = calculateJaccardSimilarity($entities1_en, $entities2_en);
// –†–µ–∑—É–ª—å—Ç–∞—Ç: 100% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ ‚Üí –≤–µ—Ä–æ—è—Ç–Ω—ã–π –¥—É–±–ª–∏–∫–∞—Ç ‚Üí –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ AI
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### 1. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∫–∞–∫ –¥—É–±–ª–∏–∫–∞—Ç—ã
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —è–∑—ã–∫–∞

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç
- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π –æ—Ç—Å–µ–∏–≤–∞—é—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (–±–µ–∑ AI)
- AI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ (30-70% —Å—Ö–æ–∂–µ—Å—Ç–∏)
- –≠–∫–æ–Ω–æ–º–∏—è ~60-80% —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

### 3. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —è–∑—ã–∫–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏
- –ê–Ω–≥–ª–∏–π—Å–∫–∏–π –∫–∞–∫ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —è–∑—ã–∫-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫

### 4. –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –Ω–∞ –µ–¥–∏–Ω–æ–º —è–∑—ã–∫–µ
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫—Ä–æ—Å—Å—è–∑—ã—á–Ω—ã—Ö –≥—Ä–∞—Ñ–æ–≤ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –Ω–æ–≤–æ—Å—Ç—è–º–∏

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä—É—Å—Å–∫–æ–π –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–π –Ω–æ–≤–æ—Å—Ç–∏:

**–†—É—Å—Å–∫–∞—è –Ω–æ–≤–æ—Å—Ç—å:**
```
–ó–∞–≥–æ–ª–æ–≤–æ–∫: "–ò–ª–æ–Ω –ú–∞—Å–∫ –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–ª –∑–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –ò–ò"
–°—É—â–Ω–æ—Å—Ç–∏ (RU): ["–ò–ª–æ–Ω –ú–∞—Å–∫", "SpaceX", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"]
–°—É—â–Ω–æ—Å—Ç–∏ (EN): ["Elon Musk", "SpaceX", "artificial intelligence"]
```

**–ê–Ω–≥–ª–∏–π—Å–∫–∞—è –Ω–æ–≤–æ—Å—Ç—å:**
```
–ó–∞–≥–æ–ª–æ–≤–æ–∫: "Elon Musk announces new AI project launch"
–°—É—â–Ω–æ—Å—Ç–∏ (EN): ["Elon Musk", "SpaceX", "artificial intelligence"]
–°—É—â–Ω–æ—Å—Ç–∏ (EN): ["Elon Musk", "SpaceX", "artificial intelligence"]
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏:**
- –ë—ã—Å—Ç—Ä–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ `canonical_entities_en`: 100% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
- –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ AI –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- AI –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç: –¥—É–±–ª–∏–∫–∞—Ç (similarity: 95%)
- ‚úÖ –í—Ç–æ—Ä–∞—è –Ω–æ–≤–æ—Å—Ç—å –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ –¥—É–±–ª–∏–∫–∞—Ç –ø–µ—Ä–≤–æ–π

---

## üöÄ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

**–í–Ω–∏–º–∞–Ω–∏–µ:** –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π –≤ `rss2tlg_summarization` –ø–æ–ª—è `*_en` –±—É–¥—É—Ç `NULL`.

**–û–ø—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏:**

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†–µ–æ–±—Ä–∞–±–æ—Ç–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```sql
-- –ü–æ–º–µ—Ç–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
UPDATE rss2tlg_summarization 
SET status = 'pending', processed_at = NULL
WHERE category_primary_en IS NULL;
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å—Ç–∞—Ç–µ–π
```sql
-- –î–ª—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å—Ç–∞—Ç–µ–π —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
UPDATE rss2tlg_summarization 
SET 
    category_primary_en = category_primary,
    category_secondary_en = category_secondary,
    keywords_en = keywords,
    dedup_canonical_entities_en = dedup_canonical_entities,
    dedup_core_event_en = dedup_core_event
WHERE article_language = 'en' AND category_primary_en IS NULL;
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
- –ù–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç —Å `*_en` –ø–æ–ª—è–º–∏
- –°—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –±–µ–∑ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö –≤–µ—Ä—Å–∏–π
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

- [x] –°–æ–∑–¥–∞–Ω–∞ SQL –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π
- [x] –û–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–æ–º–ø—Ç `summarization_prompt_v2.txt` —Å –±–∏–ª–∏–Ω–≥–≤–∞–ª—å–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏
- [x] –û–±–Ω–æ–≤–ª–µ–Ω –∫–æ–¥ `SummarizationService::saveResult()` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö –≤–µ—Ä—Å–∏–π
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É
- [ ] –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ SQL –º–∏–≥—Ä–∞—Ü–∏—è –∫ production –ë–î
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω SummarizationService —Å –Ω–æ–≤—ã–º –ø—Ä–æ–º–ø—Ç–æ–º (RU + EN —Å—Ç–∞—Ç—å–∏)
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω DeduplicationService –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `*_en` –ø–æ–ª–µ–π
- [ ] –ü—Ä–æ–≤–µ–¥–µ–Ω–æ end-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–æ—Å—Å—è–∑—ã—á–Ω–æ–π –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- `/home/engine/project/production/sql/migration_add_en_fields.sql`

**–ö–æ–¥:**
- `/home/engine/project/src/Rss2Tlg/Pipeline/SummarizationService.php`

**–ü—Ä–æ–º–ø—Ç—ã:**
- `/home/engine/project/src/Rss2Tlg/prompts/summarization_prompt_v2.txt`
- `/home/engine/project/production/prompts/summarization_prompt_v2.txt`

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- `/home/engine/project/docs/Rss2Tlg/REFACTORING_BILINGUAL_METADATA.md` (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:**
   - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è `headline_en`, `summary_en` –¥–ª—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–∏–ª–∏–Ω–≥–≤–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

2. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —è–∑—ã–∫–æ–≤:**
   - –î–æ–±–∞–≤–∏—Ç—å `headline_de`, `summary_de` –∏ —Ç.–¥. –¥–ª—è –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

3. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤:**
   - –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã —Å—É—â–Ω–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ò–ª–æ–Ω –ú–∞—Å–∫" ‚Üí "Elon Musk")
   - –°–Ω–∏–∑–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ AI –¥–ª—è —á–∞—Å—Ç—ã—Ö –∏–º–µ–Ω

4. **–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:**
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤
   - A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-10  
**–ê–≤—Ç–æ—Ä:** AI Pipeline Development Team  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0
