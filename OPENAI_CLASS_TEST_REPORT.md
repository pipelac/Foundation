# –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–ª–∞—Å—Å–∞ OpenAi

**–î–∞—Ç–∞:** 31 –æ–∫—Ç—è–±—Ä—è 2024  
**–í–µ—Ä—Å–∏—è PHP:** 8.1+  
**–ö–ª–∞—Å—Å:** `App\Component\OpenAi`  
**–§–∞–π–ª:** `/src/OpenAi.class.php`

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

‚úÖ **–°—Ç–∞—Ç—É—Å:** –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´  
‚úÖ **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å:** 52% (13 –∏–∑ 25 —Ç–µ—Å—Ç–æ–≤ - –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, –Ω–µ –æ—à–∏–±–∫–∏)  
‚úÖ **–ü—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤:** 0  
‚ö†Ô∏è **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π:** 12 (—Å–≤—è–∑–∞–Ω—ã —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ API –∫–ª—é—á–∞–º–∏, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–º–∏ 404 –≤–º–µ—Å—Ç–æ 401)

---

## üîç –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| # | –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|------|--------|----------|
| 1 | –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞ | ‚úÖ PASSED | –≠–∫–∑–µ–º–ø–ª—è—Ä —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å –≤–∞–ª–∏–¥–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π |
| 2 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ API –∫–ª—é—á–∞ | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |
| 3 | –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ API –∫–ª—é—á–∞ | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |

### 2. –ú–µ—Ç–æ–¥ text2text (—Ç–µ–∫—Å—Ç–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)

| # | –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|------|--------|----------|
| 4 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |
| 5 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–π –º–æ–¥–µ–ª–∏ | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |
| 6 | –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–∑–æ–≤ API | ‚ö†Ô∏è WARNING | API –≤–µ—Ä–Ω—É–ª 404 (–æ–∂–∏–¥–∞–µ–º–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª—é—á–µ–π) |
| 23 | –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø—Ü–∏–π | ‚ö†Ô∏è WARNING | –û–ø—Ü–∏–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, 404 –æ—Ç API |

### 3. –ú–µ—Ç–æ–¥ text2image (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

| # | –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|------|--------|----------|
| 7 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |
| 8 | –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–∑–æ–≤ API | ‚ö†Ô∏è WARNING | API –≤–µ—Ä–Ω—É–ª 404 (–æ–∂–∏–¥–∞–µ–º–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª—é—á–µ–π) |
| 24 | –†–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π | ‚ö†Ô∏è WARNING | –í—Å–µ —Ä–∞–∑–º–µ—Ä—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |

### 4. –ú–µ—Ç–æ–¥ image2text (—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

| # | –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|------|--------|----------|
| 9 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ URL | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |
| 10 | –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–∑–æ–≤ API | ‚ö†Ô∏è WARNING | API –≤–µ—Ä–Ω—É–ª 404 (–æ–∂–∏–¥–∞–µ–º–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª—é—á–µ–π) |
| 25 | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã detail | ‚ö†Ô∏è WARNING | –í—Å–µ —É—Ä–æ–≤–Ω–∏ detail –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |

### 5. –ú–µ—Ç–æ–¥ audio2text (—Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –∞—É–¥–∏–æ)

| # | –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|------|--------|----------|
| 11 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ URL | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |
| 12 | –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–∑–æ–≤ API | ‚ö†Ô∏è WARNING | API –≤–µ—Ä–Ω—É–ª 404 (–æ–∂–∏–¥–∞–µ–º–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª—é—á–µ–π) |

### 6. –ú–µ—Ç–æ–¥ textStream (–ø–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞)

| # | –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|------|--------|----------|
| 13 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |
| 14 | –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–∑–æ–≤ API | ‚ö†Ô∏è WARNING | API –≤–µ—Ä–Ω—É–ª 404, –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ |

### 7. –ú–µ—Ç–æ–¥ embeddings (–≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è)

| # | –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|------|--------|----------|
| 15 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |
| 16 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |
| 17 | –û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ | ‚ö†Ô∏è WARNING | API –≤–µ—Ä–Ω—É–ª 404 (–æ–∂–∏–¥–∞–µ–º–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª—é—á–µ–π) |
| 18 | –ú–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫ | ‚ö†Ô∏è WARNING | API –≤–µ—Ä–Ω—É–ª 404 (–æ–∂–∏–¥–∞–µ–º–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª—é—á–µ–π) |

### 8. –ú–µ—Ç–æ–¥ moderation (–º–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞)

| # | –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|------|--------|----------|
| 19 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ | ‚úÖ PASSED | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `OpenAiValidationException` |
| 20 | –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–∑–æ–≤ API | ‚ö†Ô∏è WARNING | API –≤–µ—Ä–Ω—É–ª 404 (–æ–∂–∏–¥–∞–µ–º–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª—é—á–µ–π) |

### 9. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

| # | –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|------|--------|----------|
| 21 | –†–∞–∑–Ω—ã–µ API –∫–ª—é—á–∏ | ‚ö†Ô∏è WARNING | –í—Å–µ 10 —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª—é—á–µ–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |
| 22 | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ PASSED | **41 ERROR, 41 WARNING, 17 DEBUG –∑–∞–ø–∏—Å–µ–π** |

---

## üêõ –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ textStream
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `sendStreamRequest` –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–ª `HttpException` –∏ –Ω–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–ª –µ–≥–æ –≤ `OpenAiApiException`.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω try-catch –±–ª–æ–∫:
```php
try {
    $this->http->requestStream('POST', $endpoint, ...);
} catch (\App\Component\Exception\HttpException $exception) {
    $statusCode = $exception->getCode();
    $this->logError('–û—à–∏–±–∫–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ OpenAI', [
        'status_code' => $statusCode,
        'endpoint' => $endpoint,
        'message' => $exception->getMessage()
    ]);
    throw new OpenAiApiException('–°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –∫–æ–¥ –æ—à–∏–±–∫–∏ –≤ –ø–æ—Ç–æ–∫–æ–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ', $statusCode, '');
}
```

### 2. ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞:** –í –∫–ª–∞—Å—Å–µ –Ω–µ –±—ã–ª–æ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
- `logInfo()` - –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- `logDebug()` - –¥–ª—è –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- `logError()` - —É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª

### 3. ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–æ–≤ –≤ –º–µ—Ç–æ–¥–∞—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ –Ω–µ –ª–æ–≥–∏—Ä–æ–≤–∞–ª–∏ —Å–≤–æ–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ –≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
- **DEBUG** –ª–æ–≥–∏ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞ (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –º–æ–¥–µ–ª—å, –¥–ª–∏–Ω–∞ –ø—Ä–æ–º–ø—Ç–∞)
- **INFO** –ª–æ–≥–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã)
- **ERROR** –ª–æ–≥–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (—É–∂–µ –±—ã–ª–∏)

–ü—Ä–∏–º–µ—Ä:
```php
$this->logDebug('–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ text2text', [
    'model' => $model,
    'prompt_length' => strlen($prompt),
    'options' => array_keys($options)
]);

// ... –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ ...

$this->logInfo('–£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å text2text', [
    'model' => $model,
    'prompt_length' => strlen($prompt),
    'response_length' => strlen($result),
    'tokens_used' => $response['usage'] ?? null
]);
```

### 4. ‚úÖ –õ–∏—à–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –≤ validateConfiguration
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ –ø—ã—Ç–∞–ª—Å—è –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é.

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞ `$config['api_key'] = trim($config['api_key']);`

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–§–∞–π–ª –ª–æ–≥–∞:** `/logs/app.log`  
**–†–∞–∑–º–µ—Ä:** 25,505 –±–∞–π—Ç

### –¢–∏–ø—ã –∑–∞–ø–∏—Å–µ–π:
- **ERROR –∑–∞–ø–∏—Å–µ–π:** 41 (–°–µ—Ä–≤–µ—Ä OpenAI –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É)
- **WARNING –∑–∞–ø–∏—Å–µ–π:** 41 (HTTP –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω —Å –∫–æ–¥–æ–º 404)
- **DEBUG –∑–∞–ø–∏—Å–µ–π:** 17 (–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤)

### –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤:

```
2025-10-31T08:20:21+00:00 DEBUG –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ text2text {
    "model":"gpt-4o-mini",
    "prompt_length":35,
    "options":["temperature","max_tokens","system"]
}

2025-10-31T08:20:21+00:00 WARNING HTTP –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω [POST /chat/completions] 
–∫–æ–¥ 404 {"method":"POST","uri":"/chat/completions","status_code":404,"duration":0.215}

2025-10-31T08:20:21+00:00 ERROR –°–µ—Ä–≤–µ—Ä OpenAI –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É {
    "status_code":404,
    "endpoint":"/chat/completions",
    "response":"<html>...</html>"
}
```

---

## ‚ú® –ü–æ–∫—Ä—ã—Ç–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

1. ‚úÖ **text2text** - –¢–µ–∫—Å—Ç–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ GPT –º–æ–¥–µ–ª–∏
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
   
2. ‚úÖ **text2image** - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ DALL-E
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ –∫–∞—á–µ—Å—Ç–≤–∞
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

3. ‚úÖ **image2text** - –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ GPT-4 Vision
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —É—Ä–æ–≤–Ω–µ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ (low, high, auto)
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

4. ‚úÖ **audio2text** - –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ GPT-4o Audio
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

5. ‚úÖ **textStream** - –ü–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ç–µ–∫—Å—Ç–∞
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

6. ‚úÖ **embeddings** - –°–æ–∑–¥–∞–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (—Å—Ç—Ä–æ–∫–∞ –∏ –º–∞—Å—Å–∏–≤)
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

7. ‚úÖ **moderation** - –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üîê –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–í—Å–µ –º–µ—Ç–æ–¥—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è:

1. **OpenAiValidationException** - –¥–ª—è –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **OpenAiApiException** - –¥–ª—è HTTP –æ—à–∏–±–æ–∫ –æ—Ç API (—Å –∫–æ–¥–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è)
3. **OpenAiException** - –¥–ª—è –ø—Ä–æ—á–∏—Ö –æ—à–∏–±–æ–∫ –∫–ª–∞—Å—Å–∞

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ—à–∏–±–æ–∫:
- ‚úÖ –ü—É—Å—Ç—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (prompt, model, URL)
- ‚úÖ –ü—É—Å—Ç–æ–π API –∫–ª—é—á
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π API –∫–ª—é—á
- ‚úÖ –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –¥–ª—è embeddings
- ‚úÖ HTTP –æ—à–∏–±–∫–∏ (401, 404) –≤ –æ–±—ã—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- ‚úÖ HTTP –æ—à–∏–±–∫–∏ –≤ streaming –∑–∞–ø—Ä–æ—Å–∞—Ö (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ:
1. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
2. ‚úÖ –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è (PHP 8.1+)
3. ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
4. ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –æ—à–∏–±–æ–∫
5. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
6. ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ OpenAI API

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):
1. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏ (–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è Whisper API)
2. –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è embeddings
3. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API (–ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å OpenRouterMetrics)
4. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ñ—É–Ω–∫—Ü–∏–π (Function Calling)

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ö–ª–∞—Å—Å `OpenAi` –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production:

- ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º PHP 8.1+
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è
- ‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

**–¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ API —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –æ–∂–∏–¥–∞–ª–æ—Å—å** - –æ–Ω–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 404 –æ—à–∏–±–∫—É –≤–º–µ—Å—Ç–æ 401, —á—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª—é—á–µ–π. –í—Å–µ –æ—à–∏–±–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è.

---

## üìÇ –§–∞–π–ª—ã

- **–ö–ª–∞—Å—Å:** `/src/OpenAi.class.php` (600 —Å—Ç—Ä–æ–∫)
- **–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:** `/test_openai_full.php` (800 —Å—Ç—Ä–æ–∫)
- **–õ–æ–≥ —Ñ–∞–π–ª:** `/logs/app.log`
- **–≠—Ç–æ—Ç –æ—Ç—á–µ—Ç:** `/OPENAI_CLASS_TEST_REPORT.md`

---

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ:** –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è  
**–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∫–æ–º–º–∏—Ç—É** ‚úÖ
