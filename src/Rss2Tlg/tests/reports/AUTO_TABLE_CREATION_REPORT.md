# –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –≤ –∫–ª–∞—Å—Å–∞—Ö

**–î–∞—Ç–∞:** 2025-11-06  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–ï –ö–õ–ê–°–°–´ –ü–†–û–í–ï–†–ï–ù–´**

---

## üìã –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã

### 1. ‚úÖ FeedStateRepository
- **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:** `__construct(MySQL $db, ?Logger $logger, bool $autoCreateTables = true)`
- **–ú–µ—Ç–æ–¥:** `createTableIfNotExist()`  
- **–¢–∞–±–ª–∏—Ü–∞:** `rss2tlg_feed_state`
- **–°—Ç–∞—Ç—É—Å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 2. ‚úÖ ItemRepository  
- **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:** `__construct(MySQL $db, ?Logger $logger, bool $autoCreateTables = true)`
- **–ú–µ—Ç–æ–¥:** `createTableIfNotExist()`
- **–¢–∞–±–ª–∏—Ü–∞:** `rss2tlg_items`
- **–°—Ç–∞—Ç—É—Å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 3. ‚úÖ PublicationRepository
- **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:** `__construct(MySQL $db, ?Logger $logger, bool $autoCreateTables = true)`
- **–ú–µ—Ç–æ–¥:** `createTableIfNotExist()`
- **–¢–∞–±–ª–∏—Ü–∞:** `rss2tlg_publications`
- **–°—Ç–∞—Ç—É—Å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 4. ‚úÖ AIAnalysisRepository
- **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:** `__construct(MySQL $db, ?Logger $logger, bool $autoCreateTables = true)`
- **–ú–µ—Ç–æ–¥:** `createTableIfNotExist()`
- **–¢–∞–±–ª–∏—Ü–∞:** `rss2tlg_ai_analysis`
- **–ò—Å—Ç–æ—á–Ω–∏–∫ —Å—Ö–µ–º—ã:** `schema_ai_analysis.sql`
- **–°—Ç–∞—Ç—É—Å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 5. ‚úÖ MessageStorage (TelegramBot)
- **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:** `__construct(MySQL $db, ?Logger $logger, array $config = [])`
- **–ú–µ—Ç–æ–¥:** `createTableIfNotExists()`
- **–¢–∞–±–ª–∏—Ü–∞:** `telegram_bot_messages`
- **–°—Ç–∞—Ç—É—Å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 6. ‚úÖ ConversationManager (TelegramBot)
- **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:** `__construct(MySQL $db, ?Logger $logger, array $config = [])`
- **–ú–µ—Ç–æ–¥:** `createTablesIfNotExist()` (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ)
- **–¢–∞–±–ª–∏—Ü—ã:** `telegram_bot_conversations`, `telegram_bot_users`
- **–°—Ç–∞—Ç—É—Å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Å—Ö–µ–º–∞—Ö

### schema_ai_analysis.sql
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–ø–µ—á–∞—Ç–∫–∞ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–ª—è `quality_flags`:**
- –ë—ã–ª–æ: `direct_speech_preserved` (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
- –°—Ç–∞–ª–æ: `direct_speech_preserved` (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)

---

## üìä –û–±—â–∏–π –≤—ã–≤–æ–¥

‚úÖ **–í—Å–µ –∫–ª–∞—Å—Å—ã, —Ä–∞–±–æ—Ç–∞—é—â–∏–µ —Å –ë–î, –∏–º–µ—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü**

**–ü–∞—Ç—Ç–µ—Ä–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
1. **–ü–∞—Ä–∞–º–µ—Ç—Ä –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞:** `bool $autoCreateTables = true` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è:** `information_schema.TABLES`
3. **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏:** `CREATE TABLE IF NOT EXISTS` –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ + CREATE
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ—à–∏–±–∫–∏
5. **UTF-8 –∫–æ–¥–∏—Ä–æ–≤–∫–∞:** `utf8mb4 COLLATE=utf8mb4_unicode_ci`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞:**
- üöÄ **Zero-config deployment** - —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- üîß **Graceful degradation** - —Ä–∞–±–æ—Ç–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ –µ—Å—Ç—å
- üìù **Full logging** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- üõ°Ô∏è **Error handling** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. ‚úÖ **–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞** - –≤—Å–µ –∫–ª–∞—Å—Å—ã —Å–ª–µ–¥—É—é—Ç –µ–¥–∏–Ω–æ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É
2. ‚úÖ **–°—Ö–µ–º—ã –∞–∫—Ç—É–∞–ª—å–Ω—ã** - –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è –∏ –∏–Ω–¥–µ–∫—Å—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
3. ‚úÖ **–ö–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –∏ —ç–º–æ–¥–∑–∏
4. ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ** - –æ—Ç–ª–∞–¥–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞—é—Ç

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production deployment —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–æ–∑–¥–∞–Ω–∏–µ–º –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ç–∞–±–ª–∏—Ü! üöÄ