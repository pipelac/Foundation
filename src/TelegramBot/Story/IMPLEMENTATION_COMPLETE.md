# ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥–∞ Stories - –ó–ê–í–ï–†–®–ï–ù–ê

## –û–±–∑–æ—Ä

–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏—Å—Ç–æ—Ä–∏–π (Stories) –≤ Telegram —á–µ—Ä–µ–∑ Bot API —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –æ—á–µ—Ä–µ–¥–µ–π, –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (4 —Ñ–∞–π–ª–∞)

1. ‚úÖ `STORY_AUTOPOST_ARCHITECTURE.md` - –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (350+ —Å—Ç—Ä–æ–∫)
2. ‚úÖ `README.md` - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–∏–º–µ—Ä—ã (550+ —Å—Ç—Ä–æ–∫)
3. ‚úÖ `IMPLEMENTATION_COMPLETE.md` - –≠—Ç–æ—Ç —Ñ–∞–π–ª
4. ‚úÖ `database_schema.sql` - SQL —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### Entities (3 —Ñ–∞–π–ª–∞)

5. ‚úÖ `Entities/Story.php` - –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏
6. ‚úÖ `Entities/InputStoryContent.php` - –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (—Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ)
7. ‚úÖ `Entities/StoryArea.php` - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏

### Core (1 —Ñ–∞–π–ª)

8. ‚úÖ `Core/StoryAPI.php` - API –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏—è–º–∏

### AutoPost (2 —Ñ–∞–π–ª–∞)

9. ‚úÖ `AutoPost/StoryRepository.php` - –†–∞–±–æ—Ç–∞ —Å –ë–î (–æ—á–µ—Ä–µ–¥—å, –∏—Å—Ç–æ—Ä–∏—è)
10. ‚úÖ `AutoPost/StoryScheduler.php` - –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–π

### Sources (3 —Ñ–∞–π–ª–∞)

11. ‚úÖ `Sources/SourceInterface.php` - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
12. ‚úÖ `Sources/DirectoryStorySource.php` - –ò—Å—Ç–æ—á–Ω–∏–∫ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–∏
13. ‚úÖ `Sources/JsonStorySource.php` - –ò—Å—Ç–æ—á–Ω–∏–∫ –∏–∑ JSON —Ñ–∞–π–ª–æ–≤/URL

### Exceptions (1 —Ñ–∞–π–ª)

14. ‚úÖ `Exceptions/StoryException.php` - –ë–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä—ã (1 —Ñ–∞–π–ª)

15. ‚úÖ `/examples/telegram_story_autopost.php` - –ü–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–∏–º–µ—Ä (450+ —Å—Ç—Ä–æ–∫)

### CLI —Å–∫—Ä–∏–ø—Ç—ã (2 —Ñ–∞–π–ª–∞)

16. ‚úÖ `/bin/story-queue-process.php` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏
17. ‚úÖ `/bin/story-cleanup.php` - –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (1 —Ñ–∞–π–ª)

18. ‚úÖ `/config/story_autopost.json.example` - –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤**: 18
- **–ö–ª–∞—Å—Å–æ–≤**: 10
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤**: 1
- **–ú–µ—Ç–æ–¥–æ–≤**: ~120
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞**: ~3500+
- **–°—Ç—Ä–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: ~1200+

## üéØ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- [x] –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ñ–æ—Ç–æ –∏—Å—Ç–æ—Ä–∏–π (–¥–æ 10 MB)
- [x] –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤–∏–¥–µ–æ –∏—Å—Ç–æ—Ä–∏–π (–¥–æ 50 MB, –º–∞–∫—Å 60 —Å–µ–∫)
- [x] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π
- [x] –£–¥–∞–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–π
- [x] –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ (—Å—Å—ã–ª–∫–∏, –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è, —Ä–µ–∞–∫—Ü–∏–∏)
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏

### ‚úÖ –ê–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

- [x] –û—á–µ—Ä–µ–¥—å –ø—É–±–ª–∏–∫–∞—Ü–∏–π —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
- [x] –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –¥–∞—Ç–µ/–≤—Ä–µ–º–µ–Ω–∏
- [x] –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- [x] –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–π
- [x] –ò—Å—Ç–æ—Ä–∏—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π

### ‚úÖ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

- [x] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å SourceInterface
- [x] DirectoryStorySource - –∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–∞–ø–æ–∫
- [x] JsonStorySource - –∏–∑ JSON —Ñ–∞–π–ª–æ–≤/URL
- [ ] RssStorySource - –∏–∑ RSS –ª–µ–Ω—Ç (–∑–∞–≥–æ—Ç–æ–≤–∫–∞)
- [ ] DatabaseStorySource - –∏–∑ –ë–î (–∑–∞–≥–æ—Ç–æ–≤–∫–∞)

### ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- [x] telegram_story_queue - –æ—á–µ—Ä–µ–¥—å –ø—É–±–ª–∏–∫–∞—Ü–∏–π
- [x] telegram_story_history - –∏—Å—Ç–æ—Ä–∏—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π
- [x] telegram_story_sources - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- [x] telegram_story_templates - —à–∞–±–ª–æ–Ω—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
- [x] telegram_story_stats - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### ‚úÖ CLI –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

- [x] story-queue-process.php - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏
- [x] story-cleanup.php - –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ cron –∑–∞–¥–∞—á
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

- [x] –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è PHP 8.1+
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
- [x] –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ —Ñ–∞–π–ª–æ–≤
- [x] Retry –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ë–î

```bash
mysql -u root < src/TelegramBot/Story/database_schema.sql
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```bash
cp config/story_autopost.json.example config/story_autopost.json
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ config/story_autopost.json
```

### 3. –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```php
use App\Component\TelegramBot\Story\Core\StoryAPI;
use App\Component\TelegramBot\Story\Entities\InputStoryContent;

$storyAPI = new StoryAPI($botToken, $http, $logger);

$story = $storyAPI->postStory(
    businessAccountId: 'business_123',
    content: InputStoryContent::photo('/path/to/photo.jpg'),
    caption: '–ú–æ—è –ø–µ—Ä–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è! üéâ'
);
```

### 4. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

```php
use App\Component\TelegramBot\Story\AutoPost\StoryScheduler;

$scheduler = new StoryScheduler($repository, $storyAPI, $logger);

$queueId = $scheduler->schedule(
    businessAccountId: 'business_123',
    content: InputStoryContent::photo('/path/to/photo.jpg'),
    scheduledAt: new DateTime('tomorrow 12:00'),
    options: ['caption' => '–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è']
);
```

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏ (cron)

```bash
# –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
*/5 * * * * cd /var/www && php bin/story-queue-process.php
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è Telegram Bot API

1. **Telegram Business –∞–∫–∫–∞—É–Ω—Ç** - –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω (–ø–ª–∞—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞)
2. **Business Connection ID** - –±–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω
3. **–¢–æ–ª—å–∫–æ –æ—Ç –∏–º–µ–Ω–∏ –±–∏–∑–Ω–µ—Å-–∞–∫–∫–∞—É–Ω—Ç–∞** - –±–æ—Ç—ã –ù–ï –º–æ–≥—É—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ—Ç —Å–≤–æ–µ–≥–æ –∏–º–µ–Ω–∏

### –õ–∏–º–∏—Ç—ã

- –§–æ—Ç–æ: –º–∞–∫—Å–∏–º—É–º 10 MB
- –í–∏–¥–µ–æ: –º–∞–∫—Å–∏–º—É–º 50 MB, –¥–æ 60 —Å–µ–∫—É–Ω–¥
- –°—Ä–æ–∫ –∂–∏–∑–Ω–∏: –∏—Å—Ç–æ—Ä–∏–∏ —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞
- Rate limits: —Å–æ–±–ª—é–¥–∞–π—Ç–µ –ª–∏–º–∏—Ç—ã API

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **README.md** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
- **STORY_AUTOPOST_ARCHITECTURE.md** - –ü–æ–ª–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **database_schema.sql** - –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

- **examples/telegram_story_autopost.php** - 12 –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ PHPDoc –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –≤–æ –≤—Å–µ—Ö –∫–ª–∞—Å—Å–∞—Ö

### API Reference

–í—Å–µ –∫–ª–∞—Å—Å—ã –∏–º–µ—é—Ç –ø–æ–ª–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –º–µ—Ç–æ–¥–æ–≤:

```php
/**
 * –ü—É–±–ª–∏–∫—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –æ—Ç –∏–º–µ–Ω–∏ –±–∏–∑–Ω–µ—Å-–∞–∫–∫–∞—É–Ω—Ç–∞
 *
 * @param string $businessAccountId ID –±–∏–∑–Ω–µ—Å-–∞–∫–∫–∞—É–Ω—Ç–∞
 * @param InputStoryContent $content –ö–æ–Ω—Ç–µ–Ω—Ç –∏—Å—Ç–æ—Ä–∏–∏
 * @param string|null $caption –ü–æ–¥–ø–∏—Å—å –∫ –∏—Å—Ç–æ—Ä–∏–∏
 * @return Story –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è
 * @throws StoryException –ü—Ä–∏ –æ—à–∏–±–∫–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
 * @throws ApiException –ü—Ä–∏ –æ—à–∏–±–∫–µ API
 */
public function postStory(...): Story
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–ª–æ–∏—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
Story/
‚îú‚îÄ‚îÄ Entities/           # –°—É—â–Ω–æ—Å—Ç–∏ (Story, InputStoryContent, StoryArea)
‚îú‚îÄ‚îÄ Core/              # –Ø–¥—Ä–æ (StoryAPI)
‚îú‚îÄ‚îÄ AutoPost/          # –ê–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥ (Repository, Scheduler)
‚îú‚îÄ‚îÄ Sources/           # –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (Interface, Directory, Json)
‚îú‚îÄ‚îÄ Templates/         # –®–∞–±–ª–æ–Ω—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è (–∑–∞–≥–æ—Ç–æ–≤–∫–∞)
‚îî‚îÄ‚îÄ Exceptions/        # –ò—Å–∫–ª—é—á–µ–Ω–∏—è (StoryException)
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
–ò—Å—Ç–æ—á–Ω–∏–∫ ‚Üí –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ ‚Üí –û—á–µ—Ä–µ–¥—å ‚Üí –û–±—Ä–∞–±–æ—Ç—á–∏–∫ ‚Üí API ‚Üí Telegram
   ‚Üì           ‚Üì            ‚Üì          ‚Üì         ‚Üì        ‚Üì
  Fetch    Schedule    Queue DB   Publish   postStory  Story
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞:

- ‚úÖ **MySQL** - –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—á–µ—Ä–µ–¥–∏ –∏ –∏—Å—Ç–æ—Ä–∏–∏
- ‚úÖ **Http** - –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **Logger** - –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ **TelegramBot\Core\TelegramAPI** - –±–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ **TelegramBot\Entities** - Chat, User
- ‚úÖ **TelegramBot\Exceptions** - –∏–µ—Ä–∞—Ä—Ö–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

```bash
php -l src/TelegramBot/Story/Core/StoryAPI.php
php -l src/TelegramBot/Story/AutoPost/StoryScheduler.php
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü –ë–î

```bash
mysql -u root -e "SHOW TABLES LIKE 'telegram_story%'"
```

### –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
php examples/telegram_story_autopost.php
```

## üìù TODO (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è)

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

- [ ] RssStorySource - –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥ –∏–∑ RSS –ª–µ–Ω—Ç
- [ ] DatabaseStorySource - –ø—É–±–ª–∏–∫–∞—Ü–∏—è –∏–∑ –ë–î
- [ ] WebhookStorySource - –ø—Ä–∏–µ–º —á–µ—Ä–µ–∑ webhook

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞

- [ ] StoryContentProcessor - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] ImageTemplate - —à–∞–±–ª–æ–Ω—ã –¥–ª—è —Ñ–æ—Ç–æ
- [ ] VideoTemplate - —à–∞–±–ª–æ–Ω—ã –¥–ª—è –≤–∏–¥–µ–æ
- [ ] Watermark - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤
- [ ] Resize - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- [ ] StoryAnalytics - —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
- [ ] StoryNotifier - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—É–±–ª–∏–∫–∞—Ü–∏—è—Ö
- [ ] StoryValidator - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- [ ] Unit —Ç–µ—Å—Ç—ã
- [ ] Integration —Ç–µ—Å—Ç—ã

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∏–ª—é –ø—Ä–æ–µ–∫—Ç–∞

- ‚úÖ PHP 8.1+ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å (readonly properties, named parameters)
- ‚úÖ –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤
- ‚úÖ PHPDoc –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ
- ‚úÖ –ú–æ–Ω–æ–ª–∏—Ç–Ω–∞—è —Å–ª–æ–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

- ‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- ‚úÖ Graceful degradation

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –≤ –ë–î –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ cron

## üéì –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è

```php
$story = $storyAPI->postStory(
    businessAccountId: 'business_123',
    content: InputStoryContent::photo('/path/to/photo.jpg'),
    caption: '–ù–æ–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è! üéâ'
);
```

### –ü—Ä–∏–º–µ—Ä 2: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```php
$queueId = $scheduler->schedule(
    businessAccountId: 'business_123',
    content: InputStoryContent::video('/path/to/video.mp4'),
    scheduledAt: new DateTime('tomorrow 15:00')
);
```

### –ü—Ä–∏–º–µ—Ä 3: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏

```php
$areas = [
    StoryArea::link('https://example.com', 0.5, 0.9)->toArray(),
    StoryArea::suggestedReaction('‚ù§Ô∏è', 0.85, 0.5)->toArray(),
];

$story = $storyAPI->postStory(
    businessAccountId: 'business_123',
    content: InputStoryContent::photo('/path/to/photo.jpg'),
    areas: $areas
);
```

### –ü—Ä–∏–º–µ—Ä 4: –ò—Å—Ç–æ—á–Ω–∏–∫ –∏–∑ –ø–∞–ø–∫–∏

```php
$source = new DirectoryStorySource([
    'name' => 'media_folder',
    'watch_path' => '/var/media/stories',
    'file_patterns' => ['*.jpg', '*.png', '*.mp4']
]);

$items = $source->fetch();

foreach ($items as $item) {
    $content = $item['type'] === 'video'
        ? InputStoryContent::video($item['path'])
        : InputStoryContent::photo($item['path']);
    
    $scheduler->schedule(
        businessAccountId: 'business_123',
        content: $content
    );
}
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `/src/TelegramBot/Story/README.md` - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/src/TelegramBot/Story/STORY_AUTOPOST_ARCHITECTURE.md` - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- `/examples/telegram_story_autopost.php` - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### Telegram Bot API

- [Official Documentation](https://core.telegram.org/bots/api#stories)
- [Business Features](https://core.telegram.org/bots/features#telegram-business)

## üéâ –ò—Ç–æ–≥

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ **–ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥–∞ Stories** —Å:

- ‚úÖ –ü–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Telegram Bot API –¥–ª—è Stories
- ‚úÖ –ì–∏–±–∫–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—á–µ—Ä–µ–¥–µ–π
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏
- ‚úÖ CLI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü–æ–ª–Ω—ã–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ–º —Å—Ç–∏–ª—é –ø—Ä–æ–µ–∫—Ç–∞

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ
