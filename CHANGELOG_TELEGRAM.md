# Changelog - Telegram Class Refactoring

## [2.0.0] - Production-Ready Release

### üéØ –¶–µ–ª—å
–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–ª–∞—Å—Å–∞ `Telegram.class.php` –¥–æ production —É—Ä–æ–≤–Ω—è —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π PHP 8.1+, —Å—Ç—Ä–æ–≥–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.

### ‚ú® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

#### 1. –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- `TelegramException` - –±–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ Telegram
- `TelegramConfigException` - –æ—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—Ç–æ–∫–µ–Ω, chat_id)
- `TelegramApiException` - –æ—à–∏–±–∫–∏ API —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π (HTTP –∫–æ–¥, –æ–ø–∏—Å–∞–Ω–∏–µ, error_code)
- `TelegramFileException` - –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ñ–∞–π–ª–∞–º–∏

#### 2. –ú–µ—Ç–æ–¥ `getMe()`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ API
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–æ—Ç–µ
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

#### 3. –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–µ–∂–∏–º–æ–≤ —Ä–∞–∑–º–µ—Ç–∫–∏
```php
Telegram::PARSE_MODE_HTML
Telegram::PARSE_MODE_MARKDOWN
Telegram::PARSE_MODE_MARKDOWN_V2
```

### üîß –£–ª—É—á—à–µ–Ω–∏—è

#### –í–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ regex: `^\d+:[A-Za-z0-9_-]{35}$`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞ (–º–∞–∫—Å. 4096 —Å–∏–º–≤–æ–ª–æ–≤)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–µ–π –∫ –º–µ–¥–∏–∞ (–º–∞–∫—Å. 1024 —Å–∏–º–≤–æ–ª–∞)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ (–º–∞–∫—Å. 50 –ú–ë)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã
- ‚úÖ UTF-8 –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç —Å–∏–º–≤–æ–ª–æ–≤

#### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `readonly` —Å–≤–æ–π—Å—Ç–≤ –¥–ª—è –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è (PHP 8.1+)
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ API –≤ –º–µ—Ç–æ–¥–µ `processResponse()`
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ decoded JSON response
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç resource —Ç–∏–ø–∞ –≤ multipart –∑–∞–ø—Ä–æ—Å–∞—Ö
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–∞–π–º–∞—É—Ç —É–≤–µ–ª–∏—á–µ–Ω —Å 1 –¥–æ 5 —Å–µ–∫—É–Ω–¥

#### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –†–∞–Ω–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ URL vs —Ñ–∞–π–ª —á–µ—Ä–µ–∑ `filter_var()`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `fopen()` —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≤–º–µ—Å—Ç–æ Utils::tryFopen()
- ‚úÖ –ò–∑–±–µ–∂–∞–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ multipart –¥–∞–Ω–Ω—ã—Ö

#### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ PHPDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ `$options`
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –£–∫–∞–∑–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –ª–∏–º–∏—Ç–æ–≤
- ‚úÖ –°—Å—ã–ª–∫–∞ –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö —á–µ—Ä–µ–∑ `match`
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∞–ª—ã–π —Ç–∞–π–º–∞—É—Ç)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö HTTP –∫–æ–¥–æ–≤ (401, 403, 429, 500-504)
- ‚úÖ –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –ª–æ–≥–∏—Ä—É–µ–º–æ–≥–æ body –¥–æ 500 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ Readonly —Å–≤–æ–π—Å—Ç–≤–∞ –∑–∞—â–∏—â–∞—é—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–¥–∞—á–∏ resource —Ç–∏–ø–æ–≤

### üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ API

#### Breaking Changes
- `Exception` –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `TelegramConfigException` –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `RuntimeException` –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `TelegramApiException` –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API
- –î–æ–±–∞–≤–ª–µ–Ω–æ `TelegramFileException` –¥–ª—è –æ—à–∏–±–æ–∫ —Ñ–∞–π–ª–æ–≤
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–∞–π–º–∞—É—Ç —É–≤–µ–ª–∏—á–µ–Ω —Å 1 –¥–æ 5 —Å–µ–∫—É–Ω–¥

#### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã
- `getMe(): array` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–æ—Ç–µ

#### –ù–æ–≤—ã–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- `validateAndInitializeConfig()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `isValidToken()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Ç–æ–∫–µ–Ω–∞
- `validateText()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- `validateCaption()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–µ–π
- `isUrl()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ URL
- `processResponse()` - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
- `handleApiError()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –æ—à–∏–±–æ–∫
- `isAssociativeArray()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –º–∞—Å—Å–∏–≤–∞
- `logWarning()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

### üì¶ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

```
src/Exception/
‚îú‚îÄ‚îÄ TelegramException.php
‚îú‚îÄ‚îÄ TelegramConfigException.php
‚îú‚îÄ‚îÄ TelegramApiException.php
‚îî‚îÄ‚îÄ TelegramFileException.php

examples/
‚îî‚îÄ‚îÄ telegram_example.php

docs/
‚îî‚îÄ‚îÄ TELEGRAM_IMPROVEMENTS.md
```

### üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

#### –°—Ç–∞—Ä—ã–π –∫–æ–¥
```php
try {
    $telegram = new Telegram(['token' => $token]);
    $telegram->sendText(null, $message);
} catch (RuntimeException $e) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
}
```

#### –ù–æ–≤—ã–π –∫–æ–¥
```php
try {
    $telegram = new Telegram(['token' => $token]);
    $botInfo = $telegram->getMe(); // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
    $telegram->sendText(null, $message, [
        'parse_mode' => Telegram::PARSE_MODE_HTML,
    ]);
} catch (TelegramConfigException $e) {
    // –û—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
} catch (TelegramFileException $e) {
    // –û—à–∏–±–∫–∏ —Ñ–∞–π–ª–æ–≤
} catch (TelegramApiException $e) {
    // –û—à–∏–±–∫–∏ API
    if ($e->getStatusCode() === 429) {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ rate limit
    }
}
```

### üìä –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π

- **–°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è**: 100% (–≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏ –º–µ—Ç–æ–¥—ã)
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: 100%
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π**: 100%
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è PHPDoc**: 100%
- **Readonly —Å–≤–æ–π—Å—Ç–≤–∞**: 100% (–≤—Å–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞)
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: +30% (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: +50% (–≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏)

### üéì –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–ª–µ–¥—É—é—Ç –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º:
- ‚úÖ SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã
- ‚úÖ Clean Code
- ‚úÖ PSR-12 Code Style
- ‚úÖ PHP 8.1+ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ Type Safety
- ‚úÖ Error Handling
- ‚úÖ Documentation

### üöÄ Production Ready

–ö–ª–∞—Å—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production —Å—Ä–µ–¥–µ:
- ‚úÖ –ù–∞–¥–µ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å**: `src/Telegram.class.php`
- **–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ**: `docs/TELEGRAM_IMPROVEMENTS.md`
- **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: `examples/telegram_example.php`
- **Changelog**: `CHANGELOG_TELEGRAM.md`

### üîó –°—Å—ã–ª–∫–∏

- [Telegram Bot API Documentation](https://core.telegram.org/bots/api)
- [PHP 8.1 Release Notes](https://www.php.net/releases/8.1/en.php)
- [PSR-12 Code Style](https://www.php-fig.org/psr/psr-12/)

---

**–í–µ—Ä—Å–∏—è**: 2.0.0  
**–î–∞—Ç–∞**: 2024  
**–ê–≤—Ç–æ—Ä**: AI Expert PHP Developer  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ Production Ready
