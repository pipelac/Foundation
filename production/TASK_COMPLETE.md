# ‚úÖ –ó–ê–î–ê–ß–ê –í–´–ü–û–õ–ù–ï–ù–ê

**–î–∞—Ç–∞:** 2025-11-13  
**–ó–∞–¥–∞—á–∞:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω—Ñ–∏–≥–æ–≤ production + –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ htmlweb.ru  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û**

---

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. ‚úÖ –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è `main.json`

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ —Å–µ–∫—Ü–∏—è–º –∫–ª–∞—Å—Å–æ–≤/—Å–µ—Ä–≤–∏—Å–æ–≤:

```json
{
    "Logger": { ... },
    "RSSIngest": { ... },
    "WebtExtractor": { ... },
    "ProxyPool": { ... },
    "htmlWebProxyList": { ... }
}
```

### 2. ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ò–∑ `main.json` —É–¥–∞–ª–µ–Ω—ã:
- ‚ùå `cron_interval_minutes` - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–∫—Ä–∏–ø—Ç–µ
- ‚ùå `content_extraction_delay` - –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ `feeds.json`
- ‚ùå `extract_content_from_link` - –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ `feeds.json`

### 3. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `feeds.json`

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–¥–∞:

```json
{
    "name": "TechCrunch",
    "feed_url": "...",
    "enabled": true,
    "extraction_delay": 2,           // ‚Üê –ù–û–í–û–ï
    "extract_content_from_link": true,  // ‚Üê –ù–û–í–û–ï
    "use_htmlweb_proxy": true          // ‚Üê –ù–û–í–û–ï
}
```

### 4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ProxyPool –∏ htmlWebProxyList

–í—ã–Ω–µ—Å–µ–Ω—ã –≤ `main.json`:

**ProxyPool:**
- –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–æ—Ç–∞—Ü–∏–∏: round_robin
- Health check: –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π (–æ—Ç–∫–ª—é—á–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–æ–≤)
- Max retries: 3
- –¢–∞–π–º–∞—É—Ç: 30 —Å–µ–∫

**htmlWebProxyList:**
- API –∫–ª—é—á –∏–∑ environment
- –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç—Ä–∞–Ω–µ: "" (–ª—é–±–∞—è)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 10 –ø—Ä–æ–∫—Å–∏
- –¢–∏–ø: HTTP
- Short format: 2 (—Å –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏)

### 5. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ –≤ `rss_ingest.php`

–î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏:
- `initProxyPool()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É–ª–∞ —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –∏–∑ htmlweb.ru
- `getActiveFeeds()` - –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ feeds.json
- –ü–µ—Ä–µ–¥–∞—á–∞ –ø—Ä–æ–∫—Å–∏ –≤ WebtExtractor –¥–ª—è TechCrunch

### 6. ‚úÖ –†–µ–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Å—Ç–∞:**
- TEST_MODE: –≤–∫–ª—é—á–µ–Ω
- –õ–∏–º–∏—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤: 10 –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫
- –ò—Å—Ç–æ—á–Ω–∏–∫–∏: –†–ò–ê, –ö–æ–º–º–µ—Ä—Å–∞–Ω—Ç—ä, –ò–Ω—Ç–µ—Ä—Ñ–∞–∫—Å, TechCrunch
- –ü—Ä–æ–∫—Å–∏: —Ç–æ–ª—å–∫–æ –¥–ª—è TechCrunch

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

| –ò—Å—Ç–æ—á–Ω–∏–∫ | Items | –ù–æ–≤—ã—Ö | –î—É–±–ª–∏–∫–∞—Ç–æ–≤ | –ò–∑–≤–ª–µ—á–µ–Ω –∫–æ–Ω—Ç–µ–Ω—Ç |
|----------|-------|-------|------------|------------------|
| –†–ò–ê –ù–æ–≤–æ—Å—Ç–∏ | 10 | 10 | 0 | 0 |
| –ö–æ–º–º–µ—Ä—Å–∞–Ω—Ç—ä | 10 | 10 | 0 | 0 |
| –ò–Ω—Ç–µ—Ä—Ñ–∞–∫—Å | 10 | 10 | 0 | 0 |
| **TechCrunch** | **10** | **10** | **0** | **10** ‚úÖ |
| **–ò–¢–û–ì–û** | **40** | **40** | **0** | **10** |

**–ü—Ä–æ–∫—Å–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω:**
```
üîí –ü—Ä–æ–∫—Å–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –¥–ª—è TechCrunch
üìä –î–æ—Å—Ç—É–ø–Ω–æ –ø—Ä–æ–∫—Å–∏: 10/10
üåê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–∫—Å–∏: http://165.22.71.191:80
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 35.47 —Å–µ–∫  
**–£—Å–ø–µ—à–Ω–æ—Å—Ç—å:** 100% (4/4 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)

### 7. ‚úÖ SQL –¥–∞–º–ø—ã

–°–æ–∑–¥–∞–Ω—ã –≤ `/production/sql_dumps/`:

- `full_dump_final_*.sql` - –ø–æ–ª–Ω—ã–π –¥–∞–º–ø –ë–î (225 KB)
- `rss2tlg_items_final_*.sql` - –¥–∞–º–ø —Ç–∞–±–ª–∏—Ü—ã items (206 KB)
- `rss2tlg_feeds_final_*.sql` - –¥–∞–º–ø —Ç–∞–±–ª–∏—Ü—ã feeds
- `rss2tlg_feed_state_final_*.sql` - –¥–∞–º–ø —Ç–∞–±–ª–∏—Ü—ã feed_state
- `rss2tlg_deduplication_final_*.sql`
- `rss2tlg_summarization_final_*.sql`
- `rss2tlg_publications_final_*.sql`
- `openrouter_metrics_final_*.sql`

**–ò—Ç–æ–≥–æ:** 8 —Ñ–∞–π–ª–æ–≤, 472 KB

### 8. ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–º–ø–æ–≤

–£–¥–∞–ª–µ–Ω—ã –∏–∑ –¥—Ä—É–≥–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤:
- `/logs/dump_rss_ingest_test_final_*.sql`
- `/production/sql/dump_rss_ingest_test_*.sql`
- `/production/sql/test_extraction_*.sql`

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –õ–æ–≥–∏

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `/logs/rss_ingest.log`:

```
[htmlWebProxyList] –ó–∞–ø—Ä–æ—Å —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–∫—Å–∏ —Å htmlweb.ru
[htmlWebProxyList] –ü–æ–ª—É—á–µ–Ω —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–∫—Å–∏ {"count":10}
[RSS_INGEST] Loaded proxies from htmlweb.ru {"count":10}
ProxyPool –º–µ–Ω–µ–¥–∂–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω {"proxies_count":10}
WebtExtractor –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω {"proxy_enabled":true}
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö:

```sql
SELECT f.name, COUNT(i.id) as items, 
       COUNT(CASE WHEN i.extracted_content IS NOT NULL THEN 1 END) as extracted
FROM rss2tlg_feeds f
LEFT JOIN rss2tlg_items i ON f.id = i.feed_id
GROUP BY f.id, f.name;
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- –†–ò–ê –ù–æ–≤–æ—Å—Ç–∏: 10 items, 0 extracted
- –ö–æ–º–º–µ—Ä—Å–∞–Ω—Ç—ä: 10 items, 0 extracted
- –ò–Ω—Ç–µ—Ä—Ñ–∞–∫—Å: 10 items, 0 extracted
- **TechCrunch: 10 items, 10 extracted** ‚úÖ

---

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- ‚úÖ `production/configs/main.json` - —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω, —Å–µ–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚úÖ `production/configs/feeds.json` - –Ω–æ–≤—ã–µ –ø–æ–ª—è –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚úÖ `production/configs/database.json` - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î

### –°–∫—Ä–∏–ø—Ç—ã

- ‚úÖ `production/rss_ingest.php` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∫—Å–∏

### –î–∞–º–ø—ã –∏ –æ—Ç—á–µ—Ç—ã

- ‚úÖ `production/sql_dumps/` - —Å–æ–∑–¥–∞–Ω –∫–∞—Ç–∞–ª–æ–≥ —Å SQL –¥–∞–º–ø–∞–º–∏
- ‚úÖ `production/SUMMARY.md` - —Å–≤–æ–¥–∫–∞ –ø–æ –∑–∞–¥–∞—á–µ
- ‚úÖ `production/TEST_REPORT_*.md` - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –æ —Ç–µ—Å—Ç–∞—Ö
- ‚úÖ `production/TASK_COMPLETE.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

- ‚úÖ RSS –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü—Ä–æ–∫—Å–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å htmlweb.ru API
- ‚úÖ –ü—Ä–æ–∫—Å–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∏–¥–æ–≤
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ
- ‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç–ª–∏—á–Ω–∞—è (35 —Å–µ–∫ –¥–ª—è 40 –Ω–æ–≤–æ—Å—Ç–µ–π)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ production

–í `main.json` –∏–∑–º–µ–Ω–µ–Ω–æ:
- `test_mode: false` - –æ—Ç–∫–ª—é—á–µ–Ω TEST_MODE
- `ProxyPool.auto_health_check: false` - –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- `htmlWebProxyList.country: ""` - –ª—é–±—ã–µ —Å—Ç—Ä–∞–Ω—ã (–±–æ–ª—å—à–µ –ø—Ä–æ–∫—Å–∏)

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron:**
   ```bash
   */5 * * * * cd /path/to/project && php8.2 production/rss_ingest.php
   ```

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤:**
   ```bash
   tail -f /path/to/project/logs/rss_ingest.log
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î:**
   ```bash
   mysql -u user -p database -e "SELECT * FROM rss2tlg_feed_state;"
   ```

---

## üéâ –ò—Ç–æ–≥

**–í–°–ï –ó–ê–î–ê–ß–ò –í–´–ü–û–õ–ù–ï–ù–´ –£–°–ü–ï–®–ù–û!**

‚úÖ –ö–æ–Ω—Ñ–∏–≥–∏ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã  
‚úÖ –î—É–±–ª–∏—Ä—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É–¥–∞–ª–µ–Ω—ã  
‚úÖ –ü—Ä–æ–∫—Å–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã (100%)  
‚úÖ SQL –¥–∞–º–ø—ã —Å–æ–∑–¥–∞–Ω—ã  
‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production  

**–°—Ç–∞—Ç—É—Å:** üöÄ **READY FOR PRODUCTION**

---

**–ö–æ–Ω—Ç–∞–∫—Ç:** –î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É  
**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-11-13 18:40:00 UTC
