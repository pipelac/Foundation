2025-11-08T20:21:49+00:00 DEBUG Версия MySQL проверена {"version":"10.11.13-MariaDB-0ubuntu0.24.04.1","major":10,"minor":11,"patch":13}
2025-11-08T20:21:49+00:00 DEBUG Успешное подключение к БД {"host":"localhost","database":"rss2tlg","persistent":false,"charset":"utf8mb4"}
2025-11-08T20:21:49+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.413,"body_size":542,"content_type":"application/json"}
2025-11-08T20:21:49+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT VERSION() as version","found":true}
2025-11-08T20:21:49+00:00 DEBUG Выполнен SELECT запрос {"query":"SHOW TABLES","rows":10}
2025-11-08T20:21:49+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.135,"body_size":543,"content_type":"application/json"}
2025-11-08T20:21:50+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.137,"body_size":450,"content_type":"application/json"}
2025-11-08T20:21:50+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:21:50+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:21:50+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:21:50+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:21:50+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:21:50+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:21:50+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as cnt FROM rss2tlg_items","found":true}
2025-11-08T20:21:50+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.156,"body_size":359,"content_type":"application/json"}
2025-11-08T20:21:50+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.139,"body_size":432,"content_type":"application/json"}
2025-11-08T20:21:50+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":3}
2025-11-08T20:21:50+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:21:50+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:21:50+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:21:50+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":1,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:21:56+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.091,"body_size":1602,"content_type":"application/json"}
2025-11-08T20:21:56+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:21:56+00:00 INFO [Summarization] Новость успешно обработана {"item_id":1,"processing_time_ms":6104}
2025-11-08T20:21:56+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:21:56+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:21:56+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:21:56+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":2,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:22:00+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.072,"body_size":1124,"content_type":"application/json"}
2025-11-08T20:22:00+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":2,"model":"anthropic/claude-3.5-sonnet","attempt":1,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:22:06+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.612,"body_size":1317,"content_type":"application/json"}
2025-11-08T20:22:06+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":2,"model":"anthropic/claude-3.5-sonnet","attempt":2,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:22:11+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":3.741,"body_size":1158,"content_type":"application/json"}
2025-11-08T20:22:11+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":2,"model":"anthropic/claude-3.5-sonnet","attempt":3,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:22:11+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":2,"model":"deepseek/deepseek-chat"}
2025-11-08T20:22:15+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.061,"body_size":1595,"content_type":"application/json"}
2025-11-08T20:22:15+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:22:15+00:00 INFO [Summarization] Новость успешно обработана {"item_id":2,"processing_time_ms":18513}
2025-11-08T20:22:15+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:22:15+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:22:15+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:22:15+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":3,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:22:21+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.911,"body_size":1666,"content_type":"application/json"}
2025-11-08T20:22:21+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:22:21+00:00 INFO [Summarization] Новость успешно обработана {"item_id":3,"processing_time_ms":5925}
2025-11-08T20:22:21+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":3}
2025-11-08T20:22:21+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:22:21+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:22:21+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:22:21+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":4,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:22:26+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.417,"body_size":1632,"content_type":"application/json"}
2025-11-08T20:22:26+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:22:26+00:00 INFO [Summarization] Новость успешно обработана {"item_id":4,"processing_time_ms":5482}
2025-11-08T20:22:26+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:22:26+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:22:26+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:22:26+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":5,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:22:33+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.048,"body_size":1866,"content_type":"application/json"}
2025-11-08T20:22:33+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:22:33+00:00 INFO [Summarization] Новость успешно обработана {"item_id":5,"processing_time_ms":7072}
2025-11-08T20:22:33+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:22:33+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:22:33+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:22:33+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":6,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:22:38+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.097,"body_size":1553,"content_type":"application/json"}
2025-11-08T20:22:38+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:22:38+00:00 INFO [Summarization] Новость успешно обработана {"item_id":6,"processing_time_ms":5120}
2025-11-08T20:22:39+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.146,"body_size":438,"content_type":"application/json"}
2025-11-08T20:22:39+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.139,"body_size":427,"content_type":"application/json"}
2025-11-08T20:22:39+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":3}
2025-11-08T20:22:39+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:22:39+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:22:39+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:22:39+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:22:39+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":1,"count":5}
2025-11-08T20:22:39+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":1,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:22:46+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.499,"body_size":1739,"content_type":"application/json"}
2025-11-08T20:22:46+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:22:46+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":1,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":7533}
2025-11-08T20:22:46+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:22:46+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:22:46+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:22:46+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:22:46+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":2,"count":5}
2025-11-08T20:22:46+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":2,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:22:54+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.531,"body_size":1925,"content_type":"application/json"}
2025-11-08T20:22:54+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:22:54+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":2,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":7548}
2025-11-08T20:22:54+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:22:54+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:22:54+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:22:54+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:22:54+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":3,"count":5}
2025-11-08T20:22:54+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":3,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:23:01+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.605,"body_size":1744,"content_type":"application/json"}
2025-11-08T20:23:01+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:23:01+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":3,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":7630}
2025-11-08T20:23:01+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":3}
2025-11-08T20:23:01+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:23:01+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:23:01+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:23:01+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:23:01+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":4,"count":5}
2025-11-08T20:23:01+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":4,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:23:10+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":8.286,"body_size":1914,"content_type":"application/json"}
2025-11-08T20:23:10+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:23:10+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":4,"is_duplicate":false,"similarity_score":0,"processing_time_ms":8301}
2025-11-08T20:23:10+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:23:10+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:23:10+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:23:10+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:23:10+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":5,"count":5}
2025-11-08T20:23:10+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":5,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:23:17+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.195,"body_size":1685,"content_type":"application/json"}
2025-11-08T20:23:17+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:23:17+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":5,"is_duplicate":true,"similarity_score":15,"processing_time_ms":7209}
2025-11-08T20:23:17+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:23:17+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:23:17+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:23:17+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:23:17+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":6,"count":5}
2025-11-08T20:23:17+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":6,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:23:25+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":8.237,"body_size":1860,"content_type":"application/json"}
2025-11-08T20:23:25+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:23:25+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":6,"is_duplicate":true,"similarity_score":15,"processing_time_ms":8251}
2025-11-08T20:23:25+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.139,"body_size":432,"content_type":"application/json"}
2025-11-08T20:23:25+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":432,"content_type":"application/json"}
2025-11-08T20:23:25+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":0}
2025-11-08T20:23:25+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":1}
2025-11-08T20:23:26+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.155,"body_size":401,"content_type":"application/json"}
2025-11-08T20:23:42+00:00 DEBUG Версия MySQL проверена {"version":"10.11.13-MariaDB-0ubuntu0.24.04.1","major":10,"minor":11,"patch":13}
2025-11-08T20:23:42+00:00 DEBUG Успешное подключение к БД {"host":"localhost","database":"rss2tlg","persistent":false,"charset":"utf8mb4"}
2025-11-08T20:23:43+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.452,"body_size":542,"content_type":"application/json"}
2025-11-08T20:23:43+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT VERSION() as version","found":true}
2025-11-08T20:23:43+00:00 DEBUG Выполнен SELECT запрос {"query":"SHOW TABLES","rows":10}
2025-11-08T20:23:43+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.19,"body_size":543,"content_type":"application/json"}
2025-11-08T20:23:43+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.158,"body_size":450,"content_type":"application/json"}
2025-11-08T20:23:43+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:23:43+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:23:43+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:23:43+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:23:43+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:23:43+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:23:43+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as cnt FROM rss2tlg_items","found":true}
2025-11-08T20:23:43+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.157,"body_size":359,"content_type":"application/json"}
2025-11-08T20:23:43+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.14,"body_size":432,"content_type":"application/json"}
2025-11-08T20:23:43+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":0}
2025-11-08T20:23:43+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":0}
2025-11-08T20:23:44+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.139,"body_size":438,"content_type":"application/json"}
2025-11-08T20:23:44+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.139,"body_size":427,"content_type":"application/json"}
2025-11-08T20:23:44+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":0}
2025-11-08T20:23:44+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":0}
2025-11-08T20:23:44+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.138,"body_size":432,"content_type":"application/json"}
2025-11-08T20:23:44+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.146,"body_size":432,"content_type":"application/json"}
2025-11-08T20:23:44+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":0}
2025-11-08T20:23:44+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":1}
2025-11-08T20:23:44+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.173,"body_size":401,"content_type":"application/json"}
2025-11-08T20:23:44+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.185,"body_size":448,"content_type":"application/json"}
2025-11-08T20:23:44+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_illustration WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:23:44+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT i.id, i.feed_id, i.title, i.link, s.headline, s.summary, s.category_primary, s.importance_rating, s.article_language FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id ...","found":true}
2025-11-08T20:23:44+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT can_be_published FROM rss2tlg_deduplication WHERE item_id = :item_id AND status = 'checked' LIMIT 1","found":true}
2025-11-08T20:23:44+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NOW...","affected_rows":1}
2025-11-08T20:23:57+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":12.889,"body_size":2924,"content_type":"application/json"}
2025-11-08T20:23:57+00:00 DEBUG [IllustrationService] Попытка генерации с моделью {"item_id":4,"model":"google/gemini-2.5-flash-image"}
2025-11-08T20:24:05+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.74,"body_size":1952207,"content_type":"application/json"}
2025-11-08T20:24:05+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, error_message = ...","affected_rows":2}
2025-11-08T20:24:05+00:00 ERROR [IllustrationService] Ошибка генерации иллюстрации {"item_id":4,"error":"Не удалось декодировать изображение из base64","trace":"#0 /home/engine/project/src/Rss2Tlg/Pipeline/IllustrationService.php(178): App\\Rss2Tlg\\Pipeline\\IllustrationService->saveImage()\n#1 /home/engine/project/tests/Rss2Tlg/illustration_test.php(382): App\\Rss2Tlg\\Pipeline\\IllustrationService->processItem()\n#2 /home/engine/project/tests/Rss2Tlg/illustration_test.php(86): IllustrationTest->runIllustrationGeneration()\n#3 /home/engine/project/tests/Rss2Tlg/illustration_test.php(581): IllustrationTest->run()\n#4 {main}"}
2025-11-08T20:24:05+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.144,"body_size":420,"content_type":"application/json"}
2025-11-08T20:24:05+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.19,"body_size":457,"content_type":"application/json"}
2025-11-08T20:24:06+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.16,"body_size":377,"content_type":"application/json"}
2025-11-08T20:24:06+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as total, SUM(CASE WHEN status = 'success' THEN 1 ELSE 0 END) as success, SUM(CASE WHEN status = 'failed' THEN 1 ELSE 0 END) as failed, SUM(CASE WHEN status = 'skipped' THEN 1 ELSE 0 E...","found":true}
2025-11-08T20:24:06+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT image_path FROM rss2tlg_illustration WHERE status = 'success'","rows":0}
2025-11-08T20:24:06+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.195,"body_size":414,"content_type":"application/json"}
2025-11-08T20:24:06+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.151,"body_size":362,"content_type":"application/json"}
2025-11-08T20:24:06+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.139,"body_size":585,"content_type":"application/json"}
2025-11-08T20:24:58+00:00 DEBUG Версия MySQL проверена {"version":"10.11.13-MariaDB-0ubuntu0.24.04.1","major":10,"minor":11,"patch":13}
2025-11-08T20:24:58+00:00 DEBUG Успешное подключение к БД {"host":"localhost","database":"rss2tlg","persistent":false,"charset":"utf8mb4"}
2025-11-08T20:24:58+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.41,"body_size":542,"content_type":"application/json"}
2025-11-08T20:24:58+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT VERSION() as version","found":true}
2025-11-08T20:24:58+00:00 DEBUG Выполнен SELECT запрос {"query":"SHOW TABLES","rows":10}
2025-11-08T20:24:58+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.145,"body_size":543,"content_type":"application/json"}
2025-11-08T20:24:58+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.157,"body_size":450,"content_type":"application/json"}
2025-11-08T20:24:58+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:24:58+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:24:58+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:24:59+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:24:59+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:24:59+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:24:59+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as cnt FROM rss2tlg_items","found":true}
2025-11-08T20:24:59+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.152,"body_size":359,"content_type":"application/json"}
2025-11-08T20:24:59+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":432,"content_type":"application/json"}
2025-11-08T20:24:59+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":3}
2025-11-08T20:24:59+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:24:59+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:24:59+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:24:59+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":13,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:25:05+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.482,"body_size":1614,"content_type":"application/json"}
2025-11-08T20:25:05+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:25:05+00:00 INFO [Summarization] Новость успешно обработана {"item_id":13,"processing_time_ms":6500}
2025-11-08T20:25:05+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:25:05+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:25:05+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:25:05+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":14,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:25:10+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.774,"body_size":1304,"content_type":"application/json"}
2025-11-08T20:25:10+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":14,"model":"anthropic/claude-3.5-sonnet","attempt":1,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:25:17+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.933,"body_size":1728,"content_type":"application/json"}
2025-11-08T20:25:17+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:25:17+00:00 INFO [Summarization] Новость успешно обработана {"item_id":14,"processing_time_ms":11727}
2025-11-08T20:25:17+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:25:17+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:25:17+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:25:17+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":15,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:25:21+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":3.552,"body_size":1105,"content_type":"application/json"}
2025-11-08T20:25:21+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":15,"model":"anthropic/claude-3.5-sonnet","attempt":1,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:25:26+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.212,"body_size":1157,"content_type":"application/json"}
2025-11-08T20:25:26+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":15,"model":"anthropic/claude-3.5-sonnet","attempt":2,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:25:33+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.955,"body_size":1731,"content_type":"application/json"}
2025-11-08T20:25:33+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:25:33+00:00 INFO [Summarization] Новость успешно обработана {"item_id":15,"processing_time_ms":15741}
2025-11-08T20:25:33+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":3}
2025-11-08T20:25:33+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:25:33+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:25:33+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:25:33+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":16,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:25:38+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.287,"body_size":1607,"content_type":"application/json"}
2025-11-08T20:25:38+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:25:38+00:00 INFO [Summarization] Новость успешно обработана {"item_id":16,"processing_time_ms":5297}
2025-11-08T20:25:38+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:25:38+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:25:38+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:25:38+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":17,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:25:45+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.932,"body_size":1830,"content_type":"application/json"}
2025-11-08T20:25:45+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:25:45+00:00 INFO [Summarization] Новость успешно обработана {"item_id":17,"processing_time_ms":6946}
2025-11-08T20:25:45+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:25:45+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:25:45+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:25:45+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":18,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:25:51+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.448,"body_size":1562,"content_type":"application/json"}
2025-11-08T20:25:51+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:25:51+00:00 INFO [Summarization] Новость успешно обработана {"item_id":18,"processing_time_ms":5460}
2025-11-08T20:25:51+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.215,"body_size":438,"content_type":"application/json"}
2025-11-08T20:25:51+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.186,"body_size":427,"content_type":"application/json"}
2025-11-08T20:25:51+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":3}
2025-11-08T20:25:51+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:25:51+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:25:51+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:25:51+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:25:51+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":13,"count":5}
2025-11-08T20:25:51+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":13,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:25:59+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.538,"body_size":1753,"content_type":"application/json"}
2025-11-08T20:25:59+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:25:59+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":13,"is_duplicate":false,"similarity_score":0,"processing_time_ms":7557}
2025-11-08T20:25:59+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:25:59+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:25:59+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:25:59+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:25:59+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":14,"count":5}
2025-11-08T20:25:59+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":14,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:26:05+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.51,"body_size":1710,"content_type":"application/json"}
2025-11-08T20:26:05+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:26:05+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":14,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":6531}
2025-11-08T20:26:05+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:26:05+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:26:05+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:26:05+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:26:05+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":15,"count":5}
2025-11-08T20:26:05+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":15,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:26:12+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.108,"body_size":1766,"content_type":"application/json"}
2025-11-08T20:26:12+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:26:12+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":15,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":7130}
2025-11-08T20:26:12+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":3}
2025-11-08T20:26:12+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:26:12+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:26:12+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:26:12+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:26:12+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":16,"count":5}
2025-11-08T20:26:12+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":16,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:26:20+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.49,"body_size":1891,"content_type":"application/json"}
2025-11-08T20:26:20+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:26:20+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":16,"is_duplicate":false,"similarity_score":0,"processing_time_ms":7503}
2025-11-08T20:26:20+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:26:20+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:26:20+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:26:20+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:26:20+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":17,"count":5}
2025-11-08T20:26:20+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":17,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:26:27+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.698,"body_size":1822,"content_type":"application/json"}
2025-11-08T20:26:27+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:26:27+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":17,"is_duplicate":false,"similarity_score":0,"processing_time_ms":7712}
2025-11-08T20:26:27+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:26:27+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:26:27+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:26:27+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:26:27+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":18,"count":5}
2025-11-08T20:26:27+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":18,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:26:34+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.899,"body_size":1729,"content_type":"application/json"}
2025-11-08T20:26:34+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:26:34+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":18,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":6913}
2025-11-08T20:26:34+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.146,"body_size":432,"content_type":"application/json"}
2025-11-08T20:26:35+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.155,"body_size":432,"content_type":"application/json"}
2025-11-08T20:26:35+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":1}
2025-11-08T20:26:35+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.143,"body_size":403,"content_type":"application/json"}
2025-11-08T20:26:35+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.14,"body_size":449,"content_type":"application/json"}
2025-11-08T20:26:35+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_illustration WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:26:35+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT i.id, i.feed_id, i.title, i.link, s.headline, s.summary, s.category_primary, s.importance_rating, s.article_language FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id ...","found":true}
2025-11-08T20:26:35+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT can_be_published FROM rss2tlg_deduplication WHERE item_id = :item_id AND status = 'checked' LIMIT 1","found":true}
2025-11-08T20:26:35+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NOW...","affected_rows":1}
2025-11-08T20:26:46+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":11.41,"body_size":3252,"content_type":"application/json"}
2025-11-08T20:26:46+00:00 DEBUG [IllustrationService] Попытка генерации с моделью {"item_id":13,"model":"google/gemini-2.5-flash-image"}
2025-11-08T20:26:53+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.141,"body_size":2133056,"content_type":"application/json"}
2025-11-08T20:26:53+00:00 DEBUG [IllustrationService] Обработка изображения {"item_id":13,"data_length":39,"data_preview":"Here's that political cartoon for you: "}
2025-11-08T20:26:53+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, error_message = ...","affected_rows":2}
2025-11-08T20:26:53+00:00 ERROR [IllustrationService] Ошибка генерации иллюстрации {"item_id":13,"error":"Не удалось декодировать изображение из base64","trace":"#0 /home/engine/project/src/Rss2Tlg/Pipeline/IllustrationService.php(178): App\\Rss2Tlg\\Pipeline\\IllustrationService->saveImage()\n#1 /home/engine/project/tests/Rss2Tlg/illustration_test.php(382): App\\Rss2Tlg\\Pipeline\\IllustrationService->processItem()\n#2 /home/engine/project/tests/Rss2Tlg/illustration_test.php(86): IllustrationTest->runIllustrationGeneration()\n#3 /home/engine/project/tests/Rss2Tlg/illustration_test.php(581): IllustrationTest->run()\n#4 {main}"}
2025-11-08T20:26:54+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.159,"body_size":421,"content_type":"application/json"}
2025-11-08T20:26:54+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":2}
2025-11-08T20:26:54+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.142,"body_size":401,"content_type":"application/json"}
2025-11-08T20:26:54+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.149,"body_size":449,"content_type":"application/json"}
2025-11-08T20:26:54+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_illustration WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:26:54+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT i.id, i.feed_id, i.title, i.link, s.headline, s.summary, s.category_primary, s.importance_rating, s.article_language FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id ...","found":true}
2025-11-08T20:26:54+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT can_be_published FROM rss2tlg_deduplication WHERE item_id = :item_id AND status = 'checked' LIMIT 1","found":true}
2025-11-08T20:26:54+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NOW...","affected_rows":1}
2025-11-08T20:27:06+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":11.565,"body_size":2970,"content_type":"application/json"}
2025-11-08T20:27:06+00:00 DEBUG [IllustrationService] Попытка генерации с моделью {"item_id":16,"model":"google/gemini-2.5-flash-image"}
2025-11-08T20:27:15+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":9.254,"body_size":1907487,"content_type":"application/json"}
2025-11-08T20:27:15+00:00 DEBUG [IllustrationService] Обработка изображения {"item_id":16,"data_length":43,"data_preview":"Here's that powerful British lion for you! "}
2025-11-08T20:27:15+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, error_message = ...","affected_rows":2}
2025-11-08T20:27:15+00:00 ERROR [IllustrationService] Ошибка генерации иллюстрации {"item_id":16,"error":"Не удалось декодировать изображение из base64","trace":"#0 /home/engine/project/src/Rss2Tlg/Pipeline/IllustrationService.php(178): App\\Rss2Tlg\\Pipeline\\IllustrationService->saveImage()\n#1 /home/engine/project/tests/Rss2Tlg/illustration_test.php(382): App\\Rss2Tlg\\Pipeline\\IllustrationService->processItem()\n#2 /home/engine/project/tests/Rss2Tlg/illustration_test.php(86): IllustrationTest->runIllustrationGeneration()\n#3 /home/engine/project/tests/Rss2Tlg/illustration_test.php(581): IllustrationTest->run()\n#4 {main}"}
2025-11-08T20:27:15+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":421,"content_type":"application/json"}
2025-11-08T20:27:15+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.147,"body_size":449,"content_type":"application/json"}
2025-11-08T20:27:15+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_illustration WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:27:15+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT i.id, i.feed_id, i.title, i.link, s.headline, s.summary, s.category_primary, s.importance_rating, s.article_language FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id ...","found":true}
2025-11-08T20:27:15+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT can_be_published FROM rss2tlg_deduplication WHERE item_id = :item_id AND status = 'checked' LIMIT 1","found":true}
2025-11-08T20:27:15+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NOW...","affected_rows":1}
2025-11-08T20:27:27+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":12.368,"body_size":3202,"content_type":"application/json"}
2025-11-08T20:27:27+00:00 DEBUG [IllustrationService] Попытка генерации с моделью {"item_id":17,"model":"google/gemini-2.5-flash-image"}
2025-11-08T20:27:34+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.311,"body_size":1731194,"content_type":"application/json"}
2025-11-08T20:27:34+00:00 DEBUG [IllustrationService] Обработка изображения {"item_id":17,"data_length":51,"data_preview":"Here's that stylized McLaren F1 car image for you! "}
2025-11-08T20:27:34+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, error_message = ...","affected_rows":2}
2025-11-08T20:27:34+00:00 ERROR [IllustrationService] Ошибка генерации иллюстрации {"item_id":17,"error":"Не удалось декодировать изображение из base64","trace":"#0 /home/engine/project/src/Rss2Tlg/Pipeline/IllustrationService.php(178): App\\Rss2Tlg\\Pipeline\\IllustrationService->saveImage()\n#1 /home/engine/project/tests/Rss2Tlg/illustration_test.php(382): App\\Rss2Tlg\\Pipeline\\IllustrationService->processItem()\n#2 /home/engine/project/tests/Rss2Tlg/illustration_test.php(86): IllustrationTest->runIllustrationGeneration()\n#3 /home/engine/project/tests/Rss2Tlg/illustration_test.php(581): IllustrationTest->run()\n#4 {main}"}
2025-11-08T20:27:34+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.139,"body_size":421,"content_type":"application/json"}
2025-11-08T20:27:34+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.14,"body_size":456,"content_type":"application/json"}
2025-11-08T20:27:34+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.153,"body_size":377,"content_type":"application/json"}
2025-11-08T20:27:34+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as total, SUM(CASE WHEN status = 'success' THEN 1 ELSE 0 END) as success, SUM(CASE WHEN status = 'failed' THEN 1 ELSE 0 END) as failed, SUM(CASE WHEN status = 'skipped' THEN 1 ELSE 0 E...","found":true}
2025-11-08T20:27:34+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT image_path FROM rss2tlg_illustration WHERE status = 'success'","rows":0}
2025-11-08T20:27:34+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.176,"body_size":414,"content_type":"application/json"}
2025-11-08T20:27:35+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.152,"body_size":362,"content_type":"application/json"}
2025-11-08T20:27:35+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.174,"body_size":585,"content_type":"application/json"}
2025-11-08T20:28:24+00:00 DEBUG Версия MySQL проверена {"version":"10.11.13-MariaDB-0ubuntu0.24.04.1","major":10,"minor":11,"patch":13}
2025-11-08T20:28:24+00:00 DEBUG Успешное подключение к БД {"host":"localhost","database":"rss2tlg","persistent":false,"charset":"utf8mb4"}
2025-11-08T20:28:24+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.42,"body_size":542,"content_type":"application/json"}
2025-11-08T20:28:24+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT VERSION() as version","found":true}
2025-11-08T20:28:24+00:00 DEBUG Выполнен SELECT запрос {"query":"SHOW TABLES","rows":10}
2025-11-08T20:28:24+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":543,"content_type":"application/json"}
2025-11-08T20:28:24+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.139,"body_size":450,"content_type":"application/json"}
2025-11-08T20:28:24+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:28:24+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:28:24+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:28:25+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:28:25+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:28:25+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:28:25+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as cnt FROM rss2tlg_items","found":true}
2025-11-08T20:28:25+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.14,"body_size":359,"content_type":"application/json"}
2025-11-08T20:28:25+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.139,"body_size":432,"content_type":"application/json"}
2025-11-08T20:28:25+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":3}
2025-11-08T20:28:25+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:28:25+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:28:25+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:28:25+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":19,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:28:32+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.73,"body_size":1759,"content_type":"application/json"}
2025-11-08T20:28:32+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:28:32+00:00 INFO [Summarization] Новость успешно обработана {"item_id":19,"processing_time_ms":6740}
2025-11-08T20:28:32+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:28:32+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:28:32+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:28:32+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":20,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:28:38+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.162,"body_size":1789,"content_type":"application/json"}
2025-11-08T20:28:38+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:28:38+00:00 INFO [Summarization] Новость успешно обработана {"item_id":20,"processing_time_ms":6171}
2025-11-08T20:28:38+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:28:38+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:28:38+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:28:38+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":21,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:28:42+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.296,"body_size":1181,"content_type":"application/json"}
2025-11-08T20:28:42+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":21,"model":"anthropic/claude-3.5-sonnet","attempt":1,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:28:49+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.13,"body_size":1743,"content_type":"application/json"}
2025-11-08T20:28:49+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:28:49+00:00 INFO [Summarization] Новость успешно обработана {"item_id":21,"processing_time_ms":11441}
2025-11-08T20:28:49+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":3}
2025-11-08T20:28:49+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:28:49+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:28:49+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:28:49+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":22,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:28:55+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.42,"body_size":1665,"content_type":"application/json"}
2025-11-08T20:28:55+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:28:55+00:00 INFO [Summarization] Новость успешно обработана {"item_id":22,"processing_time_ms":5429}
2025-11-08T20:28:55+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:28:55+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:28:55+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:28:55+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":23,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:29:02+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.991,"body_size":1815,"content_type":"application/json"}
2025-11-08T20:29:02+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:29:02+00:00 INFO [Summarization] Новость успешно обработана {"item_id":23,"processing_time_ms":7002}
2025-11-08T20:29:02+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:29:02+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:29:02+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:29:02+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":24,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:29:07+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.341,"body_size":1553,"content_type":"application/json"}
2025-11-08T20:29:07+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:29:07+00:00 INFO [Summarization] Новость успешно обработана {"item_id":24,"processing_time_ms":5350}
2025-11-08T20:29:08+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.507,"body_size":438,"content_type":"application/json"}
2025-11-08T20:29:08+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.15,"body_size":427,"content_type":"application/json"}
2025-11-08T20:29:08+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":3}
2025-11-08T20:29:08+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:29:08+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:29:08+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:29:08+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:29:08+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":19,"count":5}
2025-11-08T20:29:08+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":19,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:29:16+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.762,"body_size":1731,"content_type":"application/json"}
2025-11-08T20:29:16+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:29:16+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":19,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":7781}
2025-11-08T20:29:16+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:29:16+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:29:16+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:29:16+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:29:16+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":20,"count":5}
2025-11-08T20:29:16+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":20,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:29:23+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.914,"body_size":1948,"content_type":"application/json"}
2025-11-08T20:29:23+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:29:23+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":20,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":7936}
2025-11-08T20:29:23+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:29:24+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:29:24+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:29:24+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:29:24+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":21,"count":5}
2025-11-08T20:29:24+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":21,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:29:31+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.571,"body_size":1765,"content_type":"application/json"}
2025-11-08T20:29:31+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:29:31+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":21,"is_duplicate":false,"similarity_score":0,"processing_time_ms":7591}
2025-11-08T20:29:31+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":3}
2025-11-08T20:29:31+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:29:31+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:29:31+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:29:31+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:29:31+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":22,"count":5}
2025-11-08T20:29:31+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":22,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:29:39+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.462,"body_size":1814,"content_type":"application/json"}
2025-11-08T20:29:39+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:29:39+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":22,"is_duplicate":false,"similarity_score":0,"processing_time_ms":7482}
2025-11-08T20:29:39+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:29:39+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:29:39+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:29:39+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:29:39+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":23,"count":5}
2025-11-08T20:29:39+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":23,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:29:47+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.917,"body_size":1801,"content_type":"application/json"}
2025-11-08T20:29:47+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:29:47+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":23,"is_duplicate":false,"similarity_score":0,"processing_time_ms":7934}
2025-11-08T20:29:47+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:29:47+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:29:47+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:29:47+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:29:47+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":24,"count":5}
2025-11-08T20:29:47+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":24,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:29:54+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.048,"body_size":1692,"content_type":"application/json"}
2025-11-08T20:29:54+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:29:54+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":24,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":7065}
2025-11-08T20:29:54+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.137,"body_size":432,"content_type":"application/json"}
2025-11-08T20:29:54+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":432,"content_type":"application/json"}
2025-11-08T20:29:54+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":1}
2025-11-08T20:29:54+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":403,"content_type":"application/json"}
2025-11-08T20:29:54+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":449,"content_type":"application/json"}
2025-11-08T20:29:54+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_illustration WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:29:54+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT i.id, i.feed_id, i.title, i.link, s.headline, s.summary, s.category_primary, s.importance_rating, s.article_language FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id ...","found":true}
2025-11-08T20:29:54+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT can_be_published FROM rss2tlg_deduplication WHERE item_id = :item_id AND status = 'checked' LIMIT 1","found":true}
2025-11-08T20:29:54+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NOW...","affected_rows":1}
2025-11-08T20:30:03+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":9.309,"body_size":3191,"content_type":"application/json"}
2025-11-08T20:30:03+00:00 ERROR [IllustrationService] Ошибка анализа для промпта {"item_id":21,"error":"AI не вернул валидный промпт"}
2025-11-08T20:30:03+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, error_message = ...","affected_rows":2}
2025-11-08T20:30:03+00:00 ERROR [IllustrationService] Ошибка генерации иллюстрации {"item_id":21,"error":"Не удалось создать промпт для генерации","trace":"#0 /home/engine/project/tests/Rss2Tlg/illustration_test.php(382): App\\Rss2Tlg\\Pipeline\\IllustrationService->processItem()\n#1 /home/engine/project/tests/Rss2Tlg/illustration_test.php(86): IllustrationTest->runIllustrationGeneration()\n#2 /home/engine/project/tests/Rss2Tlg/illustration_test.php(581): IllustrationTest->run()\n#3 {main}"}
2025-11-08T20:30:04+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.157,"body_size":421,"content_type":"application/json"}
2025-11-08T20:30:04+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":2}
2025-11-08T20:30:04+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.181,"body_size":401,"content_type":"application/json"}
2025-11-08T20:30:04+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.174,"body_size":449,"content_type":"application/json"}
2025-11-08T20:30:04+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_illustration WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:30:04+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT i.id, i.feed_id, i.title, i.link, s.headline, s.summary, s.category_primary, s.importance_rating, s.article_language FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id ...","found":true}
2025-11-08T20:30:04+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT can_be_published FROM rss2tlg_deduplication WHERE item_id = :item_id AND status = 'checked' LIMIT 1","found":true}
2025-11-08T20:30:04+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NOW...","affected_rows":1}
2025-11-08T20:30:15+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":10.642,"body_size":3061,"content_type":"application/json"}
2025-11-08T20:30:15+00:00 DEBUG [IllustrationService] Попытка генерации с моделью {"item_id":22,"model":"openai/dall-e-3"}
2025-11-08T20:30:15+00:00 WARNING HTTP запрос выполнен [POST chat/completions] код 400 {"method":"POST","uri":"chat/completions","status_code":400,"duration":0.107,"body_size":119,"content_type":"application/json"}
2025-11-08T20:30:15+00:00 ERROR Сервер OpenRouter вернул ошибку {"status_code":400,"endpoint":"/chat/completions","response":"{\"error\":{\"message\":\"openai/dall-e-3 is not a valid model ID\",\"code\":400},\"user_id\":\"user_2uzYK4r5bBdyFPv9IXa9E4YSycG\"}"}
2025-11-08T20:30:15+00:00 WARNING [IllustrationService] Ошибка при генерации изображения {"item_id":22,"model":"openai/dall-e-3","attempt":1,"error":"Сервер вернул код ошибки"}
2025-11-08T20:30:17+00:00 WARNING HTTP запрос выполнен [POST chat/completions] код 400 {"method":"POST","uri":"chat/completions","status_code":400,"duration":0.041,"body_size":119,"content_type":"application/json"}
2025-11-08T20:30:17+00:00 ERROR Сервер OpenRouter вернул ошибку {"status_code":400,"endpoint":"/chat/completions","response":"{\"error\":{\"message\":\"openai/dall-e-3 is not a valid model ID\",\"code\":400},\"user_id\":\"user_2uzYK4r5bBdyFPv9IXa9E4YSycG\"}"}
2025-11-08T20:30:17+00:00 WARNING [IllustrationService] Ошибка при генерации изображения {"item_id":22,"model":"openai/dall-e-3","attempt":2,"error":"Сервер вернул код ошибки"}
2025-11-08T20:30:20+00:00 WARNING HTTP запрос выполнен [POST chat/completions] код 400 {"method":"POST","uri":"chat/completions","status_code":400,"duration":0.783,"body_size":119,"content_type":"application/json"}
2025-11-08T20:30:20+00:00 ERROR Сервер OpenRouter вернул ошибку {"status_code":400,"endpoint":"/chat/completions","response":"{\"error\":{\"message\":\"openai/dall-e-3 is not a valid model ID\",\"code\":400},\"user_id\":\"user_2uzYK4r5bBdyFPv9IXa9E4YSycG\"}"}
2025-11-08T20:30:20+00:00 WARNING [IllustrationService] Ошибка при генерации изображения {"item_id":22,"model":"openai/dall-e-3","attempt":3,"error":"Сервер вернул код ошибки"}
2025-11-08T20:30:20+00:00 ERROR [IllustrationService] Все модели не смогли сгенерировать изображение {"item_id":22,"last_error":"Сервер вернул код ошибки"}
2025-11-08T20:30:20+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, error_message = ...","affected_rows":2}
2025-11-08T20:30:20+00:00 ERROR [IllustrationService] Ошибка генерации иллюстрации {"item_id":22,"error":"Не удалось сгенерировать изображение","trace":"#0 /home/engine/project/tests/Rss2Tlg/illustration_test.php(382): App\\Rss2Tlg\\Pipeline\\IllustrationService->processItem()\n#1 /home/engine/project/tests/Rss2Tlg/illustration_test.php(86): IllustrationTest->runIllustrationGeneration()\n#2 /home/engine/project/tests/Rss2Tlg/illustration_test.php(581): IllustrationTest->run()\n#3 {main}"}
2025-11-08T20:30:20+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.201,"body_size":421,"content_type":"application/json"}
2025-11-08T20:30:20+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.25,"body_size":449,"content_type":"application/json"}
2025-11-08T20:30:20+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_illustration WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:30:20+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT i.id, i.feed_id, i.title, i.link, s.headline, s.summary, s.category_primary, s.importance_rating, s.article_language FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id ...","found":true}
2025-11-08T20:30:20+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT can_be_published FROM rss2tlg_deduplication WHERE item_id = :item_id AND status = 'checked' LIMIT 1","found":true}
2025-11-08T20:30:20+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NOW...","affected_rows":1}
2025-11-08T20:30:35+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":14.535,"body_size":3343,"content_type":"application/json"}
2025-11-08T20:30:35+00:00 DEBUG [IllustrationService] Попытка генерации с моделью {"item_id":23,"model":"openai/dall-e-3"}
2025-11-08T20:30:35+00:00 WARNING HTTP запрос выполнен [POST chat/completions] код 400 {"method":"POST","uri":"chat/completions","status_code":400,"duration":0.06,"body_size":119,"content_type":"application/json"}
2025-11-08T20:30:35+00:00 ERROR Сервер OpenRouter вернул ошибку {"status_code":400,"endpoint":"/chat/completions","response":"{\"error\":{\"message\":\"openai/dall-e-3 is not a valid model ID\",\"code\":400},\"user_id\":\"user_2uzYK4r5bBdyFPv9IXa9E4YSycG\"}"}
2025-11-08T20:30:35+00:00 WARNING [IllustrationService] Ошибка при генерации изображения {"item_id":23,"model":"openai/dall-e-3","attempt":1,"error":"Сервер вернул код ошибки"}
2025-11-08T20:30:37+00:00 WARNING HTTP запрос выполнен [POST chat/completions] код 400 {"method":"POST","uri":"chat/completions","status_code":400,"duration":0.032,"body_size":119,"content_type":"application/json"}
2025-11-08T20:30:37+00:00 ERROR Сервер OpenRouter вернул ошибку {"status_code":400,"endpoint":"/chat/completions","response":"{\"error\":{\"message\":\"openai/dall-e-3 is not a valid model ID\",\"code\":400},\"user_id\":\"user_2uzYK4r5bBdyFPv9IXa9E4YSycG\"}"}
2025-11-08T20:30:37+00:00 WARNING [IllustrationService] Ошибка при генерации изображения {"item_id":23,"model":"openai/dall-e-3","attempt":2,"error":"Сервер вернул код ошибки"}
2025-11-08T20:30:39+00:00 WARNING HTTP запрос выполнен [POST chat/completions] код 400 {"method":"POST","uri":"chat/completions","status_code":400,"duration":0.061,"body_size":119,"content_type":"application/json"}
2025-11-08T20:30:39+00:00 ERROR Сервер OpenRouter вернул ошибку {"status_code":400,"endpoint":"/chat/completions","response":"{\"error\":{\"message\":\"openai/dall-e-3 is not a valid model ID\",\"code\":400},\"user_id\":\"user_2uzYK4r5bBdyFPv9IXa9E4YSycG\"}"}
2025-11-08T20:30:39+00:00 WARNING [IllustrationService] Ошибка при генерации изображения {"item_id":23,"model":"openai/dall-e-3","attempt":3,"error":"Сервер вернул код ошибки"}
2025-11-08T20:30:39+00:00 ERROR [IllustrationService] Все модели не смогли сгенерировать изображение {"item_id":23,"last_error":"Сервер вернул код ошибки"}
2025-11-08T20:30:39+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, error_message = ...","affected_rows":2}
2025-11-08T20:30:39+00:00 ERROR [IllustrationService] Ошибка генерации иллюстрации {"item_id":23,"error":"Не удалось сгенерировать изображение","trace":"#0 /home/engine/project/tests/Rss2Tlg/illustration_test.php(382): App\\Rss2Tlg\\Pipeline\\IllustrationService->processItem()\n#1 /home/engine/project/tests/Rss2Tlg/illustration_test.php(86): IllustrationTest->runIllustrationGeneration()\n#2 /home/engine/project/tests/Rss2Tlg/illustration_test.php(581): IllustrationTest->run()\n#3 {main}"}
2025-11-08T20:30:39+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.144,"body_size":421,"content_type":"application/json"}
2025-11-08T20:30:39+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.151,"body_size":457,"content_type":"application/json"}
2025-11-08T20:30:39+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.169,"body_size":377,"content_type":"application/json"}
2025-11-08T20:30:39+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as total, SUM(CASE WHEN status = 'success' THEN 1 ELSE 0 END) as success, SUM(CASE WHEN status = 'failed' THEN 1 ELSE 0 END) as failed, SUM(CASE WHEN status = 'skipped' THEN 1 ELSE 0 E...","found":true}
2025-11-08T20:30:39+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT image_path FROM rss2tlg_illustration WHERE status = 'success'","rows":0}
2025-11-08T20:30:39+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.19,"body_size":414,"content_type":"application/json"}
2025-11-08T20:30:40+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.155,"body_size":362,"content_type":"application/json"}
2025-11-08T20:30:40+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.138,"body_size":585,"content_type":"application/json"}
2025-11-08T20:32:28+00:00 DEBUG Версия MySQL проверена {"version":"10.11.13-MariaDB-0ubuntu0.24.04.1","major":10,"minor":11,"patch":13}
2025-11-08T20:32:28+00:00 DEBUG Успешное подключение к БД {"host":"localhost","database":"rss2tlg","persistent":false,"charset":"utf8mb4"}
2025-11-08T20:32:28+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.43,"body_size":542,"content_type":"application/json"}
2025-11-08T20:32:28+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT VERSION() as version","found":true}
2025-11-08T20:32:28+00:00 DEBUG Выполнен SELECT запрос {"query":"SHOW TABLES","rows":10}
2025-11-08T20:32:29+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.169,"body_size":543,"content_type":"application/json"}
2025-11-08T20:32:29+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.213,"body_size":450,"content_type":"application/json"}
2025-11-08T20:32:29+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:32:29+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:32:29+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:32:29+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:32:29+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:32:29+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:32:29+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as cnt FROM rss2tlg_items","found":true}
2025-11-08T20:32:29+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.26,"body_size":359,"content_type":"application/json"}
2025-11-08T20:32:30+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.239,"body_size":432,"content_type":"application/json"}
2025-11-08T20:32:30+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":3}
2025-11-08T20:32:30+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:32:30+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:32:30+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:32:30+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":25,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:32:36+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.955,"body_size":1622,"content_type":"application/json"}
2025-11-08T20:32:36+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:32:36+00:00 INFO [Summarization] Новость успешно обработана {"item_id":25,"processing_time_ms":5968}
2025-11-08T20:32:36+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:32:36+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:32:36+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:32:36+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":26,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:32:39+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":3.833,"body_size":1134,"content_type":"application/json"}
2025-11-08T20:32:39+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":26,"model":"anthropic/claude-3.5-sonnet","attempt":1,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:32:45+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.478,"body_size":1139,"content_type":"application/json"}
2025-11-08T20:32:45+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":26,"model":"anthropic/claude-3.5-sonnet","attempt":2,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:32:51+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.57,"body_size":1318,"content_type":"application/json"}
2025-11-08T20:32:51+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":26,"model":"anthropic/claude-3.5-sonnet","attempt":3,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:32:51+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":26,"model":"deepseek/deepseek-chat"}
2025-11-08T20:32:54+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":3.851,"body_size":1751,"content_type":"application/json"}
2025-11-08T20:32:54+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:32:54+00:00 INFO [Summarization] Новость успешно обработана {"item_id":26,"processing_time_ms":18761}
2025-11-08T20:32:54+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:32:54+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:32:54+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:32:54+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":27,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:32:59+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.464,"body_size":1286,"content_type":"application/json"}
2025-11-08T20:32:59+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":27,"model":"anthropic/claude-3.5-sonnet","attempt":1,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:33:06+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.669,"body_size":1700,"content_type":"application/json"}
2025-11-08T20:33:06+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:33:06+00:00 INFO [Summarization] Новость успешно обработана {"item_id":27,"processing_time_ms":11149}
2025-11-08T20:33:06+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":3}
2025-11-08T20:33:06+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:33:06+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:33:06+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:33:06+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":28,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:33:11+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.832,"body_size":1671,"content_type":"application/json"}
2025-11-08T20:33:11+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:33:11+00:00 INFO [Summarization] Новость успешно обработана {"item_id":28,"processing_time_ms":5842}
2025-11-08T20:33:11+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:33:11+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:33:11+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:33:11+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":29,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:33:18+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.714,"body_size":1795,"content_type":"application/json"}
2025-11-08T20:33:18+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:33:18+00:00 INFO [Summarization] Новость успешно обработана {"item_id":29,"processing_time_ms":6726}
2025-11-08T20:33:18+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:33:18+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:33:18+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:33:18+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":30,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:33:23+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.264,"body_size":1548,"content_type":"application/json"}
2025-11-08T20:33:23+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:33:23+00:00 INFO [Summarization] Новость успешно обработана {"item_id":30,"processing_time_ms":5276}
2025-11-08T20:33:24+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.138,"body_size":438,"content_type":"application/json"}
2025-11-08T20:33:24+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.137,"body_size":427,"content_type":"application/json"}
2025-11-08T20:33:24+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":3}
2025-11-08T20:33:24+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:33:24+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:33:24+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:33:24+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:33:24+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":25,"count":5}
2025-11-08T20:33:24+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":25,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:33:31+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.132,"body_size":1747,"content_type":"application/json"}
2025-11-08T20:33:31+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:33:31+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":25,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":7151}
2025-11-08T20:33:31+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:33:31+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:33:31+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:33:31+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:33:31+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":26,"count":5}
2025-11-08T20:33:31+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":26,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:33:38+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.096,"body_size":1850,"content_type":"application/json"}
2025-11-08T20:33:38+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:33:38+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":26,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":7111}
2025-11-08T20:33:38+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:33:38+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:33:38+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:33:38+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:33:38+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":27,"count":5}
2025-11-08T20:33:38+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":27,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:33:45+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.369,"body_size":1780,"content_type":"application/json"}
2025-11-08T20:33:45+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:33:45+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":27,"is_duplicate":true,"similarity_score":15,"processing_time_ms":7385}
2025-11-08T20:33:45+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":3}
2025-11-08T20:33:45+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:33:45+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:33:45+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:33:45+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:33:45+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":28,"count":5}
2025-11-08T20:33:45+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":28,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:33:53+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.25,"body_size":1704,"content_type":"application/json"}
2025-11-08T20:33:53+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:33:53+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":28,"is_duplicate":false,"similarity_score":0,"processing_time_ms":7269}
2025-11-08T20:33:53+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:33:53+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:33:53+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:33:53+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:33:53+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":29,"count":5}
2025-11-08T20:33:53+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":29,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:34:00+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.508,"body_size":1755,"content_type":"application/json"}
2025-11-08T20:34:00+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:34:00+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":29,"is_duplicate":false,"similarity_score":0,"processing_time_ms":7526}
2025-11-08T20:34:00+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:34:00+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:34:00+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:34:00+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:34:00+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":30,"count":5}
2025-11-08T20:34:00+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":30,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:34:07+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.072,"body_size":1785,"content_type":"application/json"}
2025-11-08T20:34:07+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:34:07+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":30,"is_duplicate":true,"similarity_score":15,"processing_time_ms":7087}
2025-11-08T20:34:07+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.137,"body_size":432,"content_type":"application/json"}
2025-11-08T20:34:07+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":432,"content_type":"application/json"}
2025-11-08T20:34:07+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":0}
2025-11-08T20:34:07+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":2}
2025-11-08T20:34:08+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.162,"body_size":401,"content_type":"application/json"}
2025-11-08T20:34:08+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.139,"body_size":449,"content_type":"application/json"}
2025-11-08T20:34:08+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_illustration WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:34:08+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT i.id, i.feed_id, i.title, i.link, s.headline, s.summary, s.category_primary, s.importance_rating, s.article_language FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id ...","found":true}
2025-11-08T20:34:08+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT can_be_published FROM rss2tlg_deduplication WHERE item_id = :item_id AND status = 'checked' LIMIT 1","found":true}
2025-11-08T20:34:08+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NOW...","affected_rows":1}
2025-11-08T20:34:19+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":11.157,"body_size":3069,"content_type":"application/json"}
2025-11-08T20:34:19+00:00 DEBUG [IllustrationService] Попытка генерации с моделью {"item_id":28,"model":"openai/dall-e-3"}
2025-11-08T20:34:19+00:00 WARNING [IllustrationService] Генерация через OpenRouter недоступна, используем placeholder {"item_id":28,"model":"openai/dall-e-3"}
2025-11-08T20:34:40+00:00 DEBUG Версия MySQL проверена {"version":"10.11.13-MariaDB-0ubuntu0.24.04.1","major":10,"minor":11,"patch":13}
2025-11-08T20:34:40+00:00 DEBUG Успешное подключение к БД {"host":"localhost","database":"rss2tlg","persistent":false,"charset":"utf8mb4"}
2025-11-08T20:34:41+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.479,"body_size":542,"content_type":"application/json"}
2025-11-08T20:34:41+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT VERSION() as version","found":true}
2025-11-08T20:34:41+00:00 DEBUG Выполнен SELECT запрос {"query":"SHOW TABLES","rows":10}
2025-11-08T20:34:41+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.197,"body_size":543,"content_type":"application/json"}
2025-11-08T20:34:41+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.21,"body_size":450,"content_type":"application/json"}
2025-11-08T20:34:42+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:34:42+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:34:42+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:34:42+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:34:42+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:34:42+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:34:42+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as cnt FROM rss2tlg_items","found":true}
2025-11-08T20:34:42+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.191,"body_size":359,"content_type":"application/json"}
2025-11-08T20:34:42+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.24,"body_size":432,"content_type":"application/json"}
2025-11-08T20:34:42+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":0}
2025-11-08T20:34:42+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":0}
2025-11-08T20:34:43+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.281,"body_size":438,"content_type":"application/json"}
2025-11-08T20:34:43+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.336,"body_size":427,"content_type":"application/json"}
2025-11-08T20:34:43+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":0}
2025-11-08T20:34:43+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":0}
2025-11-08T20:34:43+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.218,"body_size":432,"content_type":"application/json"}
2025-11-08T20:34:43+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.182,"body_size":432,"content_type":"application/json"}
2025-11-08T20:34:43+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":0}
2025-11-08T20:34:43+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":1}
2025-11-08T20:34:43+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.14,"body_size":401,"content_type":"application/json"}
2025-11-08T20:34:44+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.171,"body_size":449,"content_type":"application/json"}
2025-11-08T20:34:44+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_illustration WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:34:44+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT i.id, i.feed_id, i.title, i.link, s.headline, s.summary, s.category_primary, s.importance_rating, s.article_language FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id ...","found":true}
2025-11-08T20:34:44+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT can_be_published FROM rss2tlg_deduplication WHERE item_id = :item_id AND status = 'checked' LIMIT 1","found":true}
2025-11-08T20:34:44+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NOW...","affected_rows":1}
2025-11-08T20:34:55+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":10.99,"body_size":2996,"content_type":"application/json"}
2025-11-08T20:34:55+00:00 DEBUG [IllustrationService] Попытка генерации с моделью {"item_id":29,"model":"openai/dall-e-3"}
2025-11-08T20:34:55+00:00 WARNING [IllustrationService] Генерация через OpenRouter недоступна, используем placeholder {"item_id":29,"model":"openai/dall-e-3"}
2025-11-08T20:35:08+00:00 DEBUG Версия MySQL проверена {"version":"10.11.13-MariaDB-0ubuntu0.24.04.1","major":10,"minor":11,"patch":13}
2025-11-08T20:35:08+00:00 DEBUG Успешное подключение к БД {"host":"localhost","database":"rss2tlg","persistent":false,"charset":"utf8mb4"}
2025-11-08T20:35:08+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.399,"body_size":542,"content_type":"application/json"}
2025-11-08T20:35:08+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT VERSION() as version","found":true}
2025-11-08T20:35:08+00:00 DEBUG Выполнен SELECT запрос {"query":"SHOW TABLES","rows":10}
2025-11-08T20:35:09+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.14,"body_size":543,"content_type":"application/json"}
2025-11-08T20:35:09+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.136,"body_size":450,"content_type":"application/json"}
2025-11-08T20:35:09+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:35:09+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:35:09+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:35:09+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:35:09+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:35:09+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":0}
2025-11-08T20:35:09+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as cnt FROM rss2tlg_items","found":true}
2025-11-08T20:35:09+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.136,"body_size":359,"content_type":"application/json"}
2025-11-08T20:35:09+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.174,"body_size":432,"content_type":"application/json"}
2025-11-08T20:35:09+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":0}
2025-11-08T20:35:09+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":0}
2025-11-08T20:35:10+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.14,"body_size":438,"content_type":"application/json"}
2025-11-08T20:35:10+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":427,"content_type":"application/json"}
2025-11-08T20:35:10+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":0}
2025-11-08T20:35:10+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":0}
2025-11-08T20:35:10+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.144,"body_size":432,"content_type":"application/json"}
2025-11-08T20:35:10+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.137,"body_size":432,"content_type":"application/json"}
2025-11-08T20:35:10+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":0}
2025-11-08T20:35:10+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":0}
2025-11-08T20:35:10+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.143,"body_size":453,"content_type":"application/json"}
2025-11-08T20:35:10+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":377,"content_type":"application/json"}
2025-11-08T20:35:10+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as total, SUM(CASE WHEN status = 'success' THEN 1 ELSE 0 END) as success, SUM(CASE WHEN status = 'failed' THEN 1 ELSE 0 END) as failed, SUM(CASE WHEN status = 'skipped' THEN 1 ELSE 0 E...","found":true}
2025-11-08T20:35:10+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT image_path FROM rss2tlg_illustration WHERE status = 'success'","rows":0}
2025-11-08T20:35:10+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.141,"body_size":414,"content_type":"application/json"}
2025-11-08T20:35:11+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.146,"body_size":362,"content_type":"application/json"}
2025-11-08T20:35:11+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.135,"body_size":585,"content_type":"application/json"}
2025-11-08T20:35:19+00:00 DEBUG Версия MySQL проверена {"version":"10.11.13-MariaDB-0ubuntu0.24.04.1","major":10,"minor":11,"patch":13}
2025-11-08T20:35:19+00:00 DEBUG Успешное подключение к БД {"host":"localhost","database":"rss2tlg","persistent":false,"charset":"utf8mb4"}
2025-11-08T20:35:20+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.404,"body_size":542,"content_type":"application/json"}
2025-11-08T20:35:20+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT VERSION() as version","found":true}
2025-11-08T20:35:20+00:00 DEBUG Выполнен SELECT запрос {"query":"SHOW TABLES","rows":10}
2025-11-08T20:35:20+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.136,"body_size":543,"content_type":"application/json"}
2025-11-08T20:35:20+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.145,"body_size":450,"content_type":"application/json"}
2025-11-08T20:35:20+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:35:20+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:35:20+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:35:20+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:35:20+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:35:20+00:00 DEBUG Выполнена SQL команда {"query":"INSERT IGNORE INTO rss2tlg_items (feed_id, content_hash, title, link, description, content, pub_date, created_at, updated_at) VALUES (:feed_id, :content_hash, :title, :link, :description, :content, NO...","affected_rows":1}
2025-11-08T20:35:20+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as cnt FROM rss2tlg_items","found":true}
2025-11-08T20:35:21+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.188,"body_size":359,"content_type":"application/json"}
2025-11-08T20:35:21+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.168,"body_size":432,"content_type":"application/json"}
2025-11-08T20:35:21+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":3}
2025-11-08T20:35:21+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:35:21+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:35:21+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:35:21+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":43,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:35:27+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.259,"body_size":1681,"content_type":"application/json"}
2025-11-08T20:35:27+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:35:27+00:00 INFO [Summarization] Новость успешно обработана {"item_id":43,"processing_time_ms":6273}
2025-11-08T20:35:27+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:35:27+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:35:27+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:35:27+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":44,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:35:31+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":3.842,"body_size":1134,"content_type":"application/json"}
2025-11-08T20:35:31+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":44,"model":"anthropic/claude-3.5-sonnet","attempt":1,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:35:36+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.549,"body_size":1328,"content_type":"application/json"}
2025-11-08T20:35:36+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":44,"model":"anthropic/claude-3.5-sonnet","attempt":2,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:35:41+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":3.777,"body_size":1134,"content_type":"application/json"}
2025-11-08T20:35:41+00:00 WARNING [Summarization] Ошибка при вызове AI {"item_id":44,"model":"anthropic/claude-3.5-sonnet","attempt":3,"error":"Не удалось распарсить JSON ответ от AI"}
2025-11-08T20:35:41+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":44,"model":"deepseek/deepseek-chat"}
2025-11-08T20:35:46+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":4.856,"body_size":1652,"content_type":"application/json"}
2025-11-08T20:35:46+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:35:46+00:00 INFO [Summarization] Новость успешно обработана {"item_id":44,"processing_time_ms":19049}
2025-11-08T20:35:46+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:35:46+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:35:46+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:35:46+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":45,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:35:52+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.011,"body_size":1709,"content_type":"application/json"}
2025-11-08T20:35:52+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:35:52+00:00 INFO [Summarization] Новость успешно обработана {"item_id":45,"processing_time_ms":6021}
2025-11-08T20:35:52+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i LEFT JOIN rss2tlg_summarization s ON i.id = s.item_id WHERE i.feed_id = :feed_id AND s.id IS NULL LIMIT 3","rows":3}
2025-11-08T20:35:52+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:35:52+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:35:52+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:35:52+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":46,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:35:57+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.325,"body_size":1653,"content_type":"application/json"}
2025-11-08T20:35:57+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:35:57+00:00 INFO [Summarization] Новость успешно обработана {"item_id":46,"processing_time_ms":5337}
2025-11-08T20:35:57+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:35:57+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:35:57+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:35:57+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":47,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:36:04+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.852,"body_size":1798,"content_type":"application/json"}
2025-11-08T20:36:04+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:36:04+00:00 INFO [Summarization] Новость успешно обработана {"item_id":47,"processing_time_ms":6867}
2025-11-08T20:36:04+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_summarization WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:36:04+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT id, feed_id, title, description, content, extracted_content, link, pub_date FROM rss2tlg_items WHERE id = :item_id LIMIT 1","found":true}
2025-11-08T20:36:04+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_summarization (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:36:04+00:00 DEBUG [Summarization] Попытка анализа с моделью {"item_id":48,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:36:09+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":5.031,"body_size":1548,"content_type":"application/json"}
2025-11-08T20:36:09+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_summarization SET status = 'success', article_language = :article_language, category_primary = :category_primary, category_secondary = :category_secondary, headline = :headline, summary...","affected_rows":1}
2025-11-08T20:36:09+00:00 INFO [Summarization] Новость успешно обработана {"item_id":48,"processing_time_ms":5039}
2025-11-08T20:36:10+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.252,"body_size":438,"content_type":"application/json"}
2025-11-08T20:36:10+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.258,"body_size":427,"content_type":"application/json"}
2025-11-08T20:36:10+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":3}
2025-11-08T20:36:10+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:36:10+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:36:10+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:36:10+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:36:10+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":43,"count":5}
2025-11-08T20:36:10+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":43,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:36:17+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.435,"body_size":1758,"content_type":"application/json"}
2025-11-08T20:36:17+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:36:17+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":43,"is_duplicate":true,"similarity_score":15.5,"processing_time_ms":7454}
2025-11-08T20:36:17+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:36:17+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:36:17+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:36:17+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:36:17+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":44,"count":5}
2025-11-08T20:36:17+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":44,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:36:25+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.234,"body_size":1931,"content_type":"application/json"}
2025-11-08T20:36:25+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:36:25+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":44,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":7253}
2025-11-08T20:36:25+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:36:25+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:36:25+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:36:25+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:36:25+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":45,"count":5}
2025-11-08T20:36:25+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":45,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:36:32+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.143,"body_size":1769,"content_type":"application/json"}
2025-11-08T20:36:32+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:36:32+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":45,"is_duplicate":true,"similarity_score":15,"processing_time_ms":7160}
2025-11-08T20:36:32+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id LEFT JOIN rss2tlg_deduplication d ON i.id = d.item_id WHERE i.feed_id = :feed_id AND s.status = 'success' AND d....","rows":3}
2025-11-08T20:36:32+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:36:32+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:36:32+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:36:32+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:36:32+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":46,"count":5}
2025-11-08T20:36:32+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":46,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:36:39+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.129,"body_size":1727,"content_type":"application/json"}
2025-11-08T20:36:39+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:36:39+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":46,"is_duplicate":true,"similarity_score":15,"processing_time_ms":7146}
2025-11-08T20:36:39+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:36:39+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:36:39+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:36:39+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:36:39+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":47,"count":5}
2025-11-08T20:36:39+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":47,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:36:46+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":7.049,"body_size":1705,"content_type":"application/json"}
2025-11-08T20:36:46+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:36:46+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":47,"is_duplicate":false,"similarity_score":0,"processing_time_ms":7067}
2025-11-08T20:36:46+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_deduplication WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:36:46+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT s.item_id, s.feed_id, s.status as summarization_status, s.headline, s.summary, s.article_language, s.category_primary, s.importance_rating, s.dedup_canonical_entities, s.dedup_core_event, s.ded...","found":true}
2025-11-08T20:36:46+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NO...","affected_rows":1}
2025-11-08T20:36:46+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT s.item_id, s.headline, s.summary, s.article_language, s.category_primary, s.dedup_canonical_entities, s.dedup_core_event, s.dedup_numeric_facts, i.pub_date FROM rss2tlg_summarization s INNER JO...","rows":5}
2025-11-08T20:36:46+00:00 DEBUG [DeduplicationService] Найдено похожих новостей для сравнения {"item_id":48,"count":5}
2025-11-08T20:36:46+00:00 DEBUG [DeduplicationService] Попытка дедупликации с моделью {"item_id":48,"model":"anthropic/claude-3.5-sonnet"}
2025-11-08T20:36:53+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":6.977,"body_size":1729,"content_type":"application/json"}
2025-11-08T20:36:53+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_deduplication ( item_id, feed_id, status, is_duplicate, duplicate_of_item_id, similarity_score, similarity_method, can_be_published, matched_entities, matched_events, matched_facts...","affected_rows":2}
2025-11-08T20:36:53+00:00 INFO [DeduplicationService] Дедупликация завершена {"item_id":48,"is_duplicate":true,"similarity_score":12.5,"processing_time_ms":6995}
2025-11-08T20:36:53+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.137,"body_size":432,"content_type":"application/json"}
2025-11-08T20:36:53+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.138,"body_size":432,"content_type":"application/json"}
2025-11-08T20:36:53+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":0}
2025-11-08T20:36:53+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT i.id FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id INNER JOIN rss2tlg_deduplication d ON i.id = d.item_id LEFT JOIN rss2tlg_illustration il ON i.id = il.item_id WH...","rows":1}
2025-11-08T20:36:53+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.137,"body_size":401,"content_type":"application/json"}
2025-11-08T20:36:53+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.142,"body_size":449,"content_type":"application/json"}
2025-11-08T20:36:53+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT status FROM rss2tlg_illustration WHERE item_id = :item_id LIMIT 1","found":false}
2025-11-08T20:36:53+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT i.id, i.feed_id, i.title, i.link, s.headline, s.summary, s.category_primary, s.importance_rating, s.article_language FROM rss2tlg_items i INNER JOIN rss2tlg_summarization s ON i.id = s.item_id ...","found":true}
2025-11-08T20:36:53+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT can_be_published FROM rss2tlg_deduplication WHERE item_id = :item_id AND status = 'checked' LIMIT 1","found":true}
2025-11-08T20:36:53+00:00 DEBUG Выполнена SQL команда {"query":"INSERT INTO rss2tlg_illustration (item_id, feed_id, status, created_at, updated_at) VALUES (:item_id, :feed_id, :status, NOW(), NOW()) ON DUPLICATE KEY UPDATE status = :status_update, updated_at = NOW...","affected_rows":1}
2025-11-08T20:37:08+00:00 INFO HTTP запрос выполнен [POST chat/completions] код 200 {"method":"POST","uri":"chat/completions","status_code":200,"duration":14.249,"body_size":3424,"content_type":"application/json"}
2025-11-08T20:37:08+00:00 DEBUG [IllustrationService] Попытка генерации с моделью {"item_id":47,"model":"openai/dall-e-3"}
2025-11-08T20:37:08+00:00 WARNING [IllustrationService] Генерация через OpenRouter недоступна, используем placeholder {"item_id":47,"model":"openai/dall-e-3"}
2025-11-08T20:37:08+00:00 DEBUG [IllustrationService] Обработка изображения {"item_id":47,"data_length":10364,"data_preview":"iVBORw0KGgoAAAANSUhEUgAABQAAAALQCAIAAABAH0oBAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAeDklEQVR4nO3dMbKcysGG4ZHr"}
2025-11-08T20:37:08+00:00 DEBUG Выполнена SQL команда {"query":"UPDATE rss2tlg_illustration SET status = 'success', image_path = :image_path, image_width = :image_width, image_height = :image_height, image_size_bytes = :image_size_bytes, image_format = :image_form...","affected_rows":1}
2025-11-08T20:37:08+00:00 INFO [IllustrationService] Иллюстрация успешно сгенерирована {"item_id":47,"image_path":"/home/engine/project/tests/Rss2Tlg/../../data/illustrations/rss_feed_2/item_47_20251108_203708.png","processing_time_ms":14343}
2025-11-08T20:37:08+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.148,"body_size":405,"content_type":"application/json"}
2025-11-08T20:37:08+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.14,"body_size":457,"content_type":"application/json"}
2025-11-08T20:37:08+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.14,"body_size":377,"content_type":"application/json"}
2025-11-08T20:37:08+00:00 DEBUG Выполнен SELECT запрос (одна строка) {"query":"SELECT COUNT(*) as total, SUM(CASE WHEN status = 'success' THEN 1 ELSE 0 END) as success, SUM(CASE WHEN status = 'failed' THEN 1 ELSE 0 END) as failed, SUM(CASE WHEN status = 'skipped' THEN 1 ELSE 0 E...","found":true}
2025-11-08T20:37:08+00:00 DEBUG Выполнен SELECT запрос {"query":"SELECT image_path FROM rss2tlg_illustration WHERE status = 'success'","rows":1}
2025-11-08T20:37:08+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.144,"body_size":414,"content_type":"application/json"}
2025-11-08T20:37:09+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.161,"body_size":362,"content_type":"application/json"}
2025-11-08T20:37:09+00:00 INFO HTTP запрос выполнен [POST sendMessage] код 200 {"method":"POST","uri":"sendMessage","status_code":200,"duration":0.168,"body_size":585,"content_type":"application/json"}
